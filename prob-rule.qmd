# Probability Rules {#sec-prob-rule}

```{r, echo=FALSE, warning=FALSE}
library(emoji)
```

## Probability Operations and Rules

<span style="color:blue"> **Experiments, Events and Sample Space** </span>

- An **experiment** is any process in which the possible **outcomes** can be identified *ahead of time*. 
- An **event** is a set of possible outcomes of the experiment.
- The **sample space** $(\mathcal{S})$ of an experiment is the collection of **ALL** possible outcomes of the experiment.
- The table below gives an example of the events and sample space that are associated with the experiment of flipping a coin.

Experiment    | Possible Outcomes | Some Events                                  | Sample Space
------------- | ----------------- | -------------------------------------------  | -------------
Flip a coin  ðŸª™ | Heads, Tails      | {Heads}, {Heads, Tails}, ...                 | {Heads, Tails}
Roll a die  `r emoji('game_die')`   | 1, 2, 3, 4, 5, 6  | {1, 3, 5}, {2, 4, 6}, {2}, {3, 4, 5, 6}, ... | {1, 2, 3, 4, 5, 6}


:::{.callout-note icon=false}
## Is the sample space also an event?
- Yes, the sample space itself is an event because it is also a set of possible outcomes of the experiment.
:::

------------------------------------------------------------------

<span style="color:blue"> **Set Concept: Example of Rolling a six-side balanced die**

:::{.callout-tip}
Draw a [**Venn Diagram**](http://www.stat.ucla.edu/~vlew/stat11/lectures/venn/venn.html) every time you get stuck!
:::

- <span style="color:black"> The **complement** </span> of an event (set) $A$, is denoted <span style="color:black"> $A^c$ </span>.
  + It is the set of **all** outcomes (elements) of $\mathcal{S}$ in which $A$ does **not** occur.
  + <span style="color:blue">For the die example, let $A$ be an event that a number greater than 2 is rolled. Then $A = \{3, 4, 5, 6\}$ and $A^c = \{1, 2\}$.</span> 

- The <span style="color:black"> **union** $(A \cup B)$ </span> is the set of all outcomes of $\mathcal{S}$ in $A$ **or** $B$.
  + <span style="color:blue"> For the die example, let $B$ be an event that an even number is rolled. Then $B = \{2, 4, 6\}$ and $A \cup B = \{2, 3, 4, 5, 6\}$. </span>

- The <span style="color:black"> **intersection** $(A \cap B)$ </span> is the set of all outcomes of $\mathcal{S}$ in both $A$ **and** $B$.
  + <span style="color:blue"> For the die example, $A \cap B = \{4, 6\}$.</span> 

- $A$ and $B$ are **disjoint** or **mutually exclusive** if they have **no outcomes in common** $(A \cap B = \emptyset)$.
  + $\emptyset$ means an empty set, $\{\}$, i.e., no elements in the set.
  + <span style="color:blue"> For the die example, let $C$ be an event that an odd number is obtained. Then $C = \{1, 3, 5\}$ and $B \cap C = \emptyset$. </span> 

- The **containment** $(A \subset B)$ means every elements of $A$ also belongs to $B$. 
  + If $A$ occurs, then so does $B$.
  + <span style="color:blue"> For the die example, let $B$ be the event that an even number is obtained and $D$ be the event that a number greater than 1 is obtained. Then $B = \{2, 4, 6\}$ and $D = \{2, 3, 4, 5, 6\}$. </span>

:::{.callout-note icon=false}
## Is $B \subset D$ or $D \subset B$?
:::

```{r, cache=TRUE, echo=FALSE, out.width="20%", fig.align='center'}
par(mar = c(0,0,0,0))
plot(c(0, 1), c(0, 1), type = 'n', axes = FALSE, xlab = "", ylab = "")
temp <- seq(0, 2 * pi, 2 * pi / 100)
x <- 0.5 + 0.5 * cos(temp)
y <- 0.5 + 0.5 * sin(temp)
lines(x, y, lwd = 15, col = 2)

text(0.5, 0.6, 'B', pos = 3, font = 2, cex = 6)
lines((x - 0.5) * 2 * sqrt(0.07) + 0.55,
      (y - 0.5) * 2 * sqrt(0.07) + 0.68, lwd = 15, col = 4)

text(0.55, 0.3, 'D', pos = 1, font = 2, cex = 6)
```


-------------------------------------------------------------

<span style="color:blue"> **Probability Rules** </span>

- We denote the probability of an event $A$ on a sample space $\mathcal{S}$ as $P(A)$.

:::{.callout-tip}
Treat the probability of an event as the **area** of the event in the Venn diagram.
:::

- **Axioms**
  + $P(\mathcal{S}) = 1$
  + For any event $A$, $P(A) \ge 0$
  + If $A$ and $B$ are **disjoint** or **mutually exclusive**, $P(A \cup B) = P(A) + P(B)$

- **Properties**
  + $P(\emptyset) = 0$. 
  + $0 \le P(A) \le 1$
  + $P(A^c) = 1 - P(A)$
  + **Addition Rule**: $P(A \cup B) = P(A) + P(B) - P(A \cap B)$  
  + If $A \subset B$, then $P(A) \le P(B)$ 

<span style="color:red"> ***Venn Diagram Illustration*** </span>

- **Addition Rule**: $P(A \cup B) = P(A) + P(B) - P(A \cap B)$

```{r, echo=FALSE, out.width = "100%", fig.align='center'}
#| label: fig-addition-rule
#| fig-cap: Venn Diagram depiction of the addition rule
# ```{r, echo=FALSE, fig.show = "hold", out.width = "25%", fig.align = "default"}
# knitr::include_graphics("./images/img-prob/union.png")
# knitr::include_graphics("./images/img-prob/setA.png")
# knitr::include_graphics("./images/img-prob/setB.png")
# knitr::include_graphics("./images/img-prob/intersect.png")
# ```
knitr::include_graphics("./images/img-prob/addition_rule.png")
```

- **Disjoint Case**: $P(A \cup B) = P(A) + P(B)$ because $P(A \cap B) = 0$!

```{r, echo=FALSE, out.width = "100%", fig.align='center'}
#| label: fig-disjoint-addition
#| fig-cap: Venn Diagram depiction of the addition rule for the disjoint case
# knitr::include_graphics("./images/img-prob/male_female_set.png")
# knitr::include_graphics("./images/img-prob/male_set.png")
# knitr::include_graphics("./images/img-prob/female_set.png")
knitr::include_graphics("./images/img-prob/disjoint_sex.png")
```

<span style="color:red"> ***Example: M&M Colors***

- The makers of the M&Ms report that their plain M&Ms are composed of 
  + 15% Yellow, 10% Red, 20% Orange, 25% Blue, 15% Green and 15% Brown
  


::::{.columns}
:::{.column width="50%"}
```{r, out.width="80%", echo=FALSE, fig.align='center'}
knitr::include_graphics("./images/img-prob/mm.jpeg")
```
:::

:::{.column width="50%"}
:::{.callout-note icon=false}
## If you randomly select an M&M, what is the probability of the following? 

  (1) It is brown. 
  (2) It is red or green.
  (3) It is not blue. 
  (4) It is red and brown.
:::
:::
::::

- **Solution**
  (1) $P(\mathrm{Brown}) = 0.15$
  
  (2) $\begin{align} P(\mathrm{Red} \cup \mathrm{Green}) &= P(\mathrm{Red}) + P(\mathrm{Green}) - P(\mathrm{Red} \cap \mathrm{Green}) \\ &= 0.10 + 0.15 - 0 = 0.25 \end{align}$
  
  (3) $P(\text{Not Blue}) = 1 - P(\text{Blue}) = 1 - 0.25 = 0.75$
  
  (4) $P(\text{Red and Brown}) = P(\emptyset) = 0$


:::{.callout-note icon=false}
## Which interpretation of probability is used in this question?
:::

## Conditional Probability and Independence

<span style="color:blue"> **Conditional Probability** </span>

- As shown in @fig-conditional below, the **conditional probability of $A$ given $B$** is

<center>
$$ P(A \mid  B) = \frac{P(A \cap B)}{P(B)}$$ 
</center>

- It is defined if $P(B) > 0$ and undefined if $P(B) = 0$.
- **"Given $B$"** means that event $B$ *has already occurred*. 

```{r, echo=FALSE, out.width = "100%", fig.align='center'}
#| label: fig-conditional
#| fig-cap: Venn Diagram illustration of the conditional probability of A given B

# knitr::include_graphics("./images/img-prob/cond_prob.png")
# knitr::include_graphics("./images/img-prob/intersect_light.png")
# knitr::include_graphics("./images/img-prob/setB.png")
knitr::include_graphics("./images/img-prob/conditional.jpg")
```

- **Multiplication Rule**: $P(A \cap B) = P(A \mid  B)P(B) = P(B \mid  A)P(A)$
  + This is a rearranged form of the equation for conditional probability.
- $P(A)$ and $P(B)$ are **unconditional** or **marginal probabilities**.
  + The marginal probability $P(A)$ is the ratio of area of $A$ to the area of the sample space.
  + The conditional probability $P(A|B)$ is the ratio of area of $A \cap B$ to the area of $B$. 
- The difference between marginal probabilities and conditional probabilities is depicted in @fig-conditional-prob.

```{r, echo=FALSE, out.width="100%", fig.align='center'}
#| label: fig-conditional-prob
#| fig-cap: Difference Between $P(A)$ and $P(A \mid B)$
knitr::include_graphics("./images/img-prob/conditional_prob.jpg")
```


<span style="color:red"> ***Example: Peanut Butter and Jelly***

- Suppose 80% of people like peanut butter, 89% like jelly and 78% like both.
- Given that a randomly sampled person likes peanut butter, what is the probability that she also likes jelly?

::::{.columns}
:::{.column width="49%"}
```{r, echo=FALSE, fig.show='hold', out.width="100%", fig.align='default'}
knitr::include_graphics("./slides/w3-02-probability/img/peanut_jelly.jpeg")
```
:::

:::{.column width="2%"}
:::

:::{.column width="49%"}
- We want $P(J\mid PB) = \frac{P(PB \cap J)}{P(PB)}$.
- From the problem we have $P(PB) = 0.8$, $P(J) = 0.89$ and $P(PB \cap J) = 0.78$
- $P(J\mid PB) = \frac{P(PB \cap J)}{P(PB)} = \frac{0.78}{0.8} = 0.975$
- If we **don't** know if the person loves peanut butter, the probability that he or she loves jelly is 89%.
- If we **do** know she loves peanut butter, the probability that he or she loves jelly is going up to 97.5%.
:::
::::

-----------------------------------------------------------------

<span style="color:blue"> **Independence** </span>

- $A$ and $B$ are **independent** if 
$\begin{align} P(A \mid  B) &= P(A) \text{ or }\\ P(B \mid  A) &= P(B) \text{ or } \\P(A\cap B) &= P(A)P(B)\end{align}$  $\text{ if } P(A) > 0 \text{ and } P(B) > 0$

- Intuitively, this means that *knowing $B$ occurs does not change the probability that $A$ occurs and vice versa*.

:::{.callout-note icon=false}
## Can we compute $P(A \cap B)$ if we only know $P(A)$ and $P(B)$?
- No, we cannot compute $P(A \cap B)$ because we don't know if $A$ and $B$ are independent. 
- We can only do so if $A$ and $B$ are independent.
- In general, we need the multiplication rule $P(A \cap B) = P(A \mid B)P(B)$.
:::


```{r, echo=FALSE, out.width="100%"}
#| label: fig-independence
#| fig-cap: Venn Diagram Explanation of Independence
knitr::include_graphics("./images/img-prob/independence.jpg")
```

<span style="color:red"> ***Independence Example*** </span>

:::{.callout-note icon=false}
## Assuming that events $A$ and $B$ are **independent** and that $P(A) = 0.3$ and $P(B) = 0.7$.
  + $P(A \cap B)$?
  + $P(A \cup B)$?
  + $P(A \mid B)$?
:::

**Solution**

- $P(A \cap B) = P(A)P(B)=0.21$
- $P(A \cup B) = P(A)+P(B)-P(A\cap B) = 0.3+0.7-0.21=0.79$
- $P(A \mid B) = P(A) = 0.3$

## Bayes' Formula

<span style="color:blue"> **Why Bayes' Formula?** </span>

- Often, we know $P(B \mid A)$, but we are much more interested in $P(A \mid B)$.
- Example: Diagnostic tests provide $P(\text{positive test result}  \mid \text{COVID})$, but we are also interested in $P(\text{COVID} \mid \text{positive test result})$

::::{.columns}
:::{.column width="50%"}
```{r, echo=FALSE, out.width="70%", fig.align='center'}
knitr::include_graphics("./images/img-prob/covid.jpeg")
```
:::

:::{.column width="50%"}
```{r, echo=FALSE, out.width="70%", fig.align='center'}
knitr::include_graphics("./images/img-prob/test_table.png")
```
:::
::::

- Bayes' formula provides a way to find $P(A \mid B)$ from $P(B \mid A)$

------------------------------------------------------------

<span style="color:blue"> **Formula** </span>

- If $A$ and $B$ are events whose probabilities are not 0 or 1, then
$$\begin{align*} P(A \mid B) &= \frac{P(A \cap B)}{P(B)} \quad ( \text{def. of cond. prob.}) \\ &= \frac{P(A \cap B)}{P((B \cap A) \cup (B \cap A^c))} \quad ( \text{partition } B) \\ &= \frac{P(B \mid A)P(A)}{P(B \mid A)P(A) + P(B \mid A^c)P(A^c)}  \quad ( \text{multiplication rule}) \end{align*}$$

<!-- - Idea: <span style="color:blue"> Partition $B$ as $B = (B \cap A) \cup (B \cap A^c)$ and apply the multiplication rule.</span>  -->

```{r, echo=FALSE, out.width="30%", fig.align='center'}
#| label: fig-bayes-venn
#| fig-cap: Venn Diagram illustration for Bayes' formula
# knitr::include_graphics("./images/img-prob/partition_1.png")
par(mar = c(0, 0, 0, 0), mfrow = c(1, 1))
plot(0, 0, type = "n", axes = FALSE, xlab = "", ylab = "")
box(lwd = 4)
plotrix::draw.ellipse(x = -0.2, y = 0, a = 0.8, b = 0.6, lwd = 2)
plotrix::draw.ellipse(x = 0.56, y = 0, a = 0.4, b = 1, lwd = 2)
text(x = -0.5, y = 0.62, labels = "A", cex = 2)
text(x = .92, y = 0.62, labels = "B", cex = 2)
text(x = 0.36, y = 0, labels = "B ??? A", cex = 2)
text(x = 0.66, y = -0.45, 
     labels = expression(paste("B ", intersect(A^c))), cex = 2)
text(x = -1, y = 1, labels = "S", cex = 2, font = 4)
```


<span style="color:red"> ***Example: Passing Rate*** </span>

::::{.columns}
:::{.column width="50%"}
After taking MATH 4720, $80\%$ of students understand the Bayes' formula.

- Of those who understood the Bayes' formula,
  + $95\%$ passed
- Of those who did not understand the Bayes' formula,
  +  $60\%$ passed
:::

:::{.column width="50%"}
```{r, echo=FALSE, out.width="100%", fig.align='center'}
knitr::include_graphics("./images/img-prob/test_pass.jpeg")
```
:::
::::

:::{.callout-note icon=false}
## Calculate the probability that a student understands the Bayes' formula given the fact that she passed.
:::

- <span style="color:blue"> Step 1: Formulate what we would like to compute  </span>
  - $P(\text{understood} \mid \text{passed})$

- <span style="color:blue"> Step 2: Define relevant events in the formula: $A$, $A^c$ and $B$ </span>
  - Let $A =$ understood and $B =$ passed. Then $A^c =$ didn't understand and $P(\text{understood} \mid \text{passed}) = P(A \mid B)$.

- <span style="color:blue"> Step 3: Find probabilities in the Bayes' formula using provided information. </span>
  - $P(B \mid A) = P(\text{passed} \mid \text{understood}) = 0.95$
  - $P(B \mid A^c) = P(\text{passed} \mid \text{didn't understand}) = 0.6$  
  - $P(A) = P(\text{understood}) = 0.8$
  - $P(A^c) = 1 - P(A) = 0.2$

- <span style="color:blue"> Step 4: Apply Bayes' formula. </span>
  - $\small P(\text{understood} \mid \text{passed}) = P(A \mid B) = \frac{P(B \mid A)P(A)}{P(B \mid A)P(A) + P(B \mid A^c)P(A^c)} = \frac{(0.95)(0.8)}{(0.95)(0.8) + (0.6)(0.2)} = 0.86$

<span style="color:red"> ***Tree Diagram Illustration*** </span>

- $80\%$ of students understand the Bayes' formula. 
- Of those who understood the Bayes' formula, $95\%$ passed ($5\%$ failed).
- Of those who did not understand the formula, $60\%$ passed ($40\%$ failed).

::::{.columns}
:::{.column width="49%"}
```{r, echo=FALSE, out.width="120%", fig.align='center'}
#| label: fig-bayes-tree
#| fig-cap: Tree Diagram illustration of Passing Rate example
knitr::include_graphics("./images/img-prob/bayestree.png")
```
::: 

:::{.column width="2%"}
:::

:::{.column width="49%"}
$$\begin{align*} & P(\text{yes} \mid \text{pass}) \\ &= \frac{P(\text{yes and }  \text{pass})}{P(\text{pass})} \\ &= \frac{P(\text{yes and }  \text{pass})}{P(\text{pass and yes}) + P(\text{pass and no})}\\ &= \frac{P(\text{pass | yes})P(\text{yes})}{P(\text{pass | yes})P(\text{yes}) + P(\text{pass | no})P(\text{no})} \\ &= \frac{0.76}{0.76 + 0.12} = 0.86 \end{align*}$$
:::
::::

## Exercises

1. A Pew Research survey asked 2,422 randomly sampled registered voters their political affiliation (Republican, Democrat, or Independent) and whether or not they identify as swing voters. 38% of respondents identified as Independent, 25% identified as swing voters, and 13% identified as both.
    a. Are being Independent and being a swing voter disjoint, i.e. mutually exclusive?
    b. What percent of voters are Independent but not swing voters?
    c. What percent of voters are Independent or swing voters?
    d. What percent of voters are neither Independent nor swing voters?
    e. Is the event that someone is a swing voter independent of the event that someone is a political Independent?

<br>

|                         |  Earth is warming |  Not warming  |   Don't Know/Refuse |  Total 
| ----------------------- | ----------------- | ------------- | ------------------- | ----------
| Conservative Republican |  0.11             |   0.20        |   0.02              |    0.33  
| Mod/Lib Republican      |  0.06             |   0.06        |   0.01              |    0.13   
| Mod/Cons Democrat       |  0.25             |   0.07        |   0.02              |    0.34 
| Liberal Democrat        |  0.18             |   0.01        |   0.01              |    0.20
| Total                   |  0.60             |   0.34        |   0.06              |    1.00


2. A Pew Research poll asked 1,423 Americans, "From what you've read and heard, is there solid evidence that the average temperature on earth has been getting warmer over the past few decades, or not?". The table above shows the distribution of responses by party and ideology, where the counts have been replaced with relative frequencies.
    a. Are believing that the earth is warming and being a liberal Democrat mutually exclusive?
    b. What is the probability that a randomly chosen respondent believes the earth is warming or is a Mod/Cons Democrat?
    c. What is the probability that a randomly chosen respondent believes the earth is warming given that he is a Mod/Cons Democrat?
    d. What is the probability that a randomly chosen respondent believes the earth is warming given that he is a Mod/Lib Republican?
    e. Does it appear that whether or not a respondent believes the earth is warming is independent of their party and ideology? Explain your reasoning.


3. After an MATH 4740/MSSC 5740 course, 73% of students could successfully construct scatter plots using R. Of those who could construct scatter plots, 84% passed, while only 62% of those students who could not construct scatter plots passed. Calculate the probability that a student is able to construct a scatter plot if it is known that she passed.
