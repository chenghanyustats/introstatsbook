<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="A comprehensive introductory statistical data science book.">
<title>Introduction to Statistics - 18&nbsp; Inference About Proportions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infer-cat.html" rel="next">
<link href="./infer-var.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-prop.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introduction-to-Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Random Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-multicomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Multiple Comparison*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-r_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-py_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python programming</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#categorical-data" id="toc-categorical-data" class="nav-link active" data-scroll-target="#categorical-data"><span class="header-section-number">18.1</span> Categorical Data</a></li>
  <li><a href="#inference-for-a-single-proportion" id="toc-inference-for-a-single-proportion" class="nav-link" data-scroll-target="#inference-for-a-single-proportion"><span class="header-section-number">18.2</span> Inference for a Single Proportion</a></li>
  <li><a href="#inference-for-two-proportions" id="toc-inference-for-two-proportions" class="nav-link" data-scroll-target="#inference-for-two-proportions"><span class="header-section-number">18.3</span> Inference for Two Proportions</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">18.4</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-prop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-prop.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-infer-prop" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>What we learned so far are the inference methods for population means and variances that are from normal distributions. Our sample data are numerical values. What if our data are categorical, for example, gender, approval or not, etc? In this chapter, we are talk about inference about proportions. When we have categorical data, we are often interested in the proportion of some category of the categorical variable. We may wonder if the proportion of female is greater than 40% for statistics major students. We may also want to estimate the true proportion of the voters who votes for candidate A before all the votes are tallied.</p>
<section id="categorical-data" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="categorical-data">
<span class="header-section-number">18.1</span> Categorical Data</h2>
<p><span style="color:blue"> <strong>One Categorical Variable with Two Categories</strong> </span></p>
<p>We start with one categorical variable with two categories. Let <span class="math inline">\(X\)</span> be the categorical variable Gender with 2 categories, Male and Female. Our data table may look like the following. The first subject is Male, so we mark it in the Male column. The second subject is Female, so we check it in the Female column, and so on.</p>
<div class="columns">
<div class="column" style="width:55%;">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Subject</th>
<th style="text-align: center;">Male</th>
<th style="text-align: center;">Female</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:30%;">
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/class.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="2006"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>When we collect the categorical data, usually we are interested in their count. We wonder which category has more counts than the other. So we can make a one-way frequency/count table as follows. It is one-way because the count table is for one categorical variable only. Here in the data there are <span class="math inline">\(y\)</span> males and <span class="math inline">\(n-y\)</span> females, where <span class="math inline">\(n\)</span> is the sample size.</p>
<center>
<strong>One-way frequency/count table</strong>
</center>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(X\)</span></th>
<th style="text-align: center;">Count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Male</td>
<td style="text-align: center;"><span class="math inline">\(y\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Female</td>
<td style="text-align: center;"><span class="math inline">\(n-y\)</span></td>
</tr>
</tbody>
</table>
<!-- :::{.callout-note icon=false} --><p>Now the number of males or the proportion of males can be viewed as a random variable because the <em>count, <span class="math inline">\(Y\)</span>, or the proportion <span class="math inline">\(Y/n\)</span> varies from sample to sample</em>. Suppose you want to learn the proportion of male students at Marquette, what would you do. You would probably randomly sample some Marquette students, and count how many of them are males, right? If you do the sampling again, the count will be different from the count you got previously. Therefore, to learn the male proportion, we could use the sample proportion <span class="math inline">\(Y/n\)</span> as an estimator that follows some (sampling) distribution.</p>
<p>One question for you. What probability distribution might be appropriate for the count, <span class="math inline">\(Y\)</span>? <!-- ::: --></p>
<hr>
<p><span style="color:blue"> <strong>Probability Distribution for Count Data: Two Levels</strong> </span></p>
<p>In our example, each subject is either Male or Female, and with the fixed sample size, we wonder how many subjects are Males. Any probability distribution comes into your mind? Well, <span class="math inline">\(binomial(n, \pi)\)</span> could be a good option for count data with 2 categories.</p>
<ul>
<li>Fixed number of trials: <span style="color:blue"> We can view each sampled subject as one trial in the experiment, and we have fixed <span class="math inline">\(n\)</span> subjects. </span>
</li>
<li>Each trial results in one of two outcomes. <span style="color:blue"> Clearly, in our survey, there are only two possible answers. Each subject is either Male or Females. </span>
</li>
<li>Trials are independent. <span style="color:blue"> If the subjects are randomly sampled, the students in the sample are independent. </span>
</li>
<li>The probability of success <span class="math inline">\(\pi\)</span> is constant: <span style="color:blue"> The proportion of being in category Male is <span class="math inline">\(\pi\)</span>, which is constant at the given point of time. </span>
</li>
</ul>
<p>The count <span class="math inline">\(Y\)</span> of male students, or the number of success, has the binomial probability <span class="math display">\[P(Y = y \mid n, \pi) = \frac{n!}{y!(n-y)!}\pi^{y}(1-\pi)^{n-y}\]</span></p>
<p>Do we know <span class="math inline">\(\pi\)</span>? Absolutely not! The parameter <span class="math inline">\(\pi\)</span> is the proportion (or relative frequency) of male students, which is what we want to estimate and learn from data. Therefore, our goal is to <em>estimate or test the population proportion, <span class="math inline">\(\pi\)</span>, of the category Male</em> given the assumption that the count of Male <span class="math inline">\(Y\)</span> is binomially distributed <span class="math inline">\(Y \sim binomial(n, \pi)\)</span>.</p>
</section><section id="inference-for-a-single-proportion" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="inference-for-a-single-proportion">
<span class="header-section-number">18.2</span> Inference for a Single Proportion</h2>
<p><span style="color:blue"> <strong>Hypothesis Testing for <span class="math inline">\(\pi\)</span></strong> </span></p>
<p>The point estimator for the population proportion <span class="math inline">\(\pi\)</span> is the sample proportion <span class="math inline">\(Y/n\)</span>. The true probability is approximated by the relative frequency in the sample data. Let’s first learn how to do testing for <span class="math inline">\(\pi\)</span>. This is the <strong>one-sample proportion <span class="math inline">\(z\)</span> test</strong>.</p>
<!-- In the literature, such test is called the **exact binom test**. -->
<p><span style="color:red"> Step 0: Method Assumptions </span></p>
<ul>
<li>The method requires that <span style="color:blue"> <span class="math inline">\(n\pi_0 \ge 5\)</span> and <span class="math inline">\(n(1-\pi_0) \ge 5\)</span> </span> where <span class="math inline">\(\pi_0\)</span> is the hypothesized value or the value to be tested. The larger <span class="math inline">\(n\pi_0\)</span> and <span class="math inline">\(n(1-\pi_0)\)</span> are, the better. In fact, the method relies on the central limit theorem, and uses standard normal distribution to do the test. Large <span class="math inline">\(n\pi_0\)</span> and <span class="math inline">\(n(1-\pi_0)\)</span> leads to better normal approximation.</li>
</ul>
<p><span style="color:red"> Step 1: Set the Null and Alternative Hypothesis </span></p>
<ul>
<li>We are interested in the proportion of some category being equal to, greater than or less than some value. <span style="color:blue"> <span class="math inline">\(\begin{align} &amp;H_0: \pi = \pi_0 \\ &amp;H_1: \pi &gt; \pi_0 \text{ or } \pi &lt; \pi_0 \text{ or } \pi \ne \pi_0 \end{align}\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 2: Set the Significance Level, <span class="math inline">\(\alpha\)</span> </span></p>
<p><span style="color:red"> Step 3: Calculate the Test Statistic </span></p>
<ul>
<li>With the central limit theorem, it can be shown that the sampling distribution of the statistic <span class="math inline">\(Y/n\)</span> is approximately normal with mean <span class="math inline">\(\pi\)</span> and standard error, <span class="math inline">\(\sqrt{\frac{\pi(1-\pi)}{n}}\)</span>. Therefore, <span class="math display">\[Z = \frac{Y/n - \pi}{\sqrt{\frac{\pi(1-\pi)}{n}}} \dot\sim N(0, 1).\]</span> Then under the null <span class="math inline">\(H_0\)</span>, the test statistic is <span style="color:blue"> <span class="math inline">\(z_{test} = \dfrac{\hat{\pi} - \pi_0}{\sqrt{\frac{\pi_0(1-\pi_0)}{n}}}\)</span> where <span class="math inline">\(\hat{\pi} = \frac{y}{n}\)</span> is the realized sample proportion. </span>
</li>
</ul>
<!-- :::{.callout-note} --><!-- - The sampling distribution of $\hat{\pi}$ is approximately normal with mean, $\pi$, and standard error, $\sqrt{\frac{\pi(1-\pi)}{n}}$, if $y_i$ are independent and the assumptions are satisfied. --><!-- ::: --><p><span style="color:red"> Step 4-c: Find the Critical Value <span class="math inline">\(z_{\alpha}\)</span> (one-tailed) or <span class="math inline">\(z_{\alpha/2}\)</span> (two-tailed) </span></p>
<ul>
<li>Same as before.</li>
</ul>
<p><span style="color:red"> Step 5-c: Draw a Conclusion Using Critical Value Method </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi &gt; \pi_0\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z &gt; z_{\alpha}\)</span> </span></li>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi &lt; \pi_0\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z &lt; -z_{\alpha}\)</span> </span></li>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi \ne \pi_0\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(|z| &gt; z_{\alpha/2}\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim </span></p>
<hr>
<p><span style="color:blue"> <strong>Confidence Interval for <span class="math inline">\(\pi\)</span></strong> </span></p>
<p>To construct the confidence interval for <span class="math inline">\(\pi\)</span>, we rely on some assumption too. Unlike testing that has a hypothesized value <span class="math inline">\(\pi_0\)</span>, there is no hypothesized value in confidence interval, and we only use information from the data to get an interval. To ensure that the normal approximation is fairly good, the interval formula requires <span style="color:blue"><span class="math inline">\(n\hat{\pi} \ge 5\)</span> and <span class="math inline">\(n(1-\hat{\pi}) \ge 5\)</span>. </span> Can you see the difference between this requirement and the testing requirement?</p>
<!-- - Assumptions: -->
<!--   - $n\hat{\pi} \ge 5$ and $n(1-\hat{\pi}) \ge 5$ -->
<p>The <span class="math inline">\(100(1 - \alpha)\%\)</span> confidence interval for <span class="math inline">\(\pi\)</span> is <span class="math display">\[\hat{\pi} \pm z_{\alpha/2}\sqrt{\frac{\pi(1-\pi)}{n}}\]</span> where <span class="math inline">\(\hat{\pi} = y/n\)</span>. Since <span class="math inline">\(\pi\)</span> is unknown, we use its estimate <span class="math inline">\(\hat{\pi}\)</span> instead: <span class="math display">\[\hat{\pi} \pm z_{\alpha/2}\sqrt{\frac{\hat{\pi}(1-\hat{\pi})}{n}}\]</span></p>
<p>Such normal approximation interval is called the <strong>Wald interval</strong>. <!-- :::{.callout-note} --> <!-- - No hypothesized value, $\pi_0$, is involved in the confidence interval. --> <!-- ::: --></p>
<hr>
<p><span style="color:blue"> <strong>Example: Exit Poll</strong> </span></p>
<p>Suppose we collect data on 1,000 voters in an election with only two candidates, <strong>R</strong> and <strong>D</strong>, and every voter must vote for either one of them.</p>
<div class="columns">
<div class="column" style="width:49%;">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Voter</th>
<th style="text-align: center;">R</th>
<th style="text-align: center;">D</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1000</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:45%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/vote.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="3008"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Based on the data, we want to predict who won the election. Let <span class="math inline">\(Y\)</span> be the number of voters that voted for <strong>R</strong>. Assume the count, <span class="math inline">\(Y\)</span>, is sampled from <span class="math inline">\(binomial(n = 1000, \pi)\)</span>, and <span class="math inline">\(\pi = P(\text{a voter voted for R}) =\)</span> (population) proportion of all voters that for <strong>R</strong>. Parameter <span class="math inline">\(\pi\)</span> is the <em>unknown</em> parameter to be estimated or tested. In an exit poll of 1,000 voters, 520 voted for <strong>R</strong>. At <span class="math inline">\(\alpha = 0.05\)</span>, predict whether or not <em><strong>R</strong> won the election</em>.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## What are $H_0$ and $H_1$? -->
<!-- **R** won the election means that the proportion of all voters voting for **R** is greater than 50%. <span style="color:blue"> $\begin{align} &H_0: \pi \le 1/2 \\ &H_1: \pi > 1/2 \text{ (more than half voted for R)} \end{align}$ </span> -->
<!-- ::: -->
<p><span style="color:red"> <strong><em>Hypothesis Testing</em></strong> </span></p>
<p><span style="color:red"> Step 0 </span></p>
<ul>
<li>
<span class="math inline">\(\pi_0 = 1/2\)</span>. <span style="color:blue"> <span class="math inline">\(n\pi_0 = 1000(1/2) = 500 \ge 5\)</span> and <span class="math inline">\(n(1-\pi_0) \ge 5\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 1 </span></p>
<ul>
<li>
<strong>R</strong> won the election means that the proportion of all voters voting for <strong>R</strong> is greater than 50%. <span style="color:blue"> <span class="math inline">\(\begin{align} &amp;H_0: \pi \le 1/2 \\ &amp;H_1: \pi &gt; 1/2 \text{ (more than half voted for R)} \end{align}\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 2 </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(\alpha = 0.05\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 3 </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(z_{test} = \frac{\hat{\pi} - \pi_0}{\sqrt{\frac{\pi_0(1-\pi_0)}{n}}} =  \frac{\frac{520}{1000} - 0.5}{\sqrt{\frac{0.5(1-0.5)}{1000}}} = 1.26\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 4-c </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(z_{\alpha} = z_{0.05} = 1.645\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 5-c </span></p>
<ul>
<li><span style="color:blue"> Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z_{test} &gt; z_{\alpha}\)</span>. </span></li>
<li><span style="color:blue"> Since <span class="math inline">\(z_{test} &lt; z_{\alpha}\)</span>, we do not reject <span class="math inline">\(H_0\)</span>. </span></li>
</ul>
<p><span style="color:red"> Step 6 </span></p>
<ul>
<li><p><span style="color:blue"> We do not have sufficient evidence to conclude that R won. </span></p></li>
<li><p>We make the same conclusion using the <span class="math inline">\(p\)</span>-value method.</p></li>
</ul>
<p><span class="math display">\[ p\text{-value} = P(Z &gt; 1.26) = 0.1 &gt; 0.05\]</span></p>
<p><span style="color:red"> <strong><em>Confidence Interval</em></strong> </span></p>
<p>First we check the assumption: + <span class="math inline">\(n\hat{\pi} = 1000(0.52) = 520 \ge 5\)</span> and <span class="math inline">\(n(1-\hat{\pi}) = 480 \ge 5\)</span>.</p>
<ul>
<li>Estimate the proportion of all voters that voted for <strong>R</strong> using a 95% confidence interval.</li>
</ul>
<p><span class="math display">\[\hat{\pi} \pm z_{\alpha/2}\sqrt{\frac{\hat{\pi}(1-\hat{\pi})}{n}} = 0.52 \pm z_{0.025}\sqrt{\frac{0.52(1-0.52)}{1000}} = (0.49, 0.55).\]</span></p>
<p><span style="color:red"> <strong><em>Computation in R</em></strong> </span></p>
<!-- Below is a demonstration of how to perform a binomial test in R.  -->
<p>To perform the one-sample proportion <span class="math inline">\(z\)</span> test in R, we use the function <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>. The argument <code>correct</code> tells us whether or not we want to do continuity correction. Our method here does not do continuity correction. It does not matter much when our method assumption is satisfied.</p>
<p>To obtain the confidence interval, we should set <code>alternative = "two.sided"</code> because the interval is two sided. Be careful. The interval we learn is the Wald interval. However, the interval from the <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> output is not the Wald interval, but the so-called <strong>Wilson interval</strong>. There are lots of variants of confidence intervals for binomial proportions, and one can use the <code>BinomCI()</code> function in the <code>DescTools</code> package to obtain them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## one proportion test using normal approximation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, p <span class="op">=</span> <span class="fl">0.5</span>, alternative <span class="op">=</span> <span class="st">"greater"</span>, </span>
<span>          correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  520 out of 1000, null probability 0.5
X-squared = 1.6, df = 1, p-value = 0.103
alternative hypothesis: true p is greater than 0.5
95 percent confidence interval:
 0.4939945 1.0000000
sample estimates:
   p 
0.52 </code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use alternative = "two.sided" to get CI</span></span>
<span><span class="va">prop_ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, p <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                     alternative <span class="op">=</span> <span class="st">"two.sided"</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">prop_ci</span><span class="op">$</span><span class="va">conf.int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4890177 0.5508292
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## The Wilson interval and Wald interval</span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/BinomCI.html">BinomCI</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      est    lwr.ci    upr.ci
[1,] 0.52 0.4890177 0.5508292</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/BinomCI.html">BinomCI</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, method <span class="op">=</span> <span class="st">"wald"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      est    lwr.ci    upr.ci
[1,] 0.52 0.4890351 0.5509649</code></pre>
</div>
</div>
<!-- # binom.test() -->
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Doing inference with normal approximation to binomial variables is more complicated than what we discuss here. The main reason is that we use a continuous normal distribution to approximate a discrete binomial distribution. Check the <a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval">Wiki page</a> if you don’t believe it. No worries at this moment unless you want to be a statistician doing research in this field!</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you look at the proportion test output carefully, you’ll find that the test statistic is a chi-squared test statistic, not the <span class="math inline">\(z\)</span> test statistic. In fact, the square of the <span class="math inline">\(z\)</span> statistic is equal to the chi-squared statistic with degrees of freedom one, i.e., <span class="math inline">\(z_{test}^2 = \chi^2_{1, test}\)</span>, and the <span class="math inline">\(z\)</span> test here is equivalent to the chi-squared test discussed in the next chapter (<a href="infer-cat.html" class="quarto-xref"><span>Chapter 19</span></a>) for two-sided tests.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">z_test</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.52</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">z_test</span> <span class="op">^</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.6</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop_ci</span><span class="op">$</span><span class="va">statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
      1.6 </code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The method we learn here uses normal approximation to binomial variables. One can also perform the <a href="https://en.wikipedia.org/wiki/Binomial_test"><strong>exact binomial test</strong></a> that directly uses binomial probabilities to calculate the <span class="math inline">\(p\)</span>-value and do the testing. As its name suggests, it is what we should use for binomial inference because it is <em>exact</em>. If the requirement of the normal approximation method we learn is not met, the exact binomial test should be used. When the sample size is large, and the expected proportion is not extreme being close to 0 or 1, the normal approximation method and the exact binomial test have pretty similar inference results.</p>
<p>We can use <code><a href="https://rdrr.io/r/stats/binom.test.html">binom.test()</a></code> function to perform the exact binomial test. The <a href="https://yury-zablotski.netlify.app/post/exact-binomial-test/">page</a> discusses the relationship between the exact binomial test and other methods.</p>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## exact binom test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, p <span class="op">=</span> <span class="fl">0.5</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  520 and 1000
number of successes = 520, number of trials = 1000, p-value = 0.1087
alternative hypothesis: true probability of success is greater than 0.5
95 percent confidence interval:
 0.4934948 1.0000000
sample estimates:
probability of success 
                  0.52 </code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## confidence interval</span></span>
<span><span class="va">bi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">520</span>, n <span class="op">=</span> <span class="fl">1000</span>, p <span class="op">=</span> <span class="fl">0.5</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span>
<span><span class="va">bi</span><span class="op">$</span><span class="va">conf.int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4885149 0.5513671
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<!-- https://bookdown.org/mpfoley1973/statistics/exact-binomial-test.html -->
</section><section id="inference-for-two-proportions" class="level2" data-number="18.3"><h2 data-number="18.3" class="anchored" data-anchor-id="inference-for-two-proportions">
<span class="header-section-number">18.3</span> Inference for Two Proportions</h2>
<p>Many times we want to compare two population proportions, say <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span>. We could assume there are two independent binomial experiments with the same possible outcomes. For example, we could have male and female voters, and every voter in each group has an opinion about president’s performance whose outcome is either Approve or Not approve. Let the number of male voters approving the performance is <span class="math inline">\(Y_1\)</span> and the number of female voters approving the performance is <span class="math inline">\(Y_2\)</span>. We can assume <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> both follow binomial distribution but with their own parameters, <span class="math inline">\(n_1\)</span> and <span class="math inline">\(\pi_1\)</span> for <span class="math inline">\(Y_1\)</span>, and <span class="math inline">\(n_2\)</span> and <span class="math inline">\(\pi_2\)</span> for <span class="math inline">\(Y_2\)</span>. Political analysts may want to know whether or not the male presidential approval rate <span class="math inline">\(\pi_1\)</span> is higher than the female approval rate <span class="math inline">\(\pi_2\)</span>.</p>
<div class="columns">
<div class="column" style="width:55%;">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Group 1</th>
<th style="text-align: center;">Group 2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">
<span class="math inline">\(n_1\)</span> trials</td>
<td style="text-align: center;">
<span class="math inline">\(n_2\)</span> trials</td>
</tr>
<tr class="even">
<td style="text-align: center;">
<span class="math inline">\(Y_1\)</span> number of successes</td>
<td style="text-align: center;">
<span class="math inline">\(Y_2\)</span> number of successes</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(Y_1 \sim binomial(n_1, \pi_1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_2 \sim binomial(n_2, \pi_2)\)</span></td>
</tr>
</tbody>
</table>
<ul>
<li>
<span class="math inline">\(\pi_1\)</span>: Population proportion of success of Group 1</li>
<li>
<span class="math inline">\(\pi_2\)</span>: Population proportion of success of Group 2</li>
</ul>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/trump_rate.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Hypothesis Testing for <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span></strong> </span></p>
<p>The method introduced here is based on the central limit theorem and normal approximation to binomial distribution. The idea is similar to the one sample proportion <span class="math inline">\(z\)</span> test, and we perform <strong>two sample proportion <span class="math inline">\(z\)</span> test.</strong></p>
<p><span style="color:red"> Step 0: Check Method Assumptions </span></p>
<ul>
<li>In order to perform the <span class="math inline">\(z\)</span> test, the following requirements must be met: <span style="color:blue"> <span class="math inline">\(n_1\hat{\pi}_1 \ge 5\)</span>, <span class="math inline">\(n_1(1-\hat{\pi}_1) \ge 5\)</span> <em>and</em> <span class="math inline">\(n_2\hat{\pi}_2 \ge 5\)</span>, <span class="math inline">\(n_2(1-\hat{\pi}_2) \ge 5\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 1: Set the Null and Alternative Hypothesis </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(\begin{align}  &amp;H_0: \pi_1 = \pi_2 \\ &amp;H_1: \pi_1 &gt; \pi_2 \text{ or } \pi_1 &lt; \pi_2 \text{ or } \pi_1 \ne \pi_2 \end{align}\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 2: Set the Significance Level, <span class="math inline">\(\alpha\)</span> </span></p>
<p><span style="color:red"> Step 3: Calculate the Test Statistic </span></p>
<ul>
<li>It can be shown that <span class="math display">\[\frac{\frac{Y_1}{n_1} - \frac{Y_2}{n_2} - (\pi_1 - \pi_2)}{\sqrt{\frac{\pi_1(1-\pi_1)}{n_1} + \frac{\pi_2(1-\pi_2)}{n_2}}} \dot\sim N(0, 1)\]</span> Under the null hypothesis, <span class="math inline">\(\pi_1 = \pi_2 = \pi\)</span>, with the sample data, the statistic is reduced to <span class="math display">\[\frac{\hat{\pi}_1 - \hat{\pi}_2}{\sqrt{\pi(1-\pi)(\frac{1}{n_1} + \frac{1}{n_2})}},\]</span> where <span class="math inline">\(\hat{\pi}_1 = y_1/n_1\)</span> and <span class="math inline">\(\hat{\pi}_2 = y_2/n_2\)</span>. We still cannot use this quantity as a test statistic because it involves the unknown parameter <span class="math inline">\(\pi\)</span>. Like two sample pooled <span class="math inline">\(t\)</span> test, since <span class="math inline">\(\pi_1 = \pi_2 = \pi\)</span> under <span class="math inline">\(H_0\)</span>, we combine the two samples using all the trials to get a better <strong>pooled sample proportion</strong> <span class="math inline">\(\bar{\pi} = \frac{y_1+y_2}{n_1+n_2}\)</span> to estimate the common proportion <span class="math inline">\(\pi\)</span>. Therefore, the test statistic is</li>
</ul>
<p><span style="color:blue"> <span class="math display">\[z_{test} = \dfrac{\hat{\pi}_1 - \hat{\pi}_2}{\sqrt{\bar{\pi}(1-\bar{\pi})(\frac{1}{n_1} + \frac{1}{n_2})}}.\]</span> </span></p>
<p><span style="color:red"> Step 4-c: Find the Critical Value <span class="math inline">\(z_{\alpha}\)</span> (one-tailed) or <span class="math inline">\(z_{\alpha/2}\)</span> (two-tailed) </span></p>
<p>Same before.</p>
<p><span style="color:red"> Step 5-c: Draw a Conclusion Using Critical Value Method </span></p>
<ul>
<li>
<span style="color:blue"> Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if </span>
<ul>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi_1 &gt; \pi_2\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z &gt; z_{\alpha}\)</span> </span></li>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi_1 &lt; \pi_2\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z &lt; -z_{\alpha}\)</span> </span></li>
<li><span style="color:blue"> <span class="math inline">\(H_1: \pi_1 \ne \pi_2\)</span>: Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(|z| &gt; z_{\alpha/2}\)</span> </span></li>
</ul>
</li>
</ul>
<p><span style="color:red"> Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim </span></p>
<hr>
<p><span style="color:blue"> <strong>Confidence Interval for <span class="math inline">\(\pi_1 - \pi_2\)</span></strong></span></p>
<p>To get the Wald confidence interval for <span class="math inline">\(\pi_1 - \pi_2\)</span>, it requires</p>
<p><span class="math inline">\(n_1\hat{\pi}_1 \ge 5\)</span>, <span class="math inline">\(n_1(1-\hat{\pi}_1) \ge 5\)</span> <em>and</em> <span class="math inline">\(n_2\hat{\pi}_2 \ge 5\)</span>, <span class="math inline">\(n_2(1-\hat{\pi}_2) \ge 5\)</span>. Again, no hypothesized values, and sample proportions are used.</p>
<p>The <span class="math inline">\(100(1 - \alpha)\%\)</span> confidence interval for <span class="math inline">\(\pi_1 - \pi_2\)</span> is <span class="math display">\[\hat{\pi}_1 - \hat{\pi}_2 \pm z_{\alpha/2}\sqrt{\frac{\hat{\pi}_1(1-\hat{\pi}_1)}{n_1}+\frac{\hat{\pi}_2(1-\hat{\pi}_2)}{n_2}}\]</span></p>
<p>There is no pooled estimate <span class="math inline">\(\bar{\pi}\)</span> in the interval because the interval is not constructed under the hypothesis that <span class="math inline">\(\pi_1 = \pi_2 = \pi\)</span>. The parameters <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span> are estimated separately by the individual sample proportions <span class="math inline">\(\hat{\pi}_1\)</span> and <span class="math inline">\(\hat{\pi}_2\)</span>.</p>
<hr>
<p><span style="color:blue"> <strong>Example: Effectiveness of Learning</strong> </span></p>
<div class="columns">
<div class="column" style="width:70%;">
<p>Suppose we do a study on 300 students to compare the effectiveness of learning statistics in online vs.&nbsp;in-person programs. We randomly assign 125 students to the online program, and the remaining 175 to the in-person program. The exam results are shown in the table below.</p>
</div><div class="column" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/online_learning.jpeg" class="img-fluid figure-img" width="2736"></p>
<figcaption>Source: Unsplash-JESHOOTS.COM</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Exam Results</th>
<th style="text-align: center;">Online Instruction</th>
<th style="text-align: center;">In-Person Instruction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Pass</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;">113</td>
</tr>
<tr class="even">
<td style="text-align: center;">Fail</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">62</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">125</td>
<td style="text-align: center;">175</td>
</tr>
</tbody>
</table>
<!-- :::{.callout-note icon=false} --><p>Is there sufficient evidence to conclude that the online program is more effective than the traditional in-person program at <span class="math inline">\(\alpha=0.05\)</span>? <!-- ::: --></p>
<p><span style="color:red"> <strong><em>Hypothesis Testing</em></strong> </span></p>
<p><span style="color:red"> Step 0 </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(\hat{\pi}_1 = 94/125 = 0.75\)</span> and <span class="math inline">\(\hat{\pi}_2 = 113/175 = 0.65\)</span>. </span></li>
<li><span style="color:blue"> <span class="math inline">\(n_1\hat{\pi}_1 = 94 &gt; 5\)</span>, <span class="math inline">\(n_1(1-\hat{\pi}_1) = 31 &gt; 5\)</span>, and <span class="math inline">\(n_2\hat{\pi}_2 = 113 &gt; 5\)</span>, <span class="math inline">\(n_2(1-\hat{\pi}_2) = 62 &gt; 5\)</span> </span></li>
</ul>
<p>The assumptions are satisfied.</p>
<p><span style="color:red"> Step 1 </span></p>
<ul>
<li>Let <span class="math inline">\(\pi_1\)</span> <span class="math inline">\((\pi_2)\)</span> be the population proportion of students passing the exam in the online (in-person) program. <span style="color:blue"> <span class="math inline">\(H_0: \pi_1 = \pi_2\)</span> vs.&nbsp;<span class="math inline">\(H_1: \pi_1 &gt; \pi_2\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 2 </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(\alpha = 0.05\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 3 </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(\bar{\pi} = \frac{94+113}{125+175} = 0.69\)</span> </span></li>
<li><span style="color:blue"> <span class="math inline">\(z_{test} = \dfrac{\hat{\pi}_1 - \hat{\pi}_2}{\sqrt{\bar{\pi}(1-\bar{\pi})(\frac{1}{n_1} + \frac{1}{n_2})}} = \frac{0.75 - 0.65}{\sqrt{0.69(1-0.69)(\frac{1}{125} + \frac{1}{175})}} = 1.96\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 4-c </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(z_{\alpha} = z_{0.05} = 1.645\)</span> </span></li>
</ul>
<p><span style="color:red"> Step 5-c </span></p>
<ul>
<li><span style="color:blue"> Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(z_{test} &gt; z_{\alpha}\)</span>. </span></li>
<li><span style="color:blue"> Since <span class="math inline">\(z_{test} &gt; z_{\alpha}\)</span>, we reject <span class="math inline">\(H_0\)</span>. </span></li>
</ul>
<p><span style="color:red"> Step 6 </span></p>
<ul>
<li><span style="color:blue"> We have sufficient evidence to conclude that the online program is more effective. </span></li>
</ul>
<p><span style="color:red"> <strong><em>Confidence Interval</em></strong> </span></p>
<p>We want to know how effective the online program is, so we estimate <span class="math inline">\(\pi_1 - \pi_2\)</span> using a <span class="math inline">\(95\%\)</span> confidence interval</p>
<p><span class="math display">\[\hat{\pi}_1 - \hat{\pi}_2 \pm z_{0.05/2}\sqrt{\frac{\hat{\pi}_1(1-\hat{\pi}_1)}{n_1}+\frac{\hat{\pi}_2(1-\hat{\pi}_2)}{n_2}}\]</span> <!-- - $z_{0.05/2} = 1.96$ --> The 95% confidence interval is <span class="math display">\[0.75 - 0.65 \pm 1.96\sqrt{\frac{(0.75)(1-0.75)}{125} + \frac{(0.65)(1-0.65)}{175}}\\
= (0.002, 0.210)\]</span></p>
<p>Because 0 is not included in this interval, we reach the same conclusion as the hypothesis testing.</p>
<p><span style="color:red"> <strong><em>Implementation in R</em></strong> </span></p>
<p>Below is a demonstration of how to make inferences about two proportions in R. We still use <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function, but here we provide the number of successes and the number of trials in the arguments <code>x</code> and <code>n</code> respectively as a vector whose first element is for the first group and second element for the second group. Please be consistent with the order and don’t mess up.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">94</span>, <span class="fl">113</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">125</span>, <span class="fl">175</span><span class="op">)</span>, </span>
<span>          alternative <span class="op">=</span> <span class="st">"greater"</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions without continuity correction

data:  c(94, 113) out of c(125, 175)
X-squared = 3.8509, df = 1, p-value = 0.02486
alternative hypothesis: greater
95 percent confidence interval:
 0.01926052 1.00000000
sample estimates:
   prop 1    prop 2 
0.7520000 0.6457143 </code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop_ci2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">94</span>, <span class="fl">113</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">125</span>, <span class="fl">175</span><span class="op">)</span>, </span>
<span>                     alternative <span class="op">=</span> <span class="st">"two.sided"</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">prop_ci2</span><span class="op">$</span><span class="va">conf.int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002588801 0.209982628
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two sample proportion <span class="math inline">\(z\)</span> test is equivalent to the chi-squared test introduced in the next chapter (<a href="infer-cat.html" class="quarto-xref"><span>Chapter 19</span></a>) that considers more than two possible outcomes.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pi_bar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">94</span> <span class="op">+</span> <span class="fl">113</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">125</span> <span class="op">+</span> <span class="fl">175</span><span class="op">)</span></span>
<span><span class="va">pi_1_hat</span> <span class="op">&lt;-</span> <span class="fl">94</span><span class="op">/</span><span class="fl">125</span></span>
<span><span class="va">pi_2_hat</span> <span class="op">&lt;-</span> <span class="fl">113</span><span class="op">/</span><span class="fl">175</span></span>
<span><span class="va">z_test2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pi_1_hat</span> <span class="op">-</span> <span class="va">pi_2_hat</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">pi_bar</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pi_bar</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">125</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">175</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z_test2</span> <span class="op">^</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.850932</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prop_ci2</span><span class="op">$</span><span class="va">statistic</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X-squared 
 3.850932 </code></pre>
</div>
</div>
</div>
</div>
</section><section id="exercises" class="level2" data-number="18.4"><h2 data-number="18.4" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">18.4</span> Exercises</h2>
<ol type="1">
<li>Lipitor (atorvastatin) is a drug used to control cholesterol. In clinical trials of Lipitor, 98 subjects were treated with Lipitor and 245 subjects were given a placebo. Among those treated with Lipitor, 6 developed infections. Among those given a placebo, 24 developed infections. Use a 0.05 significance level to test the claim that the rate of inflections was the same for those treated with Lipitor and those given a placebo.
<ol type="a">
<li>Test the claim using the critical-value and p-value methods.</li>
<li>Test the claim by constructing a confidence interval.</li>
</ol>
</li>
</ol>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./infer-var.html" class="pagination-link" aria-label="Inference About Variances">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infer-cat.html" class="pagination-link" aria-label="Inference about Categorical Data">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-prop.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>