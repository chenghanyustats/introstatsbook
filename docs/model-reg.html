<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="A comprehensive introductory statistical data science book.">
<title>Introduction to Statistics - 26&nbsp; Simple Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./model-mlr.html" rel="next">
<link href="./model-twoway.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model.html">Statistical Models</a></li><li class="breadcrumb-item"><a href="./model-reg.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introduction-to-Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules and Bayes Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Random Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-multicomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Multiple Comparison*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multiple Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-r_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-py_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python Programming</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#correlation" id="toc-correlation" class="nav-link active" data-scroll-target="#correlation"><span class="header-section-number">26.1</span> Correlation</a></li>
  <li><a href="#meaning-of-regression" id="toc-meaning-of-regression" class="nav-link" data-scroll-target="#meaning-of-regression"><span class="header-section-number">26.2</span> Meaning of Regression</a></li>
  <li><a href="#fitting-a-regression-line-haty-b_0-b_1x" id="toc-fitting-a-regression-line-haty-b_0-b_1x" class="nav-link" data-scroll-target="#fitting-a-regression-line-haty-b_0-b_1x"><span class="header-section-number">26.3</span> Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span></a></li>
  <li><a href="#confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" id="toc-confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" class="nav-link" data-scroll-target="#confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1"><span class="header-section-number">26.4</span> Confidence Intervals and Hypothesis Testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#analysis-of-variance-anova-approach" id="toc-analysis-of-variance-anova-approach" class="nav-link" data-scroll-target="#analysis-of-variance-anova-approach"><span class="header-section-number">26.5</span> Analysis of Variance (ANOVA) Approach</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">26.6</span> Prediction</a></li>
  <li><a href="#simulation-based-inference" id="toc-simulation-based-inference" class="nav-link" data-scroll-target="#simulation-based-inference"><span class="header-section-number">26.7</span> Simulation-based Inference</a></li>
  <li>
<a href="#relationship-between-anova-and-regression" id="toc-relationship-between-anova-and-regression" class="nav-link" data-scroll-target="#relationship-between-anova-and-regression"><span class="header-section-number">26.8</span> Relationship between ANOVA and Regression*</a>
  <ul class="collapse">
<li><a href="#categorical-predictors-and-dummy-variables" id="toc-categorical-predictors-and-dummy-variables" class="nav-link" data-scroll-target="#categorical-predictors-and-dummy-variables"><span class="header-section-number">26.8.1</span> Categorical predictors and dummy variables</a></li>
  <li><a href="#anova-as-a-regression-model" id="toc-anova-as-a-regression-model" class="nav-link" data-scroll-target="#anova-as-a-regression-model"><span class="header-section-number">26.8.2</span> ANOVA as a regression model</a></li>
  </ul>
</li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">26.9</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/model-reg.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model.html">Statistical Models</a></li><li class="breadcrumb-item"><a href="./model-reg.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-model-reg" class="quarto-section-identifier"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>Linear regression</strong> is a <strong>regression model</strong> which is a statistical technique for investigating and modeling the <em>relationships between variables</em>. If your data set only have one variable, or you just want to analyze one single variable in your data, you do not need regression at all. But you’d like to see how one variable affects another, how one changes with the another, or use one variable to predict another variable, regression may be your top choice. Linear regression assumes the relationships between variables or transformed variables is linear. Although the linear assumption is quite naive, it is a must starting point for understanding advanced regression models, and believe or not, the linear model is still popular at present because of its interpretability, and has a pretty decent performance for some problems.</p>
<!-- We first define the linear correlation between two numerical variables -->
<section id="correlation" class="level2" data-number="26.1"><h2 data-number="26.1" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">26.1</span> Correlation</h2>
<p><span style="color:blue"> <strong>Relationship Between 2 Numerical Variables</strong> </span></p>
<p>We first define the linear correlation between two numerical variables. Depending on your research question, one may be classified as the <strong>explanatory variable</strong> and the other the <strong>response variable</strong>. However, in correlation, the two variables do not necessarily have such explanatory-response relationship, and they can be any numerical variables being interested. We will discuss the meaning of explanatory and response variable in the regression section.</p>
<p>Can you provide an example that two variables are associated? Here I provide some examples.</p>
<ul>
<li><span style="color:blue"> height and weight </span></li>
<li><span style="color:blue"> income and age </span></li>
<li><span style="color:blue"> SAT/ACT math score and verbal score </span></li>
<li><span style="color:blue"> amount of time spent studying for an exam and exam grade </span></li>
</ul>
<p>In each item, the two variables are related each other in some way. Usually the taller a person is, the heavier he is. Note that such relationship is not deterministic, but describe a general trend. We could have a 6’6” guy with 198 lbs, and a 5’9” with 220 lbs, but this an individual case, not an overall pattern. This concept is important because it is represented in the calculation of <strong>correlation coefficient</strong> and linear regression model.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## Can you provide an example that 2 variables are associated? -->
<!-- ::: -->
<hr>
<p><span style="color:blue"> <strong>Scatterplots</strong> </span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatterplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-scatterplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.1: Examples of scatterplots
</figcaption></figure>
</div>
</div>
</div>
<p>The most clear way to show the relationship between two numerical variables is to create a scatterplot. The overall pattern or relationship can be detected several ways in a scatterplot.</p>
<ul>
<li><p><em>Form</em>: As shown in <a href="#fig-scatterplot" class="quarto-xref">Figure&nbsp;<span>26.1</span></a>, the relationship between the two variables may be linear. Heavier cars tend to be less fuel efficient. The subjects in the data may be separated into two groups or clusters based on the value of the two variables. The volcano’s eruption duration and time waited are either small or large. Scatterplts can show other patterns such as quadratic, cubic or any other nonlinear relationships. In this chapter, we stay with the linear relationship.</p></li>
<li><p><em>Direction</em>: The variables can be positively associated or negatively associated, or not associated. In the scatterplot, the linear pattern is described by a line summarized by the data points in the plot. If the slope of the line is positive (negative), the two variables are positively (negatively) associated, meaning that one gets large as the other gets small. If the slope of the line is zero, the two variables have no association, and whether one variable’s value is large or small does not affect the other variable’s value.</p></li>
<li><p><em>Strength</em>: Strength is how close the data points lie to the line or nonlinear curve trend in the scatter plot. The variables’ relationship is strong (weak) if the data points are pretty close (far away) to the line.</p></li>
</ul>
<p>Although scatterplots can show form, direction, and strength of the relationship, we often want to have a numerical measure that can quantify these properties. If the relationship is linear, we use <strong>linear correlation coefficient</strong> to quantify the direction and strength of the linear relationship.</p>
<hr>
<p><span style="color:blue"> <strong>Linear Correlation Coefficient</strong> </span></p>
<p>The <em>sample</em> <strong>correlation coefficient</strong>, denoted by <span class="math inline">\(r\)</span>, measures the <em>direction</em> and <em>strength</em> of the <em>linear</em> relationship between two numerical variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>: <span class="math display">\[r :=\frac{1}{n-1}\sum_{i=1}^n\left(\frac{x_i-\overline{x}}{s_x}\right)\left(\frac{y_i-\overline{y}}{s_y}\right) = \frac{\sum_{i=1}^n(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i=1}^n(x_i-\overline{x})^2\sum_{i=1}^n(y_i-\overline{y})^2}}\]</span></p>
<p>This is the sample coefficient because the statistic is calculated by the sample data. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>You don’t need to memorize the formula, but it would be great if you can understand how the formula is related to the scatter plot, and why the formula can quantify the direction and strength of the linear relationship.</p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- <br> -->
<p>First, the coefficient is between negative one and positive one, <span class="math inline">\(-1 \le r\le 1\)</span>. <span class="math inline">\(r &gt; 0\)</span> means positive relationship, so the <em>larger</em> value of <span class="math inline">\(X\)</span> is, the <em>larger</em> value of <span class="math inline">\(Y\)</span> tends to be. If <span class="math inline">\(r = 1\)</span>, we have the strongest or perfect positive linear relationship. If we connect all the data points by a line segment, all line segments form a positively sloped straight line as shown in <a href="#fig-correlation" class="quarto-xref">Figure&nbsp;<span>26.5</span></a>. <!-- ::: --></p>
<!-- :::{.column width="50%"} -->
<p>Let’s look at <a href="#fig-positive" class="quarto-xref">Figure&nbsp;<span>26.2</span></a> and see how the formula and the scatter plot are related. Since <span class="math inline">\(s_x\)</span>, <span class="math inline">\(s_y\)</span>, and <span class="math inline">\(n\)</span> are positive, the sign of coefficient <span class="math inline">\(r\)</span> is determined by the sum <span class="math inline">\(\sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y})\)</span>. When the two variables are positively correlated, there are more data points in the first and third quadrants, and less data points in the second and fourth quadrants, where the quadrants are separated by <span class="math inline">\((\overline{x}, \overline{y})\)</span>. Therefore, <span class="math inline">\((x_i - \overline{x})(y_i - \overline{y}) &gt;0\)</span> in the first and third quadrants, and <span class="math inline">\((x_i - \overline{x})(y_i - \overline{y}) &lt; 0\)</span> in the second and fourth quadrants. Since we have more positive terms of <span class="math inline">\((x_i - \overline{x})(y_i - \overline{y})\)</span> the sum <span class="math inline">\(\sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y})\)</span>, and the coefficient <span class="math inline">\(r\)</span> is positive.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-positive" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-positive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-positive-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-positive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.2: Positive correlation between two variables.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- <br> -->
<p>When <span class="math inline">\(r &lt; 0\)</span>, the variables have a negative relationship. The <em>larger</em> value of <span class="math inline">\(X\)</span> is, the <em>smaller</em> value of <span class="math inline">\(Y\)</span> tends to be. When <span class="math inline">\(r = -1\)</span>, we have the perfect or strongest negative linear relationship. <a href="#fig-negative" class="quarto-xref">Figure&nbsp;<span>26.3</span></a> illustrates the negative correlation between variables.</p>
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-negative" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-negative-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-negative-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.3: Negative correlation between two variables
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- <br> -->
<p>When <span class="math inline">\(r = 0\)</span>, it means the two variables have no <em>linear</em> relationship. The scatter plot <a href="#fig-no-correlation" class="quarto-xref">Figure&nbsp;<span>26.4</span></a> shows an example of no <em>linear</em> relationship of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. When <span class="math inline">\(r = 0\)</span>, <span class="math inline">\(\sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y}) = 0\)</span>, and the number of data points in each quadrant would be similar. Be careful, it is possible that <span class="math inline">\(r = 0\)</span> even the number is not the same.</p>
<p>One property of <span class="math inline">\(r\)</span> is that it has no units of measurement, so scale changes do not affect <span class="math inline">\(r\)</span>. No matter what units of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are, <span class="math inline">\(r\)</span> is always between negative one and positive one. The reason is that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are normalized in the coefficient formula.</p>
<p>Last but not least. It is possible that there is a strong relationship between two variables, but they still have <span class="math inline">\(r = 0\)</span>! Remember that the correlation coefficient <span class="math inline">\(r\)</span> measures the direction and and strength of the linear relationship. Yes, the linear relationship <em>ONLY</em>. If two variables don’t have any relationship, they are not linearly correlated, and their correlation coefficient is 0. However, if <span class="math inline">\(r = 0\)</span>, we can just say the two variables have no linear relationship, but they may be nonlinearly related, or associated in any other way.</p>
<!-- If the explanatory and response variables are switched, $r$ remains the same. -->
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-no-correlation" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-no-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-no-correlation-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-no-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.4: No correlation between two variables
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<!-- <span style="color:red"> ***Example*** </span> -->
<p>The bottom row in <a href="#fig-correlation" class="quarto-xref">Figure&nbsp;<span>26.5</span></a> shows several nonlinear <span class="math inline">\(X\)</span>-<span class="math inline">\(Y\)</span> relationships that do not have linear association at all. Next time you see <span class="math inline">\(r = 0\)</span>, don’t over interpret the <span class="math inline">\(X\)</span>-<span class="math inline">\(Y\)</span> relationship.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-correlation" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/corr_ex.svg" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.5: Examples of relationships between two variables and their correlation coefficients. (https://upload.wikimedia.org/wikipedia/commons/d/d4/Correlation_examples2.svg)
</figcaption></figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Example in R</em></strong> </span></p>
<p>In R, we use the function <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> to calculate the correlation coefficient <span class="math inline">\(r\)</span>. We put the two variables’ data in the first two arguments <code>x</code> and <code>y</code>. Here we use the built-in <code>mtcars</code> dataset, and calculate the correlation between the high miles per gallon (<code>mpg</code>) and car weight (<code>wt</code>). The coefficient is <span class="math inline">\(r =\)</span> <code>-0.87</code>. Usually, when <span class="math inline">\(|r| &gt; 0.7\)</span>, the linear relationship is considered strong, and <span class="math inline">\(|r| &lt; 0.3\)</span> for weak linear relationship.</p>
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"MPG vs. Weight"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Car Weight"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Miles Per Gallon"</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fl">4</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span>,</span>
<span>    y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8676594</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/car.jpeg" class="img-fluid figure-img" width="3360"></p>
<figcaption>Source: unsplash-sippakorn yamkasikorn</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="meaning-of-regression" class="level2" data-number="26.2"><h2 data-number="26.2" class="anchored" data-anchor-id="meaning-of-regression">
<span class="header-section-number">26.2</span> Meaning of Regression</h2>
<p><span style="color:blue"> <strong>What is Regression?</strong> </span></p>
<p><strong>Regression</strong> models the relationship between one or more numerical/categorical <strong>response variables <span class="math inline">\((Y)\)</span></strong> and one or more numerical/categorical <strong>explanatory variables <span class="math inline">\((X)\)</span></strong>. We use explanatory variables to <em>explain</em> the behavior of the response variables, or how the response variables <em>response</em> to the changes of the explanatory variables.</p>
<p>Explanatory variables are also called <strong>independent variables</strong>, <strong>predictors</strong>, <strong>regressors</strong>, <strong>covariates</strong>, <strong>exogenous variables</strong>, and <strong>inputs</strong>. Response variables are also called <strong>dependent variables</strong>, <strong>targets</strong>, <strong>endogenous variables</strong>, <strong>outcome variables</strong>, <strong>outputs</strong>, and <strong>labels</strong>.</p>
<p>The followings are some examples.</p>
<ul>
<li><p>Predict <span style="color:blue"> College GPA <span class="math inline">\((Y)\)</span> using students’ ACT/SAT score <span class="math inline">\((X)\)</span> </span></p></li>
<li><p>Estimate how much <span style="color:blue"> Sales <span class="math inline">\((Y)\)</span> increase as Advertising Expenditure <span class="math inline">\((X)\)</span> increases $1000 dollars </span></p></li>
<li><p>How the <span style="color:blue"> Crime Rate <span class="math inline">\((Y)\)</span> in some county changes with the Median Household Income Level <span class="math inline">\((X)\)</span> </span></p></li>
</ul>
<p>In regression, we use a <strong>regression function</strong>, <span class="math inline">\(f(X)\)</span>, to describe how a response variable <span class="math inline">\(Y\)</span>, <em>on average</em>, changes as an explanatory variable <span class="math inline">\(X\)</span> changes. In other words, the regression function captures the <em>general pattern</em> or relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>Let’s first <em>pretend</em> we know what the true regression function <span class="math inline">\(f(X)\)</span> is.</p>
<p>For a general regression model, the function needs not be linear, and could be of any type. <a href="#fig-regression-function" class="quarto-xref">Figure&nbsp;<span>26.6</span></a> is an example of a regression function <span class="math inline">\(f(X)\)</span> which is log-shaped. The idea is that for each value of the predictor <span class="math inline">\(x\)</span>, the response value <span class="math inline">\(y\)</span> is generated based on the value of <span class="math inline">\(x\)</span> and the regression function <span class="math inline">\(f(x)\)</span>. However, while the <span class="math inline">\(X\)</span>-<span class="math inline">\(f(X)\)</span> relationship is deterministic, the <span class="math inline">\(X\)</span>-<span class="math inline">\(Y\)</span> relationship is not, even though the <span class="math inline">\(y\)</span> value is pretty close to <span class="math inline">\(f(x)\)</span> given some value of <span class="math inline">\(x\)</span>. That’s why if we collect sample data, we will have the two variable data <span class="math inline">\((x_i, y_i)\)</span> as the blue points scattered around the function <span class="math inline">\(f(x)\)</span>. For any value of <span class="math inline">\(x\)</span>, the data generating mechanism for <span class="math inline">\(y\)</span> takes the level of <span class="math inline">\(x\)</span> into account through <span class="math inline">\(f(x)\)</span>, but also includes some other factors that affect the value of <span class="math inline">\(y\)</span>. As a result, <span class="math inline">\(y \ne f(x)\)</span> in general, and we have <span class="math display">\[y = f(x) + \text{some value caused by factors other than } x.\]</span></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- - Examples: -->
<!--   + <span style="color:blue"> College GPA $(Y)$ vs. ACT/SAT score $(X)$</span> -->
<!--   + <span style="color:blue"> Sales $(Y)$ vs. Advertising Expenditure $(X)$</span> -->
<!--   + <span style="color:blue"> Crime Rate $(Y)$ vs. Median Income Level $(X)$ </span> -->
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-function" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-regression-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-regression-function-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regression-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.6: Example of a Regression Function.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p>For example, if you want to use a student’s SAT/ACT Score (<span class="math inline">\(X\)</span>) to predict his College GPA (<span class="math inline">\(Y\)</span>), you can assume <span class="math inline">\(Y\)</span> is affected by <span class="math inline">\(X\)</span> through the regression function <span class="math inline">\(f(X)\)</span>. However, do you think SAT/ACT Score is the <em>only</em> factor that affects one’s college academic performance? Absolutely not. The regression function <span class="math inline">\(f(X)\)</span> does not explain all the possible variation of <span class="math inline">\(Y\)</span>. Therefore, even the SAT/ACT Score is fixed at some level, an individual college GPA may be lower than the function value <span class="math inline">\(f(x)\)</span> due to other factors such as less time spent on studying. How do we treat factors other than <span class="math inline">\(X\)</span>? In regression, when <span class="math inline">\(X\)</span> has been taken into account, we think these factors affect the value of <span class="math inline">\(Y\)</span> in a random way with no significant pattern.</p>
<p>Although <span class="math inline">\(Y \ne f(X)\)</span> in general, in regression we believe or make a assumption that <em>the mean or expected value of <span class="math inline">\(Y\)</span> at <span class="math inline">\(X = x\)</span> is <span class="math inline">\(f(x)\)</span>, the regression function value at <span class="math inline">\(X = x\)</span>!</em> That is, mathematically <span class="math inline">\(E(Y \mid X=x) = \mu_{Y \mid X = x} = f(x)\)</span>. Therefore, <span class="math display">\[Y_{\mid X = x} = \mu_{Y\mid X = x} + \text{some value caused by factors other than } x.\]</span></p>
<p>Now we have learned an important concept in regression: the regression function <span class="math inline">\(f(x)\)</span> describes the <em>general</em> or <em>average</em> relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, or the relationship between <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(Y\)</span>, <span class="math inline">\(\mu_Y\)</span>, <em>not the relationship between <span class="math inline">\(X\)</span> and individual <span class="math inline">\(Y\)</span>.</em> In regression, we care about <span class="math inline">\(f(x)\)</span> because it tells us how the response <span class="math inline">\(Y\)</span> changes <em>on average</em> in response to the changes of <span class="math inline">\(X\)</span>. For the GPA example, <span class="math inline">\(f(x)\)</span> enables us to know how SAT/ACT Score affects College GPA in general, regardless of other factors. We don’t care about individual variation or up and downs because those have nothing to do with <span class="math inline">\(X\)</span>, and do not help us capture the pattern or relationship. If for each value of SAT/ACT Score, we were able to repeatedly collect a College GPA, the effect of other factors on College GPA will be washed out when those College GPA values are averaged.</p>
<hr>
<p><span style="color:blue"> <strong>Unknown Regression Function</strong> </span></p>
<p>Unfortunately the true underlying relationship between <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(Y\)</span>, the regression function <span class="math inline">\(f(X)\)</span>, is usually <em>unknown</em> to us although we are interested in it. In reality, what we have is the scatter plot like <a href="#fig-unknown-reg-function" class="quarto-xref">Figure&nbsp;<span>26.7</span></a>, or the sample data <span class="math inline">\((x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\)</span>, the blue points. What statistics comes into play is that we try to uncover or estimate the function from our data, get to know how <span class="math inline">\(Y\)</span> is generated at a given value of <span class="math inline">\(X\)</span>, and use the function to <em>predict</em> the value of <span class="math inline">\(Y\)</span> given a value of <span class="math inline">\(X\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-unknown-reg-function" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-unknown-reg-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-unknown-reg-function-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unknown-reg-function-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.7: Data with an unknown regression function
</figcaption></figure>
</div>
</div>
</div>
<!-- Note that the data points $(x_i, y_i)$ in @fig-regression-function are not right on the regression function, but scattered around the function. -->
<!-- Goal: **Estimate** $f(X)$ from our data, and use it to **predict** the value of $Y$ given a value of $X$. -->
<hr>
<p><span style="color:blue"> <strong>Simple Linear Regression</strong> </span></p>
<p>A regression model can be very general, considering lots of variables simultaneously and modeling a complex nonlinear regression function. We learn how to walk before how to run. So let’s start with the very basic <strong>simple linear regression</strong>. The model is called “simple” because there is <em>only one</em> predictor <span class="math inline">\(X\)</span> and <em>one</em> response variable <span class="math inline">\(Y\)</span>. The model is linear because the regression function used for predicting <span class="math inline">\(Y\)</span> is a linear function, i.e., <span class="math inline">\(f(x) = \beta_0 + \beta_1x\)</span>. Therefore, we use a <strong>regression line</strong> in an X-Y plane to predict the value of <span class="math inline">\(Y\)</span> for a given value of <span class="math inline">\(X = x\)</span>. Keep in mind that here the predictor <span class="math inline">\(X\)</span> is assumed <em>known</em> and <em>constant</em>. It is a variable but not a random variable. However, the response <span class="math inline">\(Y\)</span> is a random variable whose value depends on not only the value of <span class="math inline">\(x\)</span> through <span class="math inline">\(f(x)\)</span> but also a probability distribution. We will discuss it in more detail when we talk about the model.</p>
<!-- - Start with **simple linear regression**.  -->
<p><!-- + There is **only one** predictor, $X$ (**known** and **constant**), and **one** response variable, $Y$. --></p>
<p><!-- + The regression function used for predicting $Y$ is a **linear** function.  --> <!-- + Use a *regression line* in an X-Y plane to predict the value of $Y$ for a given value of $X = x$. --></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<p>Let’s have a short math review. A linear function <span class="math inline">\(y = f(x) = \beta_0 + \beta_1 x\)</span> represents a straight line.</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> is the <strong>slope</strong> of the line. It is the amount by which <span class="math inline">\(y\)</span> changes when <span class="math inline">\(x\)</span> increases by one unit.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the <strong>intercept</strong> term which is the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>.</p></li>
</ul>
<p>The linearity assumption requires that <span class="math inline">\(\beta_1\)</span> does not change as <span class="math inline">\(x\)</span> changes.</p>
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-line" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-regression-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/reg_line.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="357">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regression-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.8: Example of a regression line
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p><span style="color:red"> <strong><em>Sample Data: Relationship Between X and Y</em></strong> </span></p>
<p>Back to statistics. Remember that we want to use our sample data to estimate the unknown regression function or regression line. Suppose our data set is the <span class="math inline">\(x\)</span>-<span class="math inline">\(y\)</span> pairs <span class="math inline">\((x_i, y_i), i = 1, 2, \dots, n\)</span>. You can see in <a href="#fig-relationship-xy" class="quarto-xref">Figure&nbsp;<span>26.9</span></a> that simply connecting all data points does not form a straight line because again the value <span class="math inline">\(y\)</span> depends on both the regression function and some other factors that are not related to <span class="math inline">\(x\)</span>. So <span class="math inline">\(y_i \ne \beta_0+\beta_1x_i\)</span> in general even if <span class="math inline">\(f(x) = \beta_0+\beta_1x\)</span> is the true regression function faithfully representing the linear relationship.</p>
<p>Now we need an additional variable to explain the deviations from the line and complete the modeling of data generating process. The deviation can be explained by a new variable <span class="math inline">\(\epsilon\)</span> that is the <strong>error term</strong> in regression. So the value <span class="math inline">\(y\)</span> is the function value <span class="math inline">\(\beta_0 + \beta_1x\)</span> plus the value of <span class="math inline">\(\epsilon\)</span>:</p>
<p><span class="math display">\[y_i = \beta_0+\beta_1x_i + \color{red}{\epsilon_i}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-relationship-xy" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-relationship-xy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-relationship-xy-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-relationship-xy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.9: Actual relationship between X and Y isn’t perfectly linear.
</figcaption></figure>
</div>
</div>
</div>
<p>We learned that <span class="math inline">\(Y\)</span> is a random variable whose value varies with some probability distribution. We have <span class="math inline">\(y = \beta_0+\beta_1x + \epsilon\)</span>, but <span class="math inline">\(f(x) = \beta_0+\beta_1x\)</span> is deterministic and constant given the value of <span class="math inline">\(x\)</span> because <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are fixed constants although their value may not be known to us. The randomness of <span class="math inline">\(y\)</span> should come from the error term <span class="math inline">\(\epsilon\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As we learned in random variable and sampling distribution, <em>before</em> we collect the sample, <span class="math inline">\(Y\)</span> (and <span class="math inline">\(\epsilon\)</span>) is a random variable. Once data are collected, we have realized value <span class="math inline">\(y\)</span> (and realized <span class="math inline">\(\epsilon\)</span>). The notation of <span class="math inline">\(\epsilon\)</span> is a little abused because <span class="math inline">\(\epsilon\)</span> could stand for a random variable or a realized value. Be careful about that and make sure you know which one it represents in the content.</p>
</div>
</div>
<p>When we collect our data, at any given level of <span class="math inline">\(X = x\)</span>, <span class="math inline">\(y\)</span> is assumed to be drawn from a normal distribution (for inference purpose). Its value varies and will not be exactly equal to its mean, <span class="math inline">\(\mu_y\)</span>. <a href="#fig-normal-dist-red" class="quarto-xref">Figure&nbsp;<span>26.10</span></a> illustrates this idea. At any value of <span class="math inline">\(x\)</span>, there is an associated normal distribution centered at the function value <span class="math inline">\(\beta_0+\beta_1x\)</span> or <span class="math inline">\(\mu_{Y\mid X = x}\)</span>. Then we treat the value <span class="math inline">\(y\)</span> as a draw from the distribution. Of course due to the randomness of the distribution, <span class="math inline">\(y\)</span> will not be exactly equal to <span class="math inline">\(\mu_{Y\mid X = x}\)</span>, but its value will be somewhat around the mean. If <span class="math inline">\(\beta_1 &gt; 0\)</span>, <span class="math inline">\(\mu_{Y\mid X = x}\)</span> gets large as <span class="math inline">\(x\)</span> goes up. As a result, the realized values of <span class="math inline">\(y\)</span> with all levels of <span class="math inline">\(x\)</span> will also have a upward linear trend centered around <span class="math inline">\(\mu_{Y\mid X = x}\)</span>.</p>
<!-- The data points in the scatter plot are assumed to be generated in regression as follows.  -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-dist-red" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-dist-red-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-dist-red-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.10: The responses, y, follows a normal distribution. Source: Introduction to the Practice of Statistics.
</figcaption></figure>
</div>
</div>
</div>
<p>If at every level of <span class="math inline">\(x\)</span>, we collect <span class="math inline">\(y\)</span> value again, due to randomness, we are gonna get a different set of <span class="math inline">\(y\)</span>s, as shown in <a href="#fig-normal-dist" class="quarto-xref">Figure&nbsp;<span>26.11</span></a> as blue points. Although the two sets of <span class="math inline">\(y\)</span>s (red and blue) are different, both are centered around the mean <span class="math inline">\(\mu_{Y\mid X = x}\)</span>, and embrace the same positive linear trend.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-dist" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line_data_blue.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.11: Second sample. Source: Introduction to the Practice of Statistics.
</figcaption></figure>
</div>
</div>
</div>
<p>Finally let’s relate the figure to the equation <span class="math inline">\(y = \mu_{Y\mid X = x} + \epsilon\)</span>. Either red or blue points, the value <span class="math inline">\(y\)</span> is decomposed into two parts, <span class="math inline">\(\mu_{Y\mid X = x}\)</span> and <span class="math inline">\(\epsilon\)</span>. They share the same baseline mean level but add a different size of random error <span class="math inline">\(\epsilon\)</span>. It is the error that causes such up and downs or “noises” around the mean. If we ignore or wash out these noises, and let <span class="math inline">\(\mu_{Y\mid X = x}\)</span> speak up, the true underlying function describing the linear relationship will come up. The <em>mean of <span class="math inline">\(Y\)</span></em> and <span class="math inline">\(X\)</span> form a straight line. This regression line is what we care about. In reality we don’t see it, but we assume it is there, and it determines the base level of <span class="math inline">\(y\)</span>. We use the sample data to estimate this unseen line. Hopefully our estimated one is close to the true unseen one.</p>
<!-- The **mean of $Y$** and $X$ form a straight line. -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-mean" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-regression-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-regression-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.12: The regression line is formed from the mean of Y and X. Source: Introduction to the Practice of Statistics.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>We never know the true regression function. In linear regression, we assume the function is linear. This assumption may be inappropriate or completely wrong. We need <strong>model adequacy checking</strong> to examine whether linearity assumption makes sense. At this moment, let’s put this issue aside, and assume the true function is linear.</p>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Simple Linear Regression Model (Population)</strong> </span></p>
<p>We now formally write down the simple linear regression model.</p>
<p>For the <span class="math inline">\(i\)</span>-th measurement in the target population, <span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \epsilon_i\]</span></p>
<ul>
<li>
<span class="math inline">\(Y_i\)</span> is the <span class="math inline">\(i\)</span>-th value of the response (random) variable.</li>
<li>
<span class="math inline">\(X_i\)</span> is the <span class="math inline">\(i\)</span>-th <em>fixed known</em> value of the predictor.</li>
<li>
<span class="math inline">\(\epsilon_i\)</span> is the <span class="math inline">\(i\)</span>-th random error with the assumption <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span>.</li>
<li>
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are model or regression <em>coefficients</em>.</li>
</ul>
<p><span class="math inline">\(f(X) = \beta_0 + \beta_1X\)</span> is the population regression line that describes the true relationship between <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(Y\)</span> in the population.</p>
<p><span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span> are <em>fixed unknown parameters</em> to be estimated from the sample data once we collect them. Once we learn <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, we know the regression line <span class="math inline">\(\beta_0 + \beta_1X_i\)</span>, and know how <span class="math inline">\(X\)</span> affects <span class="math inline">\(Y\)</span>. Once we learn <span class="math inline">\(\sigma^2\)</span>, we know how much <span class="math inline">\(Y\)</span> is scattered and deviated from its mean.</p>
<p><span style="color:red"> <strong><em>Important Features of Model <span class="math inline">\(Y_i = \beta_0 + \beta_1X_i + \epsilon_i\)</span></em></strong></span></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<p>The setting <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span> implies several important features of the regression model.</p>
<p>First, the mean of <span class="math inline">\(\epsilon_i\)</span> is zero. In other words, the mean of <span class="math inline">\(Y\)</span> at any given level of <span class="math inline">\(X\)</span> is described by the population regression line,</p>
<p><span class="math display">\[\begin{align*}
\mu_{Y_i \mid X_i} &amp;= E(\beta_0 + \beta_1X_i + \epsilon_i) \\
&amp;= \beta_0 + \beta_1X_i
\end{align*}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<span class="math inline">\(E(c) = c\)</span> if <span class="math inline">\(c\)</span> is a constant. For example the mean of 5 is 5. <span class="math inline">\(E(5) = 5\)</span>.</li>
<li>For variable or constant <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, <span class="math inline">\(E(A+B) = E(A) + E(B)\)</span>.</li>
</ul>
<p>Since <span class="math inline">\(\beta_0 + \beta_1X_i\)</span> is a constant, <span class="math inline">\(E(\beta_0 + \beta_1X_i + \epsilon_i) = E(\beta_0 + \beta_1X_i) + E(\epsilon_i) = \beta_0 + \beta_1X_i + 0 = \beta_0 + \beta_1X_i.\)</span></p>
</div>
</div>
<p>The mean response, <span class="math inline">\(\mu_{Y\mid X}\)</span>, has a <em>straight-line</em> relationship with <span class="math inline">\(X\)</span> given by a population regression line <span class="math display">\[\mu_{Y\mid X} = \beta_0 + \beta_1X\]</span> <!-- ::: --></p>
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-straight-line" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-straight-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line_red.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-straight-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.13: The straight line relationship between <span class="math inline">\(\mu_{Y\mid X}\)</span> and <span class="math inline">\(X\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<!-- <br> -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<p>Second, for any <span class="math inline">\(i\)</span>, <span class="math inline">\(Var(\epsilon_i) = \sigma^2\)</span>. With a fixed <span class="math inline">\(X\)</span>, since all the variation of <span class="math inline">\(Y\)</span> comes from <span class="math inline">\(\epsilon\)</span>, the variance of <span class="math inline">\(Y_i \mid X_i\)</span> is also <span class="math inline">\(\sigma^2\)</span>, i.e.,</p>
<p><span class="math display">\[\begin{align*}
Var(Y_i \mid X_i) &amp;= Var(\epsilon_i) = \sigma^2
\end{align*}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a constant <span class="math inline">\(c\)</span> and random variable <span class="math inline">\(A\)</span>, <span class="math inline">\(Var(c+A) = Var(A)\)</span>. Since <span class="math inline">\(\beta_0 + \beta_1X_i\)</span> is a constant with no variation, <span class="math inline">\(Var(Y_i \mid X_i) = Var(\beta_0 + \beta_1X_i + \epsilon_i) = Var(\epsilon_i) = \sigma^2\)</span>.</p>
</div>
</div>
<p>Note that the variance of <span class="math inline">\(Y\)</span> does not depend on <span class="math inline">\(X\)</span>. No matter <span class="math inline">\(X\)</span> is large or small, the variation of <span class="math inline">\(Y\)</span> stays constant. If there are <span class="math inline">\(n\)</span> distinct <span class="math inline">\(x\)</span>s, there will be <span class="math inline">\(n\)</span> associated distinct normal distributions, all having the same variance. <!-- ::: --></p>
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-response-sd" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-response-sd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line_sig.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-response-sd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.14: <span class="math inline">\(Y\)</span> has a constant variance regardless of <span class="math inline">\(X\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<!-- <br> -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<p>Finally, if <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span>, it implies <span class="math inline">\(Y_i \mid X_i\)</span> is also normally distributed. In particular,</p>
<p><span class="math display">\[\begin{align*}
Y_i \mid X_i \stackrel{indep}{\sim} N(\beta_0 + \beta_1X_i, \sigma^2)
\end{align*}\]</span></p>
<p>For any fixed value of <span class="math inline">\(X_i = x_i\)</span>, the response, <span class="math inline">\(Y_i\)</span>, varies with <span class="math inline">\(N(\mu_{Y_i\mid x_i}, \sigma^2)\)</span>. For all levels of <span class="math inline">\(X\)</span>, their corresponding <span class="math inline">\(Y\)</span>s will be random around their mean, the regression function value at <span class="math inline">\(X\)</span>, to the same degree.</p>
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-response-normal" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-response-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/regression_line_sig_red.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-response-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.15: The response <span class="math inline">\(Y_i\)</span> follows a normal distribution.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p>Again, <span class="math inline">\(Y_i \mid X_i \stackrel{indep}{\sim} N(\beta_0 + \beta_1X_i, \sigma^2)\)</span> is our model assumption, and it is not necessarily true. When we perform simple liner regression analysis, we by default accept the assumption, and do the analysis based on the assumption. Our goal is to collect data and estimate the unknown parameters <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span>. Once <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are estimated, the entire regression line and function <span class="math inline">\(f(X) = \beta_0+\beta_1X\)</span> is also estimated.</p>
<p>Next section, we are going to learn how to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, or find the best estimated regression line.</p>
</section><section id="fitting-a-regression-line-haty-b_0-b_1x" class="level2" data-number="26.3"><h2 data-number="26.3" class="anchored" data-anchor-id="fitting-a-regression-line-haty-b_0-b_1x">
<span class="header-section-number">26.3</span> Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span>
</h2>
<p><span style="color:blue"> <strong>Idea of Fitting</strong> </span></p>
<p>Given the sample data <span class="math inline">\(\{ (x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\},\)</span> we like to ask these questions</p>
<ul>
<li>Which <em>sample</em> regression line is the <strong>best</strong>?</li>
<li>What are the <strong>best</strong> estimators, <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</li>
</ul>
<p>The sample regression line is is <span class="math inline">\(b_0+b_1X\)</span> that is used to estimate the unknown population regression line <span class="math inline">\(\beta_0 + \beta_1X\)</span>. The estimator <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are sample statistics. The process of finding the best <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> or the sample regression line is called <strong>model fitting</strong>. We <em>fit the simple linear regression model to the sample data</em>. Through model fitting, we find <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> or the sample regression line that fit the data the best. The sample regression line is best representative of the sample data, and we believe the sample line will be close to the population regression line the most.</p>
<p>We are interested in <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the following <em>sample</em> regression model: <span class="math display">\[\begin{align*}
y_i = \beta_0 + \beta_1~x_{i} + \epsilon_i,
\end{align*}\]</span> or <span class="math display">\[E({y}_{i} \mid x_i) = \mu_{y|x_i} = \beta_0 + \beta_1~x_{i}\]</span> We use the sample statistics <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, which are computed from our sample data, to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. <span class="math inline">\(\hat{y}_{i} = b_0 + b_1~x_{i}\)</span> is called the <strong>fitted value</strong> of <span class="math inline">\(y_i\)</span>. It is a point on the sample regression line, and is a point estimate of the mean, <span class="math inline">\(\mu_{y|x_i}\)</span>, and <span class="math inline">\(y_i\)</span> itself.</p>
<hr>
<p><span style="color:blue"> <strong>Ordinary Least Squares (OLS)</strong> </span></p>
<p>Given a data set, we could have many possible sample regression lines. In fact, there are infinitely many lines out there. Which one is the best?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-best-line" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-best-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-best-line-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-best-line-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.16: One data set can have multiple fitted regression lines.
</figcaption></figure>
</div>
</div>
</div>
<p>To answer such question, we need to first define what “the best” mean. Here we want to choose <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> or the sample regression line <span class="math inline">\(b_0 + b_1x\)</span> that minimizes the <strong>sum of squared residuals</strong> denoted by <strong><span class="math inline">\(SS_{res}\)</span></strong>. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The <strong>residual</strong>, <span class="math inline">\(e_i = y_i - \hat{y}_i = y_i - (b_0 + b_1x_i)\)</span>, is the difference between the data value <span class="math inline">\(y_i\)</span> and its fitted value <span class="math inline">\(\hat{y}_i\)</span>, the estimated value of <span class="math inline">\(y_i\)</span> on the sample regression line. Ideally, we hope the two quantities to be as close as possible because that means the estimation is quite good. The residual <span class="math inline">\(e_i\)</span> usually works as a point estimate of the error term <span class="math inline">\(\epsilon_i\)</span> in the model.</p>
<p>The <em>best</em> sample regression line minimizes the sum of squared residuals <span class="math display">\[SS_{res} = e_1^2 + e_2^2 + \dots + e_n^2 = \sum_{i = 1}^n e_i^2.\]</span></p>
<p>If <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the best estimators, plug <span class="math inline">\(e_i = y_i - (b_0 + b_1x_i)\)</span> into <span class="math inline">\(SS_{res}\)</span>, we have</p>
<p><span class="math display">\[\begin{align} SS_{res} &amp;= (y_1 - b_0 - b_1x_1)^2 + (y_2 - b_0 - b_1x_2)^2 + \dots + (y_n - b_0 - b_1x_n)^2\\ &amp;= \sum_{i=1}^n(y_i - b_0 - b_1x_i)^2 \end{align}\]</span> that is the smallest comparing to any other <span class="math inline">\(SS_{res} = \sum_{i=1}^n(y_i - a_0 - a_1x_i)^2\)</span> that uses another pair of estimators <span class="math inline">\((a_0, a_1) \ne (b_0, b_1)\)</span>.</p>
<p>Before we actually find <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, let’s visualize fitted values and residuals in the scatter plot.</p>
<!-- $SS_{res}$ is now a function of $b_0$ and $b_1$. So we can choose the pair $(b_0, b_1)$ that produces the smallest $SS_{res}$.  -->
<p><span style="color:red"> <strong><em>Visualizing Fitted Values and Residuals</em></strong> </span></p>
<p>The two variables are the Car Displacement in litres and Highway Miles per Gallon. The scatter plot shows a negatively correlated relationship.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The best sample regression line <span class="math inline">\(\hat{y} = b_0 + b_1 x\)</span> that minimizes <span class="math inline">\(SS_{res}\)</span> is the navy blue straight line. The red points on the line are the fitted value of <span class="math inline">\(y_i\)</span>s, or <span class="math inline">\(\hat{y_i} = b_0 + b_1 x_i\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residual <span class="math inline">\(e_i\)</span> is <span class="math inline">\(y_i - \hat{y}_i\)</span>. In the plot, it’s the difference between the black and red points. Each vertical bar shows the magnitude of a residual. If we square the size of all vertical bars and add them up, the sum will be our <span class="math inline">\(SS_{res}\)</span> value.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Least Squares Estimates (LSE)</em></strong> </span></p>
<p>It’s time to find the best <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize <span class="math inline">\(SS_{res}\)</span>. We call <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> <strong>least squares estimators (LSE)</strong> and the process of finding such estimators <strong>ordinary least squares (OLS)</strong> method.</p>
<!-- In the least squares approach, we choose the $b_0$ and $b_1$ that minimize the $SS_{res}$. -->
<p>Mathematically, <span class="math inline">\((b_0, b_1)\)</span> is the minimizer of the sum of squares</p>
<p><span class="math display">\[(b_0, b_1) = \arg \min_{\alpha_0, \alpha_1} \sum_{i=1}^n(y_i - \alpha_0 - \alpha_1x_i)^2\]</span></p>
<!-- - MATH 1450 ...  -->
<p>It is an optimization problem. I leave it to you as an exercise. The formula of LSE is</p>
<p><span class="math display">\[\color{red}{b_0 = \overline{y} - b_1\overline{x}}\]</span></p>
<p><span class="math display">\[\color{red}{b_1 = \frac{\sum_{i=1}^n(x_i - \overline{x})(y_i - \overline{y})}{\sum_{i=1}^n(x_i - \overline{x})^2} = \frac{S_{xy}}{S_{xx}} = r \frac{\sqrt{S_{yy}}}{\sqrt{S_{xx}}}},\]</span> where <span class="math inline">\(S_{xx} = \sum_{i=1}^n(x_i - \overline{x})^2\)</span>, <span class="math inline">\(S_{yy} = \sum_{i=1}^n(y_i - \overline{y})^2\)</span>, <span class="math inline">\(S_{xy} = \sum_{i=1}^n(x_i - \overline{x})(y_i - \overline{y})\)</span></p>
<p>Let’s see if we can get some intuition from the formula. First, the least squares regression line passes through the centroid <span class="math inline">\((\overline{x}, \overline{y})\)</span> because <span class="math inline">\(\overline{y} = b_0 + b_1\overline{x}\)</span>. In addition, <span class="math inline">\(b_1\)</span> is kind of like a scaled version of correlation coefficient of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. The correlation <span class="math inline">\(r\)</span> and the slope <span class="math inline">\(b_1\)</span> always have the same sign. A positive (negative) correlation implies a positive (negative) sloped regression line. The correlation <span class="math inline">\(r\)</span> is unit-free. When we fit a regression model, the slope <span class="math inline">\(b_1\)</span> size depends on the unit of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</p>
<p>Nowadays we use computing software to get the estimates, but it’s good to to know the idea of OLS, and the properties of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## What can we learn from the formula of $b_0$ and $b_1$? -->
<!-- ::: -->
<hr>
<p><span style="color:blue"> <strong>Fit a Simple Linear Regression in R</strong> </span></p>
<p>We use the <code>mpg</code> data set in the <code>ggplot2</code> package to demonstrate doing regression analysis in R. In particular, we grab the variable <code>hwy</code> as our response and <code>disp</code> as our predictor.</p>
<!-- <span style="color:blue"> **`mpg` Data** </span> -->
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
# ℹ 224 more rows</code></pre>
</div>
</div>
<p><span style="color:red"> <strong>Highway MPG <code>hwy</code> vs.&nbsp;Displacement <code>displ</code></strong> </span></p>
<p>First we create the scatter plot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>,</span>
<span>     las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong>Fit Simple Linear Regression</strong> </span></p>
<p>To fit a linear regression, we use the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function because linear regression is a linear model. As we learned in ANOVA <a href="model-anova.html" class="quarto-xref"><span>Chapter 23</span></a>, we write the formula <code>hwy ~ displ</code>, and specify the data set <code>mpg</code>. We save the fitted result in the object <code>reg_fit</code> which is a R list. The output prints <span class="math inline">\(b_0 = 35.70\)</span> and <span class="math inline">\(b_1 = -3.53\)</span>, the least squares estimate of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. So the sample regression function or regression line is <span class="math display">\[\widehat{hwy} = 35.7 - 3.53 \times disp.\]</span></p>
<p>For one unit (litre) increase of the displacement, we expect the highway MPG to be decreased, <em>on average</em>, by 3.53 miles.</p>
<!-- ::::{.columns} -->
<!-- :::{.column width="49%"} -->
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">hwy</span> <span class="op">~</span> <span class="va">displ</span>, data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
     35.698       -3.531  </code></pre>
</div>
</div>
<!-- ::: -->
<!-- :::{.column width="2%"} -->
<!-- ::: -->
<!-- :::{.column width="49%"} -->
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## all elements in reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## use $ to extract an element of a list</span></span>
<span><span class="va">reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       displ 
  35.697651   -3.530589 </code></pre>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p><span style="color:red"> <strong>Fitted Values of <span class="math inline">\(y\)</span></strong> </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 observed response value y</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29 29 31 30 26</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 fitted value y_hat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span>, <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
29.34259 29.34259 28.63647 28.63647 25.81200 </code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 predictor value x</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">displ</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.8 1.8 2.0 2.0 2.8</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 234</code></pre>
</div>
</div>
<!-- --------------------------------------------------------------- -->
<p><span style="color:red"> <strong>Add a Regression Line</strong> </span></p>
<p>To add the fitted regression line, we just put the fitted result <code>reg_fit</code> into the function <code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>, las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">reg_fit</span>, col <span class="op">=</span> <span class="st">"#FFCC00"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Estimation for <span class="math inline">\(\sigma^2\)</span></strong> </span></p>
<p>We can think of <span class="math inline">\(\sigma^2\)</span> as <strong>variance around the line</strong> or the <strong>mean square (prediction) error</strong>. It is the variance of the error term. Since the residual <span class="math inline">\(e_i\)</span> is the estimate of <span class="math inline">\(\epsilon_i\)</span>, we can use the variance of residuals to estimate <span class="math inline">\(\sigma^2\)</span>, which is the <strong>mean square residual</strong>, <span class="math inline">\(MS_{res}\)</span>: <span class="math display">\[\hat{\sigma}^2 = MS_{res} = \frac{SS_{res}}{n-2} = \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2} = \frac{\sum_{i=1}^ne_i^2}{n-2}.\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The variance of residuals is <span class="math inline">\(\frac{\sum_{i=1}^n(e_i - \overline{e})^2}{n-2}\)</span>. Because with OLS we have <span class="math inline">\(\sum_{i=1}^n e_i = 0\)</span>, <span class="math inline">\(\overline{e} = 0\)</span>, and hence <span class="math inline">\(\hat{\sigma}^2 = \frac{\sum_{i=1}^ne_i^2}{n-2}.\)</span></p></li>
<li><p>The degrees of freedom is the number of values in the final calculation of a statistic that are free to vary. It is equal to the sample size minus the number of parameters estimated. In simple linear regression, we estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the calculation of <span class="math inline">\(SS_{res}\)</span>, so its degrees of freedom is <span class="math inline">\(n-2\)</span>.</p></li>
</ul>
</div>
</div>
<p>Remember that a sum of squares has a corresponding degrees of freedom. <span class="math inline">\(SS_{res}\)</span> has <span class="math inline">\(n-2\)</span> degrees of freedom.</p>
<p><span class="math inline">\(MS_{res}\)</span> is often shown in computer output as <span class="math inline">\(\texttt{MS(Error)}\)</span> or <span class="math inline">\(\texttt{MS(Residual)}\)</span>.</p>
<p>By the way, <span class="math inline">\(E(MS_{res}) = \sigma^2\)</span>. Therefore, <span class="math inline">\(\hat{\sigma}^2\)</span> is an unbiased estimator for <span class="math inline">\(\sigma^2\)</span>.</p>
<!-- -------------------------------------------------------------------- -->
<p><span style="color:red"> <strong>Standard Error of Regression in R</strong> </span></p>
<p>The standard error <span class="math inline">\(\hat{\sigma}^2\)</span> information is saved in the summary of the fitted result. In the summary output, <span class="math inline">\(\hat{\sigma}^2\)</span> is shown as <code>Residual standard error</code>. The degrees of freedom is <span class="math inline">\(n - 2 = 234 - 2 = 232.\)</span></p>
<div class="cell" data-layout-align="center" data-output.lines="[15,16]">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">summ_reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...

Residual standard error: 3.836 on 232 degrees of freedom
...</code></pre>
</div>
</div>
<p>We can grab the <span class="math inline">\(\hat{\sigma}^2\)</span> value in the summary object <code>summ_reg_fit</code> by <code>summ_reg_fit$sigma</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lots of fitted information saved in summary(reg_fit)!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">summ_reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># residual standard error (sigma_hat)</span></span>
<span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.835985</code></pre>
</div>
</div>
<p>It is not hard to compute the <span class="math inline">\(MS_{res}\)</span> directly from its definition, the sum of squared residuals divided by residual degrees of freedom.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># from reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">residuals</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">reg_fit</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.835985</code></pre>
</div>
</div>
</section><section id="confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" class="level2" data-number="26.4"><h2 data-number="26.4" class="anchored" data-anchor-id="confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1">
<span class="header-section-number">26.4</span> Confidence Intervals and Hypothesis Testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>
</h2>
<p>We’ve obtained the point estimators of <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\sigma^2\)</span>. Often we’d like to do inference about the parameters, especially <span class="math inline">\(\beta_1\)</span> because it tells us how the predictor affects the response. In this section, we talk about interval estimation and testing procedure for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p><span style="color:blue"> <strong>Confidence Intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></strong> </span></p>
<p>Note that <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are functions of data. Because <span class="math inline">\(y_i\)</span>s are random variables (before being sampled), so are <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. As a result, they have their sampling distribution that is used for constructing the confidence interval for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> respectively. It can be show that</p>
<p><span class="math display">\[\frac{b_1 - \beta_1}{\sqrt{\hat{\sigma}^2/S_{xx}}} \sim t_{n-2}; \quad \frac{b_0 - \beta_0}{\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}} \sim t_{n-2}.\]</span></p>
<p>Therefore, the <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\beta_1\)</span> is <span class="math display">\[b_1 \pm t_{\alpha/2, n-2}\sqrt{\hat{\sigma}^2/S_{xx}}.\]</span></p>
<p>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\beta_0\)</span> is <span class="math display">\[b_0 \pm t_{\alpha/2, n-2}\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}.\]</span></p>
<!-- ----------------------------------------------------------------- -->
<p><span style="color:red"> <strong>Confidence Intervals in R</strong> </span></p>
<p>To grab the confidence interval for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, we simply put the fitted result into the <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> function. By default, the confidence level is 95%, but any other level can be specified. We say we are 95% confident that one unit increase of displacement will result in a decrease in highway miles per gallon on average by 3.91 to 3.15 miles.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">reg_fit</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 34.278353 37.11695
displ       -3.913828 -3.14735</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Hypothesis Testing</strong> </span></p>
<p>The hypothesis testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> is straightforward. Here I just show the case of two-tailed tests. The one-tailed tests can be done similarly.</p>
<p><span style="color:red"> <strong><span class="math inline">\(\beta_1\)</span></strong> </span></p>
<ul>
<li>
<span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = \beta_1^0 \quad H_1: \beta_1 \ne \beta_1^0\)</span> </span> <!-- - standard error of $b_1$: $se(b_1) = \sqrt{\frac{MS_{res}}{S_{xx}}}$ -->
</li>
<li>Test statistic: Under <span class="math inline">\(H_0\)</span>, <span class="math display">\[t_{test} = \frac{b_1 - \color{red}{\beta_1^0}}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \sim t_{n-2}\]</span>
</li>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if
<ul>
<li><span class="math inline">\(|t_{test}| &gt; t_{\alpha/2, \, n-2}\)</span></li>
<li><span class="math inline">\(\text{$p$-value} = 2P(t_{n-2} &gt; |t_{test}|) &lt; \alpha\)</span></li>
</ul>
</li>
</ul>
<p><span style="color:red"> <strong><span class="math inline">\(\beta_0\)</span></strong> </span></p>
<ul>
<li>
<span style="color:blue"> <span class="math inline">\(H_0: \beta_0 = \beta_0^0 \quad H_1: \beta_0 \ne \beta_0^0\)</span> </span> <!-- - standard error of $b_0$: $se(b_0) = \sqrt{MS_{res}\left(1/n + \overline{x}^2/S_{xx}\right)}$ -->
</li>
<li>Test statistic: Under <span class="math inline">\(H_0\)</span>, <span class="math display">\[t_{test} = \frac{b_0 - \color{red}{\beta_0^0}}{\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}} \sim t_{n-2}\]</span>
</li>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if
<ul>
<li><span class="math inline">\(|t_{test}| &gt; t_{\alpha/2, \, n-2}\)</span></li>
<li><span class="math inline">\(\text{$p$-value} = 2P(t_{n-2} &gt; |t_{test}|) &lt; \alpha\)</span></li>
</ul>
</li>
</ul>
<p><span style="color:red"> <strong>Testing in R</strong> </span></p>
<p>The two-sided test result for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> can be found in the summary output. There is a Coeffifcients table in the middle of the output. We can extract the table by check <code>summ_reg_fit$coefficients</code>. The first row is for intercept and the second for the slope. The columns from left to right are LSEs, the standard errors of LSEs, the <span class="math inline">\(t\)</span> test statistics, and <span class="math inline">\(p\)</span>-values.</p>
<div class="cell" data-layout-align="center" data-output.lines="[9,10,11,12]">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  35.6977     0.7204   49.55   &lt;2e-16 ***
displ        -3.5306     0.1945  -18.15   &lt;2e-16 ***
...</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value      Pr(&gt;|t|)
(Intercept) 35.697651  0.7203676  49.55477 2.123519e-125
displ       -3.530589  0.1945137 -18.15085  2.038974e-46</code></pre>
</div>
</div>
<p>Notice that the testing output is for the two-sided test with hypothesized value being equal to zero. The first row tests whether or not <span class="math inline">\(\beta_0 = 0\)</span> and the second tests whether or not <span class="math inline">\(\beta_1 = 0\)</span>.</p>
<p><span style="color:red"> <strong><em>Interpretation of Testing Results</em></strong> </span></p>
<p>Suppose we do the test <span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = 0 \quad H_1: \beta_1 \ne 0\)</span> </span>. <em>Failing to reject <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> implies there is <em>no (statistically significant) linear relationship</em> between (the mean of) <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. But be careful. They could have some other type of relationship.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-beta-meaning" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-beta-meaning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-beta-meaning-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beta-meaning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.17: Failing to reject <span class="math inline">\(H_0\)</span> means there is no linear relationship between X and Y, but they could have some other type of relationship.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
If we reject <span class="math inline">\(H_0: \beta_1 = 0\)</span>, does it mean <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><span style="color:red"> <strong><em>Test of Significance of Regression</em></strong> </span></p>
<p><em>Rejecting <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> could mean</p>
<ul>
<li><p>the straight-line model is adequate.</p></li>
<li><p>better results could be obtained with a more complicated model.</p></li>
</ul>
<p>Rejecting <span class="math inline">\(H_0\)</span> doesn’t necessarily mean that a linear model is the best model. There may be some other nonlinear relationship that cannot be captured by the linear regression model. To capture that, a more sophisticated model is needed.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-accept" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-accept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-reg_files/figure-html/fig-accept-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-accept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.18: Rejecting <span class="math inline">\(H_0\)</span> doesn’t necessarily mean that a linear model is the best model.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="analysis-of-variance-anova-approach" class="level2" data-number="26.5"><h2 data-number="26.5" class="anchored" data-anchor-id="analysis-of-variance-anova-approach">
<span class="header-section-number">26.5</span> Analysis of Variance (ANOVA) Approach</h2>
<p>The testing for <span class="math inline">\(\beta_1\)</span> can be done using ANOVA approach. The key idea is to separate the total deviation of <span class="math inline">\(y\)</span> from its mean into the deviation of <span class="math inline">\(y\)</span> explained by regression or the factor <span class="math inline">\(x\)</span> and the deviation of <span class="math inline">\(y\)</span> that cannot be explained by <span class="math inline">\(x\)</span>. Let’s learn about it.</p>
<p><span style="color:blue"> <strong><span class="math inline">\(X\)</span> - <span class="math inline">\(Y\)</span> Relationship Explains Some Deviation</strong> </span></p>
<p>First let me ask you a question.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Suppose we only have data for <span class="math inline">\(Y\)</span> and have no information about <span class="math inline">\(X\)</span> or no information about the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. How do we predict a value of <span class="math inline">\(Y\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>If we have sample data for <span class="math inline">\(y\)</span> only, then we just have one variable. If the data have no significant pattern, we may treat every data point equally, and our best guess for <span class="math inline">\(Y\)</span> could be <span class="math inline">\(\overline{y}\)</span>. In this case, we use the same value to predict every value of <span class="math inline">\(y\)</span>, i.e., <span class="math inline">\(\hat{y}_i = \overline{y}\)</span>. This prediction is generally bad, but there is nothing we can do because we have on other information that can help us better guess the value of <span class="math inline">\(y_i\)</span>.</p>
<p>If there is another variable <span class="math inline">\(X\)</span>, and <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are correlated, knowing the level of <span class="math inline">\(x\)</span> does help us predict the value of <span class="math inline">\(y\)</span>. If they are positively correlated, when <span class="math inline">\(x\)</span> is large, <span class="math inline">\(y\)</span> tends to be large. Thus normally we will guess its value higher than its average, leading to a smaller residual, and better prediction.</p>
<p>Losing such information hurts. With no information about the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. The best we can do is treat <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as uncorrelated, as if <span class="math inline">\(X\)</span> does not exist in the data. Same as one variable data of <span class="math inline">\(y\)</span>, in this case, <span class="math inline">\(\hat{y}_i = \overline{y}\)</span>.</p>
<p>The deviation of <span class="math inline">\(y\)</span> from the sample mean is <span class="math inline">\((y_i - \overline{y})\)</span>, which is viewed as the total deviation. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related, fitting a linear regression model helps us predict the value of <span class="math inline">\(Y\)</span> when the value of <span class="math inline">\(X\)</span> is provided. This means <span class="math inline">\(\hat{y}_i = b_0 + b_1x_i\)</span> is closer to <span class="math inline">\(y_i\)</span> than <span class="math inline">\(\overline{y}\)</span> is. In other words, the regression model <em>explains some of the deviation of <span class="math inline">\(y\)</span>.</em> The relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is valuable and helpful in predicting <span class="math inline">\(y\)</span> with the value of <span class="math inline">\(x\)</span> informed.</p>
<hr>
<p><span style="color:blue"> <strong>Partition of Deviation</strong> </span></p>
<p>The total deviation of <span class="math inline">\(y\)</span> from its mean can be written as the sum of the deviation of <span class="math inline">\(y\)</span> explained by regression or the factor <span class="math inline">\(x\)</span> and the deviation of <span class="math inline">\(y\)</span> that cannot be explained by <span class="math inline">\(x\)</span>.</p>
<p><em>Total deviation = Deviation explained by regression + unexplained deviation</em></p>
<p>or</p>
<p><span class="math display">\[(y_i - \overline{y}) = (\hat{y}_i - \overline{y}) + (y_i - \hat{y}_i)\]</span></p>
<p><a href="#fig-deviation-explained" class="quarto-xref">Figure&nbsp;<span>26.19</span></a> illustrates the deviation partition. Look at the point <span class="math inline">\(y_1\)</span>. Suppose <span class="math inline">\(y_1 = 19\)</span> and <span class="math inline">\(\overline{y} = 9\)</span>. Then the total deviation is <span class="math inline">\((y_i - \overline{y}) = 19-9 = 10\)</span> which is represented as the red bar on the left in the figure.</p>
<p>Now if the positive correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> information come in, we can better guess the value of <span class="math inline">\(y_1\)</span> using the least squares regression line <span class="math inline">\(\hat{y}_1 = b_0 + b_1x_1\)</span>. Note that <span class="math inline">\(y_1\)</span> is the observation whose <span class="math inline">\(x\)</span> is quite large, so through the regression line, we get the fitted value <span class="math inline">\(\hat{y}_1\)</span> larger than <span class="math inline">\(\overline{y}\)</span>. <span class="math inline">\(\hat{y}_1\)</span> is closer to <span class="math inline">\(y_1\)</span>, and the deviation <span class="math inline">\((\hat{y}_1 - \overline{y})\)</span> is the deviation of <span class="math inline">\(y\)</span> explained or captured by the regression model or the predictor <span class="math inline">\(X\)</span>. This corresponds to the green bar on the right of the figure. This deviation quantifies the contribution of the regression model or the predictor <span class="math inline">\(X\)</span> to explaining the variation of <span class="math inline">\(y\)</span>.</p>
<p>Finally, the remaining part of deviation that cannot be explained by <span class="math inline">\(x\)</span> is <span class="math inline">\((y_i - \hat{y}_i)\)</span> which is the blue bar in the middle of the figure. Look at it carefully. It is our residual! The residual is the deviation of <span class="math inline">\(y\)</span> that cannot be explained by the regression model. All the deviations that can be explained by predictor <span class="math inline">\(x\)</span> has been absorbed in <span class="math inline">\((\hat{y}_i - \overline{y})\)</span>. The deviation or residual <span class="math inline">\((y_i - \hat{y}_i)\)</span> is anything that has nothing to do with <span class="math inline">\(x\)</span>. This is what the regression model and the predictor <span class="math inline">\(x\)</span> can’t do for explaining the variation of <span class="math inline">\(y\)</span> unless other factors other than <span class="math inline">\(x\)</span> that are correlated with <span class="math inline">\(y\)</span> are considered in the model.</p>
<!-- the variation of $y$ is made of two parts, the regression function and the error term.  -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-deviation-explained" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-deviation-explained-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/partition.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-deviation-explained-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.19: Explained vs.&nbsp;unexplained deviation. Source: Applied Linear Statistical Models 5th edition.
</figcaption></figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Sum of Squares (SS)</em></strong> </span></p>
<p>The deviation partition leads to the sum of squares identity</p>
<p><span class="math display">\[\sum_{i=1}^n(y_i - \overline{y})^2 = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2 + \sum_{i=1}^n(y_i - \hat{y}_i)^2\]</span> or</p>
<p><em>Total Sum of Squares <span class="math inline">\((SS_T)\)</span> = Regression Sum of Squares <span class="math inline">\((SS_R)\)</span> + Residual Sum of Squares <span class="math inline">\((SS_{res})\)</span></em></p>
<p>Their corresponding degrees of freedom is</p>
<p><span class="math display">\[df_T = df_R + df_{res}\]</span></p>
<p>or <span class="math display">\[\color{blue}{(n-1) = 1 +(n-2)}\]</span></p>
<p>The total sum of squares quantifies the sum of squared deviation from the mean, and <span class="math inline">\(SS_T/df_T = \frac{\sum_{i=1}^n(y_i - \overline{y})^2}{n-1}\)</span> is the marginal sample variance of <span class="math inline">\(y\)</span> without being conditional on <span class="math inline">\(x\)</span>. The regression sum of squares <span class="math inline">\(SS_R\)</span> is the sum of squared deviation of the fitted value from the mean, and <span class="math inline">\(SS_{res}\)</span> again is the sum of squared deviation of <span class="math inline">\(y\)</span> from its fitted value. The mean square residual <span class="math inline">\(SS_{res}/df_{res} = \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2}\)</span> estimates the variance about the population regression line <span class="math inline">\(\sigma^2\)</span>.</p>
<hr>
<p><span style="color:blue"> <strong>ANOVA for Testing Significance of Regression</strong> </span></p>
<!-- # ```{r} -->
<!-- # #| label: fig-anova -->
<!-- # #| fig-cap: Example of an ANOVA table -->
<!-- # #| out-width: 100% -->
<!-- # knitr::include_graphics("./images/img-model/anova_table_reg.png") -->
<!-- # ``` -->
<p>The sum of squares and degrees of freedom identities allow us the make an ANOVA table as below. But what is this ANOVA table is for? It is used for testing <strong>overall significance of regression</strong>, that is, whether or not the regression model has explanatory power for explaining the variation of the response. When the regression model has explanatory power, all or some of its predictors are correlated with the response, and their corresponding regression coefficient is nonzero.</p>
<div class="small">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Source of Variation</th>
<th style="text-align: center;">SS</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">MS</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">
<span class="math inline">\(p\)</span>-value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Regression</td>
<td style="text-align: center;"><span class="math inline">\(SS_R = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(MS_R = \frac{SS_R}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MS_R}{MS_{res}} = F_{test}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Pr(F_{1, n-2} &gt; F_{test})\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Residual</td>
<td style="text-align: center;"><span class="math inline">\(SS_{res} = \sum_{i=1}^n(y_i - \hat{y}_i)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n-2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{res} = \frac{SS_{res}}{n-2}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;"><span class="math inline">\(SS_{T} = \sum_{i=1}^n(y_i - \overline{y})^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p>In other words, ANONA is for the test <span class="math display">\[
\begin{align*}
H_0&amp;: \text{all regression coefficients except the incercept is zero}\\
H_1&amp;: \text{At least one regression coefficient except the incercept is not zero}
\end{align*}
\]</span></p>
<p>A larger value of <span class="math inline">\(F_{test}\)</span> indicates that the regression is significant. <span class="math inline">\(H_0\)</span> is rejected if</p>
<ul>
<li><span class="math inline">\(F_{test} &gt; F_{\alpha, 1, n-2}\)</span></li>
<li>
<span class="math inline">\(\text{$p$-value} = P(F_{1, n-2} &gt; F_{test}) &lt; \alpha\)</span>.</li>
</ul>
<p>Note that ANOVA is designed to test the <span class="math inline">\(H_0\)</span> that <strong>all</strong> predictors have no value in predicting <span class="math inline">\(y\)</span>. In simple linear regression, there is only one predictor, so one means all. The <span class="math inline">\(F\)</span>-test of ANOVA gives the exactly same result as a two-sided <span class="math inline">\(t\)</span>-test of <span class="math inline">\(H_0: \beta_1 = 0\)</span>.</p>
<p><span style="color:red"> <strong>ANOVA Table in R</strong> </span></p>
<p>To get the ANOVA table, we put the fitted result into the function <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>. For simple linear regression, the ANOVA <span class="math inline">\(F\)</span> test is equivalent to the marginal <span class="math inline">\(t\)</span> test for <span class="math inline">\(\beta_1\)</span> where <span class="math inline">\(H_0: \beta_1 = 0; \quad H_1: \beta_1 \ne 0\)</span>. In particular <span class="math inline">\(t_{test}^2 = F_{test}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: hwy
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
displ       1 4847.8  4847.8  329.45 &lt; 2.2e-16 ***
Residuals 232 3413.8    14.7                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value      Pr(&gt;|t|)
(Intercept) 35.697651  0.7203676  49.55477 2.123519e-125
displ       -3.530589  0.1945137 -18.15085  2.038974e-46</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 329.4533</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Coefficient of Determination</strong> </span></p>
<p>The <strong>coefficient of determination</strong> or <span class="math inline">\(R^2\)</span> is the proportion of the variation in <span class="math inline">\(y\)</span> that is explained by the regression model. It is computed as <span class="math display">\[R^2 = \frac{SS_R}{SS_T} =\frac{SS_T - SS_{res}}{SS_T} = 1 - \frac{SS_{res}}{SS_T}\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the proportionate reduction of total variation associated with the use of <span class="math inline">\(X\)</span> , and it can be used to measure the quality of our regression or the explanatory power of regressors.</p>
<p><a href="#fig-r-squared" class="quarto-xref">Figure&nbsp;<span>26.20</span></a> shows two extreme cases.</p>
<ul>
<li><p><strong>(a)</strong> <span class="math inline">\(\hat{y}_i = y_i\)</span> and <span class="math inline">\(\small SS_{res} =  \sum_{i=1}^n(y_i - \hat{y}_i)^2 = 0\)</span>.</p></li>
<li><p><strong>(b)</strong> <span class="math inline">\(\hat{y}_i = \overline{y}\)</span> and <span class="math inline">\(\small SS_R = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2  = 0\)</span>.</p></li>
</ul>
<p>In (a), fitted values are equal to true observations. The regression model explains all the variation in <span class="math inline">\(y\)</span>, and hence <span class="math inline">\(R^2 = 1\)</span>. In (b), the fitted values are all equal to the sample mean of <span class="math inline">\(y\)</span> as if we don’t have information about <span class="math inline">\(x\)</span> or <span class="math inline">\(x\)</span> is totally useless in predicting <span class="math inline">\(y\)</span>. In this case, the regression model explains no variation in <span class="math inline">\(y\)</span>, and all variation remain unexplained. So <span class="math inline">\(R^2 = 0\)</span>. In the usual case, <span class="math inline">\(R^2\)</span> is between zero and one.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-r-squared" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-r-squared-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-model/r_square.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="486">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-squared-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;26.20: Examples of <span class="math inline">\(R^2\)</span> being equal to 1 and 0. Source: Applied Linear Statistical Model 5th edition.
</figcaption></figure>
</div>
</div>
</div>
<!-- ------------------------------------------------------------------- -->
<p><span style="color:red"> <strong><span class="math inline">\(R^2\)</span> in R</strong> </span></p>
<p>The <span class="math inline">\(R^2\)</span> value is shown in the summary output at the near bottom. We can also use <code>summ_reg_fit$r.squared</code> to get the value. The variable <code>disp</code> explains about 59% of the variation of <code>hwy</code>.</p>
<div class="cell" data-layout-align="center" data-output.lines="[16,17]">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
Residual standard error: 3.836 on 232 degrees of freedom
Multiple R-squared:  0.5868,    Adjusted R-squared:  0.585 
...</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">r.squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5867867</code></pre>
</div>
</div>
</section><section id="prediction" class="level2" data-number="26.6"><h2 data-number="26.6" class="anchored" data-anchor-id="prediction">
<span class="header-section-number">26.6</span> Prediction</h2>
<p>Prediction is one of our goals when we perform regression analysis. We want to use <span class="math inline">\(X\)</span> to predict <span class="math inline">\(Y\)</span> by taking advantages of their relationship. This is useful when our response variable includes some personal or confidential information, and it is hard to collect such information. When the predictor data is relatively easy to be collected, we can use the predictor value to predict the response value. For example, people tend to be reluctant to let others know their annual income level, but quite happy to talk about their education or occupation. If we can discover the relationship between salary level and years of education one receives, we can use the years of education to predict the mean salary level of people with that many years of education, or predict an individual salary level given his education years.</p>
<p>When we talk about prediction, we refer to the predictor and response whose values haven’t seen in the data. For example, if our data have three <span class="math inline">\(x\)</span> values <span class="math inline">\((3, 5, 6)\)</span>, and its corresponding <span class="math inline">\(y\)</span> values <span class="math inline">\((10, 12, 15)\)</span>, we want to predict the mean response value for the <span class="math inline">\(x\)</span> not in the data, like <span class="math inline">\(x = 4\)</span>.</p>
<p><span style="color:blue"> <strong>Predicting the Mean Response</strong> </span></p>
<p>With the predictor value <span class="math inline">\(x = x_0\)</span>, we want to estimate the mean response <span class="math inline">\(E(y\mid x_0) = \mu_{y|x_0} = \beta_0 + \beta_1 x_0\)</span>. For example, <span style="color:blue"> the <em>mean</em> highway MPG <span class="math inline">\(E(y \mid x_0)\)</span> when displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></p>
<p>The mean <span class="math inline">\(\beta_0 + \beta_1 x_0\)</span> is assumed from the regression model. The problem is <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown. Once we fit the model, and get the LSEs, if <span class="math inline">\(x_0\)</span> is <em>within the range of <span class="math inline">\(x\)</span></em>, an <em>unbiased</em> point estimate of <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math display">\[\widehat{E(y\mid x_0)} = \hat{\mu}_{y | x_0} = b_0 + b_1 x_0.\]</span></p>
<p>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math display">\[\boxed{\hat{\mu}_{y | x_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}}.\]</span></p>
<p>Well, no need to memorize the formula. But could you answer the following question?</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Does the length of the CI for <span class="math inline">\(E(y\mid x_0)\)</span> stay the same at any location of <span class="math inline">\(x_0\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>We will have the shortest confidence interval for <span class="math inline">\(E(y\mid x_0)\)</span> when <span class="math inline">\(x_0 = \overline{x}\)</span>. In general, we have better precision when the response we are interested is evaluated at the level <span class="math inline">\(x_0\)</span> that is close to <span class="math inline">\(\overline{x}\)</span>. The intuition is that the variation in the estimator <span class="math inline">\(b_0 + b_1 x\)</span> is greater when <span class="math inline">\(x_0\)</span> is far from <span class="math inline">\(\overline{x}\)</span> than when <span class="math inline">\(x_0\)</span> is near <span class="math inline">\(\overline{x}\)</span>.</p>
<hr>
<p><span style="color:blue"> <strong>Predicting New Observations</strong> </span></p>
<p>We want to predict not only the mean level of response at some predictor value, but also the value of a <em>new observation, <span class="math inline">\(y_0\)</span>,</em> at <span class="math inline">\(x = x_0\)</span>. For example, <span style="color:blue"> the <em>highway MPG of a car</em> <span class="math inline">\(y_0(x_0)\)</span> when its displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></p>
<p>Do you see the difference? Previously we care about the mean response level, but here we predict an individual response value. There are thousand of millions of cars having displacement 5.5 liters. If we’d like to know the average miles per gallon or general fuel efficiency performance for the cars with displacement 5.5, we are predicting the mean response. When we want to predict the miles per gallon of a specific car whose displacement is 5.5, we predicting a new observation. The car is an individual outcome drawn from those thousand of millions of cars.</p>
<p>A point estimator for <span class="math inline">\(y_0(x_0)\)</span> is <span class="math display">\[\hat{y}_0(x_0) = b_0 + b_1 x_0\]</span> that is the same as the point estimate of the mean response. If we can only use one single value to predict an new observation, we have to ignore its variation, and use a representative point to predict where it may be located. With no further information, we would choose its center, the mean response level, as its location. That’s why the two point estimates are the same.</p>
<!-- If we can only use one single value to predict an new observation, the point estimate is the same the -->
<p>The <span class="math inline">\((1-\alpha)100\%\)</span> <strong>prediction interval</strong> (PI) for <span class="math inline">\(y_0(x_0)\)</span> is <span class="math display">\[ \boxed{\hat{y_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{1+ \frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}}.\]</span></p>
<p>A confidence interval is for a unknown parameter. We call the interval prediction interval because <span class="math inline">\(y_0(x_0)\)</span> is not a parameter, but a random variable.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the difference between CI for <span class="math inline">\(E(y\mid x_0)\)</span> and PI for <span class="math inline">\(y_0(x_0)\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>The PI is wider as it includes the uncertainty about <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> as well as <span class="math inline">\(y_0\)</span> due to error, <span class="math inline">\(\epsilon\)</span>. The uncertainty about <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> is always there because their value varies from sample to sample, and this causes the uncertainty about the mean response, or the location of the distribution of <span class="math inline">\(y\)</span> at any given level of <span class="math inline">\(x\)</span>. The PI also considers the uncertainty about the draw of the distribution of <span class="math inline">\(y\)</span>, measured by <span class="math inline">\(\sigma^2\)</span>. Intuitively it is harder to predict a specific response value due to the additional randomness or variation within the probability distribution of <span class="math inline">\(y\)</span>. Given the same significance level <span class="math inline">\(\alpha\)</span>, we are more uncertain about what its value is, and the uncertainty band is wider, resulting in a less precise estimation.</p>
<!-- -------------------------------------------------------------------- -->
<p><span style="color:blue"> <strong>Prediction in R</strong> </span></p>
<p>To predict either the mean response or a new observation, we use the function <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>. The first argument is out fitted object <code>reg_fit</code>. Then we need to provide the predictor value for prediction in the argument <code>newdata</code>. Be careful that it has to be a data frame type, and variable’s name should be exactly the same as the predictor’s name in the original data set <code>mpg</code> when we fit the regression. If we want to get the confidence interval for the mean response, we specify “confidence” in the argument <code>interval</code>. If instead we want the prediction interval for a new response, we specify “predict”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## CI for the mean response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 16.27941 15.35839 17.20043</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## PI for the new observation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"predict"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 16.27941 8.665682 23.89314</code></pre>
</div>
</div>
<p>The 95% CI for the mean <code>hwy</code> when <code>disp = 5.5</code> is between 15.36 and 17.2, while The 95% PI for <code>hwy</code> of a car with <code>disp = 5.5</code> is between 8.67 and 23.89. The PI is much wider than the CI because the variance of <span class="math inline">\(y\)</span> for any given <span class="math inline">\(x\)</span> is quite large in this example. We are quite certain about the mean miles per gallon, but we are asked to predict a car’s miles per gallon, it’s hard to provide a precise estimation because of large individual variability.</p>
<!-- :::{layout-ncol=2} -->
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Data and regression line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>, las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7.5</span>, <span class="fl">45</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Highway MPG"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CI for the mean response"</span>, <span class="st">"PI for a new observation"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">reg_fit</span>, col <span class="op">=</span> <span class="st">"#003366"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">5.52</span>, y0 <span class="op">=</span> <span class="fl">15.35839</span>, y1 <span class="op">=</span> <span class="fl">17.20043</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="fl">5.48</span>, y0 <span class="op">=</span> <span class="fl">8.665682</span>, y1 <span class="op">=</span> <span class="fl">23.89314</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">16.27941</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For every possible value of <span class="math inline">\(x\)</span>, we can obtain its corresponding CI and PI. Connecting their upper bounds and lower bounds together ends up with a red confidence band and a blue prediction band. Both are narrowest at the average value of <span class="math inline">\(x\)</span>, the location of the black vertical bar, although it is not clearly seen in the prediction band. As <span class="math inline">\(x\)</span> is farther way from the mean, the two bands are getting wider.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="simulation-based-inference" class="level2" data-number="26.7"><h2 data-number="26.7" class="anchored" data-anchor-id="simulation-based-inference">
<span class="header-section-number">26.7</span> Simulation-based Inference</h2>
<p>We can use bootstrap to estimate the regression coefficients with uncertainty quantification without assuming or relying on normal distribution. Instead of doing distribution-based inference, we are doing simulation-based inference. Please go to <a href="infer-bt.html" class="quarto-xref"><span>Chapter 14</span></a> to review the idea of bootstrapping.</p>
<p>In simple linear regression, we perform bootstrap inference step by step as follows.</p>
<ol type="1">
<li><p><em>Bootstrap new samples <span class="math inline">\(\{x^b_j, y^b_j\}_{j=1}^n\)</span> from the original sample <span class="math inline">\(\{x_i, y_i\}_{i=1}^n\)</span>.</em> Note that the bootstrap sample has the same size of the original sample.</p></li>
<li><p><em>For each bootstrapped sample, we fit a simple linear regression model to it, and estimate the corresponding slope.</em> If we have <span class="math inline">\(B\)</span> bootstrapped samples, we then have <span class="math inline">\(B\)</span> different bootstrapped estimates of slope. Same idea for the intercept.</p></li>
<li><p><em>Use the distribution of the bootstrapped slopes to construct a confidence interval.</em> We plot the histogram of those <span class="math inline">\(B\)</span> slopes (and/or intercepts). Use it as the distribution of the slope. Then we can for example construct a 95% confidence interval for the slope by finding the 2.5% and 97.5% percentiles of the distribution.</p></li>
</ol>
<!-- # ```{r} --><!-- # set.seed(2023) --><!-- # # Load the data set --><!-- # delivery <- read.csv(file = "./data/data-ex-3-1.csv", --><!-- #                      header = TRUE) --><!-- # delivery_data <- delivery[, -1] --><!-- # colnames(delivery_data) <- c("time", "cases", "distance") --><!-- # df_boot_samples_5 <- delivery_data |> --><!-- #   specify(time ~ cases) |> --><!-- #   generate(reps = 5, type = "bootstrap") --><!-- # ``` --><p>The followings show the scatter plot of <code>hwy</code> vs.&nbsp;<code>displ</code> from the original <code>mpg</code> data set and 5 bootstrapped samples with their linear regression fitted line. First, you can see that due to randomness, the bootstrapped samples are all different although they all are of the same size. Secondly, since bootstrapped samples are different, they will have different intercept and slope estimates. In other words, all the blue fitted lines from the bootstrapped samples are different. They are also different from the red fitted line obtained from the original sample.</p>
<!-- ## Bootstrap Sample 1 -->
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<!-- ## Bootstrap Sample 2 -->
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<!-- ## Bootstrap Sample 3 -->
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<!-- ## Bootstrap Samples 1 - 5 -->
<p>We can repeatedly create bootstrapped samples lots of times. The collection of the fitted lines or the estimated intercepts and slopes let us know their possible values and the degree of uncertainty. Same as previous inference, we find that the uncertainty about the mean response when the predictor is away from its mean is larger than the uncertainty when the predictor value is close to its mean.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<!-- ## Slopes of bootstrap samples -->
<p>Another observation is that if we get the average of the 100 intercepts and slopes, as shown in the left panel of the figure below, the mean bootstrapped fitted line (darkblue) will be pretty close to the fitted line obtained from the original sample (red). The distribution of bootstrapped sample of slope with the mean (blue) and the 95% bootstrap CI (dashed green) is shown on the right.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<!-- - A 95% confidence interval is bounded by the middle 95% of the bootstrap distribution. -->
<p>As discussed in <span class="quarto-unresolved-ref">?sec-inter-bt</span>, we can use the <code>boot</code> package and its function <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot()</a></code> to do bootstrappingin R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">coef_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">index</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hwy</span> <span class="op">~</span> <span class="va">displ</span>, data <span class="op">=</span> <span class="va">data</span>, subset <span class="op">=</span> <span class="va">index</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu">boot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span>, statistic <span class="op">=</span> <span class="va">coef_fn</span>, R <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">boot_lm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot::boot(data = mpg, statistic = coef_fn, R = 100)


Bootstrap Statistics :
     original      bias    std. error
t1* 35.697651  0.12574153   0.9733547
t2* -3.530589 -0.03859401   0.2745006</code></pre>
</div>
</div>
<p>The function <code>coef_fn</code> returns the regression coefficient estimates from the bootstrapped samples that are the statistics needed for the argument <code>statistic</code> in the <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot()</a></code> function. We generate 100 bootstrap samples, and 100 corresponding bootstrap intercepts and slopes. The bootstrapping result is saved in the object <code>boot_lm</code> which is a list. <code>boot_lm$t0</code> saves the <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> estimates from the original data, and <code>boot_lm$t</code> saves the 100 bootstrap estimated intercepts and slopes. The bias shown in the printed output is the difference between the mean of bootstrap estimates and the original coefficient estimates. The std. error is derived from sd(boot_mean$t) that estimates the variance of the sample mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">boot_lm</span><span class="op">$</span><span class="va">t0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       displ 
  35.697651   -3.530589 </code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]      [,2]
[1,] 37.07809 -3.862234
[2,] 35.37438 -3.421966
[3,] 35.15120 -3.383944
[4,] 38.05982 -4.184231
[5,] 37.04109 -3.847217
[6,] 35.22920 -3.335708</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can get the confidence intervals for intercept and slope using <code><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci()</a></code> as we do in <a href="infer-bt.html" class="quarto-xref"><span>Chapter 14</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span>boot.out <span class="op">=</span> <span class="va">boot_lm</span>, index <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"norm"</span>,<span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 100 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_lm, type = c("norm", "basic", "perc"), 
    index = 1)

Intervals : 
Level      Normal              Basic              Percentile     
95%   (33.66, 37.48 )   (33.52, 37.78 )   (33.62, 37.87 )  
Calculations and Intervals on Original Scale
Some basic intervals may be unstable
Some percentile intervals may be unstable</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span>boot.out <span class="op">=</span> <span class="va">boot_lm</span>, index <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"norm"</span>,<span class="st">"basic"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 100 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_lm, type = c("norm", "basic", "perc"), 
    index = 2)

Intervals : 
Level      Normal              Basic              Percentile     
95%   (-4.030, -2.954 )   (-4.071, -2.941 )   (-4.121, -2.990 )  
Calculations and Intervals on Original Scale
Some basic intervals may be unstable
Some percentile intervals may be unstable</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are several ways of conducting bootstrapping in R. Here we choose to to use the <code>boot</code> package. Other popular packages include <a href="https://www.john-fox.ca/Companion/"><code>car</code></a>, and <a href="https://infer.netlify.app/"><code>infer</code></a> packages of the <a href="https://www.tidymodels.org/"><code>tidymodels</code></a> ecosystem. The <code>car</code> package is useful for regression analysis, and <code>tidymodels</code> is a trendy R framework of doing data science and machine learning.</p>
</div>
</div>
<!-- ## [R Lab]{.pink} Fit Regression to Bootstrap Samples {visibility="hidden"} -->
<!-- <!-- Take `100` bootstrap samples and fit models to each one: -->
<!-- :::: {.columns} -->
<!-- ::: {.column width="55%"} -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- set.seed(2023) -->
<!-- boot_fits <- mpg |>  -->
<!--   specify(hwy ~ displ) |>  -->
<!--   generate(reps = 100, type = "bootstrap") |>  -->
<!--   fit() -->
<!-- boot_fits -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: {.column width="45%"} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| eval: true -->
<!-- #| class-output: my_class600 -->
<!-- set.seed(2023) -->
<!-- boot_fits <- mpg |>  -->
<!--   specify(hwy ~ displ) |>  -->
<!--   generate(reps = 100, type = "bootstrap") |>  -->
<!--   fit() -->
<!-- boot_fits -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<!-- ## [R Lab]{.pink} Bootstrap CI {visibility="hidden"} -->
<!-- - **Percentile method**: Compute the 95% CI as the middle 95% of the bootstrap distribution: -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- observed_fit <- mpg |>  -->
<!--   specify(hwy ~ displ) |>  -->
<!--   fit() -->
<!-- boot_fits |> get_ci(point_estimate = observed_fit, type = "percentile") -->
<!-- ``` -->
<!-- . . . -->
<!-- - **Standard error method**: Compute the 95% CI as the point estimate $\pm$ \~2 standard deviations of the bootstrap distribution: -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- boot_fits |> get_ci(point_estimate = observed_fit, type = "se") -->
<!-- ``` -->
<!-- ::: notes -->
<!-- <!-- confint(lm(hwy~displ, data = delivery_data)) -->
<!-- ::: -->
<!-- ## [R Lab]{.pink} `car::Boot()` {visibility="hidden"} -->
<!-- - `car::Boot()` is a simple interface to the `boot::boot()`. -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- lm_fit <- lm(hwy ~ displ, data = mpg) -->
<!-- car_boot <- car::Boot(lm_fit, R = 100) -->
<!-- car::brief(car_boot$t) -->
<!-- ``` -->
<!-- ## [R Lab]{.pink} Histogram of Bootstrap Samples {visibility="hidden"} -->
<!-- - BC$_a$ is the **accelerated bias-corrected percentile interval**. -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| out-width: 80% -->
<!-- hist(car_boot) -->
<!-- ``` -->
<!-- ## [R Lab]{.pink} `car::Confint()` {visibility="hidden"} -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- car::Confint(lm_fit, vcov. = vcov(car_boot)) -->
<!-- ``` -->
<!-- ::: notes -->
<!-- check boot::boot.ci -->
<!-- ::: -->
</section><section id="relationship-between-anova-and-regression" class="level2" data-number="26.8"><h2 data-number="26.8" class="anchored" data-anchor-id="relationship-between-anova-and-regression">
<span class="header-section-number">26.8</span> Relationship between ANOVA and Regression*</h2>
<p>The predictor in our regression example is <code>displ</code>, which is a numerical variable. Remember that the regression model can also have categorical predictors. In <a href="model-anova.html" class="quarto-xref"><span>Chapter 23</span></a>, we learn the ANOVA, a model for examining whether or not the factors affect the mean response level. These factors are in fact a “value” of some categorical variable being studied. For example, when we examine the effect of different treatments (None, Fertilizer, Irrigation, Fertilizer and Irrigation) on the mean weights of poplar trees, we are examining the relationship between the two variables, the numerical response variable <code>weight of poplar tree</code> and the categorical explanatory variable <code>treatment type</code>.</p>
<p>In fact, when all the predictors in the regression model are categorical variables, ANOVA and regression are somewhat equivalent. Let’s first learn how to express a categorical variable in a regression model, then see why ANOVA can be viewed as a specific regression model.</p>
<section id="categorical-predictors-and-dummy-variables" class="level3" data-number="26.8.1"><h3 data-number="26.8.1" class="anchored" data-anchor-id="categorical-predictors-and-dummy-variables">
<span class="header-section-number">26.8.1</span> Categorical predictors and dummy variables</h3>
<p>Suppose now we want to see how the transmission type <code>trans</code> affects high miles per gallon <code>hwy</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 2
     hwy trans     
   &lt;int&gt; &lt;chr&gt;     
 1    29 auto(l5)  
 2    29 manual(m5)
 3    31 manual(m6)
 4    30 auto(av)  
 5    26 auto(l5)  
 6    26 manual(m5)
 7    27 auto(av)  
 8    26 manual(m5)
 9    25 auto(l5)  
10    28 manual(m6)
# ℹ 224 more rows</code></pre>
</div>
</div>
<p>Note that <code>trans</code> has so many different categories or “values” because of the parentheses terms. We can remove them so that the <code>trans</code> variable only has two categories: <code>auto</code> and <code>manual</code>, where <code>auto</code> means automatic transmission, and <code>manual</code> means manual transmission. The cleaned data set is called <code>mpg_trans</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mpg_trans</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hwy"</span>, <span class="st">"trans"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 2
     hwy trans 
   &lt;int&gt; &lt;chr&gt; 
 1    29 auto  
 2    29 manual
 3    31 manual
 4    30 auto  
 5    26 auto  
 6    26 manual
 7    27 auto  
 8    26 manual
 9    25 auto  
10    28 manual
# ℹ 224 more rows</code></pre>
</div>
</div>
<p>Before we fit a regression model, we need to make sure that the categorical variable is of type <code>character</code> or <code>factor</code> in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">mpg_trans</span><span class="op">$</span><span class="va">trans</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
<p>We use exactly the same command <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> to fit the regression when the predictor is categorical.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hwy</span> <span class="op">~</span> <span class="va">trans</span>, data <span class="op">=</span> <span class="va">mpg_trans</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ trans, data = mpg_trans)

Coefficients:
(Intercept)  transmanual  
     22.293        3.486  </code></pre>
</div>
</div>
<p>Writing code is a piece of cake. The more important thing is how we interpret the fitted result. Here, the variable <code>trans</code> has 2 categories. R will choose one as the <em>baseline level</em> that is used to compare to other levels, in this case, the only other variable. By default, R will choose the baseline level according to the category names alphabetically. Since <code>a</code> comes earlier than <code>m</code>, R chooses <code>auto</code> as the baseline level.</p>
<p>The idea is that when we fit a regression model with a categorical variable, we are learning how the (mean) response value changes when the category changes from the baseline level to another level. Notice that in the regression output, the slope coefficient label is <code>transmanual</code>. It is the concatenation of the categorical variable’s name <code>trans</code> and the non-baseline level <code>manual</code>. The slope tells us the changes in <code>hwy</code> when <em>the transmission is changed <strong>from</strong> <code>auto</code> <strong>to</strong> <code>manual</code></em>.</p>
<p>Mathematically the fitted regression equation is</p>
<p><span class="math display">\[\widehat{hwy_{i}} = 22.3 + 3.49~trans_i\]</span></p>
<p>Now the question is, how we define the value of <span class="math inline">\(trans_i\)</span> so that the equation makes sense, and it represents what we want do to for fitting the regression. The answer is, we define the <code>trans</code> variable using a <strong>dummy variable</strong> or indicator variable such as</p>
<p><span class="math display">\[trans = \begin{cases} 1  &amp; \quad \text{if manual transmission} \\ 0  &amp; \quad \text{if automatic transmission} \end{cases}\]</span> The new dummy variable <span class="math inline">\(trans\)</span> has values 0 or 1 only, and they are representing the two categories <code>auto</code> and <code>manual</code>. Furthermore, when the dummy variable is used in regression, the baseline level is always assigned value 0.</p>
<p>Now we are ready to interpret our fitted regression result.</p>
<ul>
<li>
<strong>Slope:</strong> Cars with <strong>manual</strong> transmission are expected, on average, to be 3.49 more miles per gallon than cars with <strong>auto</strong> transmission.
<ul>
<li>Compare baseline level (<code>trans = auto</code>) to the other level (<code>trans = manual</code>)</li>
</ul>
</li>
<li>
<strong>Intercept:</strong> Cars with <strong>auto</strong> transmission are expected, on average, to have 22.3 highway miles per gallon.</li>
</ul>
<p>Basically, the intercept value 22.3 is the average hwy MPG for cars with <code>auto</code> transmission because when <span class="math inline">\(trans_i\)</span> is <code>auto</code>, <span class="math inline">\(\widehat{hwy_{i}} = 22.3 + 3.49~(0) = 22.3\)</span>. The intercept + slope (22.3 + 3.49) is the average hwy MPG for cars with <code>manual</code> transmission because when <span class="math inline">\(trans_i\)</span> is <code>manual</code>, <span class="math inline">\(\widehat{hwy_{i}} = 22.3 + 3.49~(1) = 22.3 + 3.49\)</span>.</p>
<p>In general, when the categorical variable has <span class="math inline">\(k\)</span> categories, it needs <span class="math inline">\(k-1\)</span> dummy variables used in the regression model. Take regression or linear model courses for more discussion on categorical variables with more levels and dummy variables.</p>
</section><section id="anova-as-a-regression-model" class="level3" data-number="26.8.2"><h3 data-number="26.8.2" class="anchored" data-anchor-id="anova-as-a-regression-model">
<span class="header-section-number">26.8.2</span> ANOVA as a regression model</h3>
<p>Why ANOVA can be viewed as regression? Let’s first refresh our memory of ANOVA model.</p>
<p><span class="math display">\[y_{ij} = \mu + \tau_i + \epsilon_{ij}, \quad j = 1, 2, \dots, n_i, \quad i = 1, 2, \dots, t\]</span></p>
<ul>
<li>
<span class="math inline">\(\mu\)</span> is the overall mean across all <span class="math inline">\(t\)</span> populations.</li>
<li>
<span class="math inline">\(\tau_i\)</span> is the effect due to <span class="math inline">\(i\)</span>-th treatment.</li>
<li>
<span class="math inline">\(\epsilon_{ij}\)</span> is the random deviation of <span class="math inline">\(y_{ij}\)</span> about the <span class="math inline">\(i\)</span>-th population mean <span class="math inline">\(\mu_i = \mu+ \tau_i\)</span>.</li>
<li>
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau_i\)</span> are unknown constants.</li>
<li>ANOVA is a <strong>linear</strong> model.</li>
</ul>
<p>The assumptions of ANOVA are</p>
<ul>
<li>
<span class="math inline">\(\epsilon_{ij}\)</span>s are independent and normally distributed with mean 0.</li>
<li>
<span class="math inline">\(Var(\epsilon_{ij}) = \sigma^2\)</span> (<span style="color:blue"> a constant value </span>)</li>
<li><span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span></li>
</ul>
<p>In our transmission example, <span class="math inline">\(t = 2\)</span>. For simplicity, we can drop the subscript <span class="math inline">\(i\)</span> for bookkeeping the categories or groups, and rewrite our model as</p>
<p><span class="math display">\[y_{j} = \mu + \tau_j + \epsilon_{j}, \quad j = 1, 2, \dots, n, \quad \epsilon_j\sim N(0, \sigma^2).\]</span></p>
<p>Now <span class="math inline">\(y_{j}\)</span> is the <span class="math inline">\(j\)</span>th response in the data whose value is determined by the overall mean <span class="math inline">\(\mu\)</span>, and the treatment effect <span class="math inline">\(\tau_j\)</span> depending on which group/category this response is in, i.e.,</p>
<p><span class="math display">\[\tau_j = \begin{cases} \tau_m  &amp; \quad \text{if } j \text{th car has manual transmission} \\ \tau_a  &amp; \quad \text{if } j \text{th car has automatic transmission} \end{cases}\]</span></p>
<p>Does this model look like a regression model? In general, for a regression model with a categorical variable, we can write the model as</p>
<p><span class="math display">\[y_{j} = \beta_0 + \beta_1x_j + \epsilon_{j}, \quad j = 1, 2, \dots, n, \quad \epsilon_j\sim N(0, \sigma^2),\]</span> where <span class="math display">\[x_j = \begin{cases} 1  &amp; \quad \text{if } j \text{th subject is in the non-baseline level} \\ 0  &amp; \quad \text{if } j \text{th subject is in the baseline level}  \end{cases}\]</span></p>
<p>We are done! If we let <span class="math inline">\(\mu = \beta_0\)</span>, <span class="math inline">\(\tau_j = \beta_1x_j\)</span>, i.e., <span class="math inline">\(\tau_m = \beta_1\)</span> and <span class="math inline">\(\tau_a = 0\)</span>, the two models are equivalent.</p>
<p>By default, the regression model assumes the treatment effect of the baseline group is zero. Therefore <span class="math inline">\(\mu\)</span> is in fact the baseline group mean. The regression slope <span class="math inline">\(\beta_1\)</span> is actually the treatment effect of the other group, <span class="math inline">\(\tau_m\)</span>. Testing <span class="math inline">\(H_0: \tau_m = \tau_a\)</span> is equivalent to testing whether or not <span class="math inline">\(\beta_1\)</span> is zero, <span class="math inline">\(H_0: \beta_1 = 0\)</span>. In other words, the baseline group and the non-baseline group have no effect on the response value. The categorical variable does not contribute to the changes in the response, and therefore the mean response is at the same level regardless of categories or groups. Although here we use the factor having 2 categories as an example, the discussion here can be generalized to the categorical variable with more than two categories.</p>
</section></section><section id="exercises" class="level2" data-number="26.9"><h2 data-number="26.9" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">26.9</span> Exercises</h2>
<p>Use the data in the table below to answer questions 1-7.</p>
<table class="caption-top table"><tbody>
<tr class="odd">
<td>Tar</td>
<td>24</td>
<td>28</td>
<td>21</td>
<td>23</td>
<td>20</td>
<td>22</td>
<td>20</td>
<td>25</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Nicotine</td>
<td>1.6</td>
<td>1.7</td>
<td>1.2</td>
<td>1.4</td>
<td>1.1</td>
<td>1.0</td>
<td>1.3</td>
<td>1.2</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol type="1">
<li><p>Construct a scatterplot using tar for the <span class="math inline">\(x\)</span> axis and nicotine for the <span class="math inline">\(y\)</span> axis. Does the scatterplot suggest a linear relationship between the two variables? Are they positively or negatively related?</p></li>
<li><p>Let <span class="math inline">\(y\)</span> be the amount of nicotine and let <span class="math inline">\(x\)</span> be the amount of tar. Fit a simple linear regression to the data and identify the sample regression equation.</p></li>
<li><p>What percentage of the variation in nicotine can be explained by the linear correlation between nicotine and tar?</p></li>
<li><p>The Raleigh brand king size cigarette is not included in the table, and it has 21 mg of tar. What is the best predicted amount of nicotine? How does the predicted amount compare to the actual amount of 1.2 mg of nicotine? What is the value of residual?</p></li>
<li><p>Perform the test <span class="math inline">\(H_0: \beta_1 = 0\)</span> vs.&nbsp;<span class="math inline">\(H_1: \beta_1 \ne 0\)</span>.</p></li>
<li><p>Provide 95% confidence interval for <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>Generate the ANOVA table for the linear regression.</p></li>
</ol>
<p><br></p>
<ol start="8" type="1">
<li>
<strong>Correlation</strong> <em>(30 points)</em>: Match each correlation to the corresponding scatterplot.
<ol type="a">
<li><span class="math inline">\(R = -0.65\)</span></li>
<li><span class="math inline">\(R = 0.47\)</span></li>
<li><span class="math inline">\(R = 0.03\)</span></li>
<li><span class="math inline">\(R = 0.93\)</span></li>
</ol>
</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/correlation.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="9" type="1">
<li>
<strong>Regression</strong> <em>(30 points)</em>: The following regression output is for predicting the heart weight (in g) of cats from their body weight (in kg).
<ol type="a">
<li>Write out the simple linear regression equation.</li>
<li>Which one is the response variable and which one is the predictor (explanatory variable)?</li>
<li>Interpret the slope and intercept.</li>
</ol>
</li>
</ol>
<table class="caption-top table"><tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>-0.346</td>
</tr>
<tr class="even">
<td>body wt</td>
<td>3.953</td>
</tr>
</tbody></table>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the population correlation coefficient defined by <span class="math display">\[\rho = \frac{E\left[\left(X - \mu_X \right)\left(Y - \mu_Y\right)\right]}{\sigma_X\sigma_Y},\]</span> where <span class="math inline">\(\mu_X\)</span> is the mean of <span class="math inline">\(X\)</span>, <span class="math inline">\(\mu_Y\)</span> is the mean of <span class="math inline">\(Y\)</span>, <span class="math inline">\(\sigma_X\)</span> is the standard deviation of <span class="math inline">\(X\)</span>, and <span class="math inline">\(\sigma_Y\)</span> is the standard deviation of <span class="math inline">\(Y\)</span>. For more details, take a probability course or read a probability book.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We could use another definition of “the best”, for example the sum of absolute value of residuals. But the sum of squared residuals is the most commonly used one.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./model-twoway.html" class="pagination-link" aria-label="Two-Way ANOVA*">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./model-mlr.html" class="pagination-link" aria-label="Multiple Linear Regression*">
        <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multiple Linear Regression*</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/model-reg.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>