<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An comprehensive introductory statistical data science book.">
<title>Introduction to Statistics - 23&nbsp; Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./model-logistic.html" rel="next">
<link href="./model-anova.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">Statistics and Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">Summarizing Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Sample Statistics</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">Probability</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-samdist.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sampling Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">Statistical Inference</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Nonparametric Inference</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">Statistical Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Survival Analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#correlation" id="toc-correlation" class="nav-link active" data-scroll-target="#correlation"><span class="toc-section-number">23.1</span>  Correlation</a></li>
  <li><a href="#introduction-to-regression" id="toc-introduction-to-regression" class="nav-link" data-scroll-target="#introduction-to-regression"><span class="toc-section-number">23.2</span>  Introduction to Regression</a></li>
  <li><a href="#fitting-a-regression-line-haty-b_0-b_1x" id="toc-fitting-a-regression-line-haty-b_0-b_1x" class="nav-link" data-scroll-target="#fitting-a-regression-line-haty-b_0-b_1x"><span class="toc-section-number">23.3</span>  Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span></a></li>
  <li><a href="#confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" id="toc-confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" class="nav-link" data-scroll-target="#confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1"><span class="toc-section-number">23.4</span>  Confidence Intervals and Hypothesis Testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#analysis-of-variance-anova-approach" id="toc-analysis-of-variance-anova-approach" class="nav-link" data-scroll-target="#analysis-of-variance-anova-approach"><span class="toc-section-number">23.5</span>  Analysis of Variance (ANOVA) Approach</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="toc-section-number">23.6</span>  Prediction</a></li>
  <li><a href="#r-lab" id="toc-r-lab" class="nav-link" data-scroll-target="#r-lab"><span class="toc-section-number">23.7</span>  R Lab</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">23.8</span>  Exercises</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/model-reg.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-model-reg" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">

</div>
<section id="correlation" class="level2" data-number="23.1"><h2 data-number="23.1" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">23.1</span> Correlation</h2>
<p><span style="color:blue"> <strong>Relationship Between 2 Numerical Variables</strong> </span></p>
<ul>
<li>Depending on the situation, the two variables can be classified as the <em>explanatory</em> variable and the <em>response</em> variable. (Discussed in <strong>Regression</strong>)</li>
<li>However, there is not always an explanatory-response relationship.</li>
<li>Examples:
<ul>
<li><span style="color:blue"> height and weight </span></li>
<li><span style="color:blue"> income and age </span></li>
<li><span style="color:blue"> SAT/ACT math score and verbal score </span></li>
<li><span style="color:blue"> amount of time spent studying for an exam and exam grade </span></li>
</ul>
</li>
</ul>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Can you provide an example that 2 variables are associated?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Scatterplots</strong> </span></p>
<div class="cell" data-layout-align="center" data-fig.asp="0.4">
<div class="cell-output-display">
<div id="fig-scatterplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-scatterplot-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.1: Examples of scatterplots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The overall pattern can be described in several ways.
<ul>
<li>Form: linear or clusters</li>
<li>Direction: positively associated or negatively associated</li>
<li>Strength: how close the points lie to a line/curve</li>
</ul>
</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Linear Correlation Coefficient</strong> </span></p>
<ul>
<li>The <em>sample</em> <strong>correlation coefficient</strong>, denoted by <span class="math inline">\(r\)</span>, measures the <em>direction</em> and <em>strength</em> of the <strong>linear</strong> relationship between two numerical variables: <span class="math display">\[\small r :=\frac{1}{n-1}\sum_{i=1}^n\left(\frac{x_i-\overline{x}}{s_x}\right)\left(\frac{y_i-\overline{y}}{s_y}\right) = \frac{\sum_{i=1}^n(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i=1}^n(x_i-\overline{x})^2\sum_{i=1}^n(y_i-\overline{y})^2}}\]</span>
</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<ul>
<li><span class="math inline">\(-1 \le r\le 1\)</span></li>
<li>
<span class="math inline">\(r &gt; 0\)</span>: The <strong>larger</strong> value of <span class="math inline">\(X\)</span> is, the <strong>larger</strong> value of <span class="math inline">\(Y\)</span> tends to be.</li>
<li>
<span class="math inline">\(r = 1\)</span>: Perfect positive linear relationship.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-positive" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-positive-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.2: Positive correlation between two variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<ul>
<li>
<span class="math inline">\(r &lt; 0\)</span>: The <strong>larger</strong> value of <span class="math inline">\(X\)</span> is, the <strong>smaller</strong> value of <span class="math inline">\(Y\)</span> tends to be.</li>
<li>
<span class="math inline">\(r = -1\)</span>: Perfect negative linear relationship</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="fig-negative" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-negative-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.3: Negative correlation between two variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<ul>
<li>
<span class="math inline">\(r = 0\)</span>: No <strong>linear</strong> relationship.</li>
<li>If the explanatory and response variables are switched, <span class="math inline">\(r\)</span> remains the same.</li>
<li>
<span class="math inline">\(r\)</span> has no units of measurement, so scale changes do not affect <span class="math inline">\(r\)</span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="fig-no-correlation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-no-correlation-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.4: No correlation between two variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Example</em></strong> </span></p>
<ul>
<li>It is possible that there is a strong relationship between two variables, but they still have <span class="math inline">\(r = 0\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-correlation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/corr_ex.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.5: Examples of relationships between two variables and their correlation coefficients (https://upload.wikimedia.org/wikipedia/commons/d/d4/Correlation_examples2.svg)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Example in R</em></strong> </span></p>
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span>, y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"MPG vs. Weight"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Car Weight"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"Miles Per Gallon"</span>, </span>
<span>     pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fl">4</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span>,</span>
<span>    y <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8676594</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/car.jpeg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="introduction-to-regression" class="level2" data-number="23.2"><h2 data-number="23.2" class="anchored" data-anchor-id="introduction-to-regression">
<span class="header-section-number">23.2</span> Introduction to Regression</h2>
<p><span style="color:blue"> <strong>What is Regression?</strong> </span></p>
<ul>
<li>
<strong>Regression</strong> models the relationship between one or more numerical/categorical <strong>response variables <span class="math inline">\((Y)\)</span></strong> and one or more numerical/categorical <strong>explanatory variables <span class="math inline">\((X)\)</span></strong>.</li>
<li>A <strong>regression function</strong>, <span class="math inline">\(f(X)\)</span>, describes how a response variable, <span class="math inline">\(Y\)</span>, on average, changes as an explanatory variable, <span class="math inline">\(X\)</span>, changes.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Examples:
<ul>
<li><span style="color:blue"> College GPA <span class="math inline">\((Y)\)</span> vs.&nbsp;ACT/SAT score <span class="math inline">\((X)\)</span></span></li>
<li><span style="color:blue"> Sales <span class="math inline">\((Y)\)</span> vs.&nbsp;Advertising Expenditure <span class="math inline">\((X)\)</span></span></li>
<li><span style="color:blue"> Crime Rate <span class="math inline">\((Y)\)</span> vs.&nbsp;Median Income Level <span class="math inline">\((X)\)</span> </span></li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-function" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-regression-function-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.6: Example of a Regression Function</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Unknown Regression Function</strong> </span></p>
<ul>
<li>The true relationship between <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(Y\)</span>, the regression function <span class="math inline">\(f(X)\)</span>, is <strong>unknown</strong>.</li>
<li>The collected data <span class="math inline">\((x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\)</span> are all we know and have.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-unknown-reg-function" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-unknown-reg-function-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.7: Data with an unknown regression function</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Goal: <strong>Estimate</strong> <span class="math inline">\(f(X)\)</span> from our data, and use it to <strong>predict</strong> the value of <span class="math inline">\(Y\)</span> given a value of <span class="math inline">\(X\)</span>.</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Simple Linear Regression</strong> </span></p>
<ul>
<li>Start with <strong>simple linear regression</strong>.
<ul>
<li>There is <strong>only one</strong> predictor, <span class="math inline">\(X\)</span> (<strong>known</strong> and <strong>constant</strong>), and <strong>one</strong> response variable, <span class="math inline">\(Y\)</span>.</li>
<li>The regression function used for predicting <span class="math inline">\(Y\)</span> is a <strong>linear</strong> function.</li>
<li>Use a <em>regression line</em> in an X-Y plane to predict the value of <span class="math inline">\(Y\)</span> for a given value of <span class="math inline">\(X = x\)</span>.</li>
</ul>
</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<strong>Math review</strong>: A linear function <span class="math inline">\(y = f(x) = \beta_0 + \beta_1 x\)</span> represents a straight line.
<ul>
<li>
<span class="math inline">\(\beta_1\)</span>: <strong>slope</strong>, the amount by which <span class="math inline">\(y\)</span> changes when <span class="math inline">\(x\)</span> increases by one unit</li>
<li>
<span class="math inline">\(\beta_0\)</span>: <strong>intercept</strong>, the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>
</li>
<li>The linearity assumption: <span class="math inline">\(\beta_1\)</span> does not change as <span class="math inline">\(x\)</span> changes.</li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/reg_line.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.8: Example of a regression line</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Sample Data: Relationship Between X and Y</em></strong> </span></p>
<ul>
<li>Real data <span class="math inline">\((x_i, y_i), i = 1, 2, \dots, n\)</span> do not form a perfect straight line!</li>
<li><span class="math inline">\(y_i = \beta_0+\beta_1x_i + \color{red}{\epsilon_i}\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-relationship-xy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-relationship-xy-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.9: Actual relationship between X and Y isn’t perfectly linear</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>When we collect our data, at any given level of <span class="math inline">\(X = x\)</span>, <span class="math inline">\(y\)</span> is assumed to be drawn from a normal distribution (for inference purpose).</li>
<li>Its value varies and will not be exactly equal to its mean, <span class="math inline">\(\mu_y\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-dist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/regression_line_data_blue.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.10: Illustration that the responses, y, follow a normal distribution</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The <strong>mean of <span class="math inline">\(Y\)</span></strong> and <span class="math inline">\(X\)</span> form a straight line.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-regression-mean" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/regression_line.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.11: Illustration that the regression line is formed from the mean of Y and X</figcaption><p></p>
</figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Simple Linear Regression Model (Population)</strong> </span></p>
<ul>
<li>For the <span class="math inline">\(i\)</span>-th measurement in the target population, <span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \epsilon_i\]</span>
<ul>
<li>
<span class="math inline">\(Y_i\)</span>: the <span class="math inline">\(i\)</span>-th value of the response (random) variable.</li>
<li>
<span class="math inline">\(X_i\)</span>: the <span class="math inline">\(i\)</span>-th <strong>fixed known</strong> value of the predictor.</li>
<li>
<span class="math inline">\(\epsilon_i\)</span>: the <span class="math inline">\(i\)</span>-th random error with the assumption <span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span>.</li>
<li>
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are model <strong>coefficients</strong>.</li>
<li>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span> are <strong>fixed unknown parameters</strong> to be estimated from the sample data once we collect them.</li>
</ul>
</li>
</ul>
<p><span style="color:red"> <strong><em>Important Features of Model <span class="math inline">\(Y_i = \beta_0 + \beta_1X_i + \epsilon_i\)</span></em></strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math inline">\(\epsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\)</span> <span class="math display">\[\begin{align*}
\mu_{Y_i \mid X_i} &amp;= E(\beta_0 + \beta_1X_i + \epsilon_i) \\
&amp;= \beta_0 + \beta_1X_i
\end{align*}\]</span></p>
<ul>
<li>The <strong>mean response</strong>, <span class="math inline">\(\mu_{Y\mid X}\)</span>, has a <strong>straight-line</strong> relationship with <span class="math inline">\(X\)</span> given by a population regression line <span class="math display">\[\mu_{Y\mid X} = \beta_0 + \beta_1X\]</span>
</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-straight-line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/regression_line_red.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.12: Illustration of the straight line relationship between <span class="math inline">\(\mu_{Y\mid X}\)</span> and <span class="math inline">\(X\)</span></figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\begin{align*}
Var(Y_i \mid X_i) &amp;= Var(\epsilon_i) = \sigma^2
\end{align*}\]</span></p>
<ul>
<li>The variance of <span class="math inline">\(Y\)</span> does not depend on <span class="math inline">\(X\)</span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-response-sd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/regression_line_sig.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.13: <span class="math inline">\(Y\)</span> has a constant variance regardless of <span class="math inline">\(X\)</span>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\begin{align*}
Y_i \mid X_i \stackrel{indep}{\sim} N(\beta_0 + \beta_1X_i, \sigma^2)
\end{align*}\]</span></p>
<ul>
<li>For any fixed value of <span class="math inline">\(X_i = x_i\)</span>, the response, <span class="math inline">\(Y_i\)</span>, varies with <span class="math inline">\(N(\mu_{Y_i\mid x_i}, \sigma^2)\)</span>.</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-response-normal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/regression_line_sig_red.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.14: The response <span class="math inline">\(Y_i\)</span> follows a normal distribution.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>
<strong>Job</strong>: Collect data and estimate the unknown parameters <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\sigma^2\)</span>!</li>
</ul></section><section id="fitting-a-regression-line-haty-b_0-b_1x" class="level2" data-number="23.3"><h2 data-number="23.3" class="anchored" data-anchor-id="fitting-a-regression-line-haty-b_0-b_1x">
<span class="header-section-number">23.3</span> Fitting a Regression Line <span class="math inline">\(\hat{Y} = b_0 + b_1X\)</span>
</h2>
<p><span style="color:blue"> <strong>Idea of Fitting</strong> </span></p>
<ul>
<li>Given the sample data <span class="math inline">\(\{ (x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\},\)</span>
<ul>
<li>Which <em>sample</em> regression line is the <strong>best</strong>?</li>
<li>What are the <strong>best</strong> estimators, <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</li>
</ul>
</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="model-reg_cache/html/fig-best-line_8061626e667ac7c27afee8cbf7fb1350">
<div class="cell-output-display">
<div id="fig-best-line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-best-line-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.15: One data set can have multiple fitted regression lines</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>We are interested in <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the following <em>sample</em> regression model: <span class="math display">\[\begin{align*}
y_i = \beta_0 + \beta_1~x_{i} + \epsilon_i,
\end{align*}\]</span> or <span class="math display">\[E({y}_{i}) = \mu_{y|x_i} = \beta_0 + \beta_1~x_{i}\]</span></p></li>
<li><p>We use the sample statistics <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, which are computed from our sample data, to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{y}_{i} = b_0 + b_1~x_{i}\)</span> is called the <strong>fitted value</strong> of <span class="math inline">\(y_i\)</span> and is a point estimate of the mean, <span class="math inline">\(\mu_{y|x_i}\)</span>, and <span class="math inline">\(y_i\)</span> itself.</p></li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Ordinary Least Squares (OLS)</strong> </span></p>
<ul>
<li>What does best mean?
<ul>
<li>We want to choose <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> or the sample regression line <span class="math inline">\(b_0 + b_1x\)</span> that minimizes the <strong>sum of squared residuals <span class="math inline">\(SS_{res}\)</span></strong>.</li>
</ul>
</li>
<li>The <strong>residual</strong>, <span class="math inline">\(e_i = y_i - \hat{y}_i = y_i - (b_0 + b_1x_i)\)</span>, is a point estimate of <span class="math inline">\(\epsilon_i\)</span>.</li>
<li>The sample regression line minimizes <span class="math inline">\(SS_{res} = e_1^2 + e_2^2 + \dots + e_n^2 = \sum_{i = 1}^n e_i^2\)</span>. <span class="math display">\[\small{\begin{align} SS_{res} &amp;= (y_1 - b_0 - b_1x_1)^2 + (y_2 - b_0 - b_1x_2)^2 + \dots + (y_n - b_0 - b_1x_n)^2\\ &amp;= \sum_{i=1}^n(y_i - b_0 - b_1x_i)^2 \end{align}}\]</span>
</li>
</ul>
<p><span style="color:red"> <strong><em>Visualizing Residuals</em></strong> </span></p>
<div class="cell" data-layout-align="center" data-hash="model-reg_cache/html/vis-res-1_34c849a79c27b5ad40cbba2bfddf167b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/vis-res-1-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/vis-res-2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/vis-res-3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Least Squares Estimates (LSE)</em></strong> </span></p>
<ul>
<li><p>In the least squares approach, we choose the <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize the <span class="math inline">\(SS_{res}\)</span>. <span class="math display">\[(b_0, b_1) = \arg \min_{\beta_0, \beta_1} \sum_{i=1}^n(y_i - \beta_0 - \beta_1x_i)^2\]</span></p></li>
<li><p>MATH 1450 …</p></li>
</ul>
<p><span class="math display">\[\color{red}{b_0 = \overline{y} - b_1\overline{x}}\]</span></p>
<p><span class="math display">\[\color{red}{b_1 = \frac{\sum_{i=1}^n(x_i - \overline{x})(y_i - \overline{y})}{\sum_{i=1}^n(x_i - \overline{x})^2} = \frac{S_{xy}}{S_{xx}} = r \frac{\sqrt{S_{yy}}}{\sqrt{S_{xx}}}},\]</span> where <span class="math inline">\(S_{xx} = \sum_{i=1}^n(x_i - \overline{x})^2\)</span>, <span class="math inline">\(S_{yy} = \sum_{i=1}^n(y_i - \overline{y})^2\)</span>, <span class="math inline">\(S_{xy} = \sum_{i=1}^n(x_i - \overline{x})(y_i - \overline{y})\)</span></p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
What can we learn from the formula of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Estimation for <span class="math inline">\(\sigma^2\)</span></strong> </span></p>
<ul>
<li>We can think of <span class="math inline">\(\sigma^2\)</span> as <strong>variance around the line</strong> or the <strong>mean square (prediction) error</strong>.</li>
<li>The estimate of <span class="math inline">\(\sigma^2\)</span> is the <strong>mean square residual</strong>, <span class="math inline">\(MS_{res}\)</span>: <span class="math display">\[\hat{\sigma}^2 = MS_{res} = \frac{SS_{res}}{n-2} = \frac{\sum_{i=1}^n(y_i - \hat{y}_i)^2}{n-2}\]</span>
</li>
<li>
<span class="math inline">\(MS_{res}\)</span> is often shown in computer output as <span class="math inline">\(\texttt{MS(Error)}\)</span> or <span class="math inline">\(\texttt{MS(Residual)}\)</span>.</li>
<li>
<span class="math inline">\(E(MS_{res}) = \sigma^2\)</span>
<ul>
<li>Therefore, <span class="math inline">\(\hat{\sigma}^2\)</span> is an unbiased estimator for <span class="math inline">\(\sigma^2\)</span> 👍.</li>
</ul>
</li>
</ul></section><section id="confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1" class="level2" data-number="23.4"><h2 data-number="23.4" class="anchored" data-anchor-id="confidence-intervals-and-hypothesis-testing-for-beta_0-and-beta_1">
<span class="header-section-number">23.4</span> Confidence Intervals and Hypothesis Testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>
</h2>
<p><span style="color:blue"> <strong>Confidence Intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></strong> </span></p>
<ul>
<li>
<span class="math inline">\(\frac{b_1 - \beta_1}{\sqrt{\hat{\sigma}^2/S_{xx}}} \sim t_{n-2}\)</span>; <span class="math inline">\(\quad \frac{b_0 - \beta_0}{\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}} \sim t_{n-2}\)</span>
</li>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\(b_1 \pm t_{\alpha/2, n-2}\sqrt{\hat{\sigma}^2/S_{xx}}\)</span>
</li>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\(b_0 \pm t_{\alpha/2, n-2}\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}\)</span>
</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Hypothesis Testing</strong> </span></p>
<p><span style="color:red"> <strong><span class="math inline">\(\beta_1\)</span></strong> </span></p>
<ul>
<li>
<span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = \beta_1^0 \quad H_1: \beta_1 \ne \beta_1^0\)</span> </span> <!-- - standard error of $b_1$: $se(b_1) = \sqrt{\frac{MS_{res}}{S_{xx}}}$ -->
</li>
<li>Test statistic: Under <span class="math inline">\(H_0\)</span>, <span class="math display">\[t_{test} = \frac{b_1 - \color{red}{\beta_1^0}}{\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}} \sim t_{n-2}\]</span>
</li>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if
<ul>
<li><span class="math inline">\(|t_{test}| &gt; t_{\alpha/2, \, n-2}\)</span></li>
<li><span class="math inline">\(\text{$p$-value} = 2P(t_{n-2} &gt; |t_{test}|) &lt; \alpha\)</span></li>
</ul>
</li>
</ul>
<p><span style="color:red"> <strong><span class="math inline">\(\beta_0\)</span></strong> </span></p>
<ul>
<li>
<span style="color:blue"> <span class="math inline">\(H_0: \beta_0 = \beta_0^0 \quad H_1: \beta_0 \ne \beta_0^0\)</span> </span> <!-- - standard error of $b_0$: $se(b_0) = \sqrt{MS_{res}\left(1/n + \overline{x}^2/S_{xx}\right)}$ -->
</li>
<li>Test statistic: Under <span class="math inline">\(H_0\)</span>, <span class="math display">\[t_{test} = \frac{b_0 - \color{red}{\beta_0^0}}{\sqrt{\hat{\sigma}^2\left(\frac{1}{n} + \frac{\overline{x}^2}{S_{xx}}\right)}} \sim t_{n-2}\]</span>
</li>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if
<ul>
<li><span class="math inline">\(|t_{test}| &gt; t_{\alpha/2, \, n-2}\)</span></li>
<li><span class="math inline">\(\text{$p$-value} = 2P(t_{n-2} &gt; |t_{test}|) &lt; \alpha\)</span></li>
</ul>
</li>
</ul>
<p><span style="color:red"> <strong><em>Interpretation of Testing Results</em></strong> </span></p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(H_0: \beta_1 = 0 \quad H_1: \beta_1 \ne 0\)</span> </span></li>
<li>
<em>Failing to reject <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> implies there is <strong>no linear relationship</strong> between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center" data-fig.asp="0.5" data-hash="model-reg_cache/html/fig-beta-meaning_f2912f205ffbb90582a118d2e4eba098">
<div class="cell-output-display">
<div id="fig-beta-meaning" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-beta-meaning-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.16: Failing to reject <span class="math inline">\(H_0\)</span> means there is no linear relationship between X and Y, but they could have some other type of relationship.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
If we reject <span class="math inline">\(H_0: \beta_1 = 0\)</span>, does it mean <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><span style="color:red"> <strong><em>Test of Significance of Regression</em></strong> </span></p>
<ul>
<li>
<em>Rejecting <span class="math inline">\(H_0: \beta_1 = 0\)</span></em> could mean
<ul>
<li>the straight-line model is adequate.</li>
<li>better results could be obtained with a more complicated model.</li>
</ul>
</li>
</ul>
<div class="cell" data-layout-align="center" data-fig.asp="0.5" data-hash="model-reg_cache/html/fig-accept_fbb0a3fbecd509b023f2043f6919bfaa">
<div class="cell-output-display">
<div id="fig-accept" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="model-reg_files/figure-html/fig-accept-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.17: Rejecting <span class="math inline">\(H_0\)</span> doesn’t necessarily mean that a linear model is the best model, just that it is adequate.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="analysis-of-variance-anova-approach" class="level2" data-number="23.5"><h2 data-number="23.5" class="anchored" data-anchor-id="analysis-of-variance-anova-approach">
<span class="header-section-number">23.5</span> Analysis of Variance (ANOVA) Approach</h2>
<p><span style="color:blue"> <strong><span class="math inline">\(X\)</span> - <span class="math inline">\(Y\)</span> Relationship Explains Some Deviation</strong> </span></p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Suppose we only have data for <span class="math inline">\(Y\)</span> and have no information about <span class="math inline">\(X\)</span> or the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. How do we predict a value of <span class="math inline">\(Y\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<ul>
<li>If the data have no pattern, our best guess for <span class="math inline">\(Y\)</span> would be <span class="math inline">\(\overline{y}\)</span> (i.e., <span class="math inline">\(\hat{y}_i = \overline{y}\)</span>).
<ul>
<li>We would treat <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as uncorrelated.</li>
</ul>
</li>
<li>The (total) deviation from the mean is <span class="math inline">\((y_i - \overline{y})\)</span>
</li>
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly related, fitting a linear regression model helps us predict the value of <span class="math inline">\(Y\)</span> when the value of <span class="math inline">\(X\)</span> is provided.</li>
<li>
<span class="math inline">\(\hat{y}_i = b_0 + b_1x_i\)</span> is closer to <span class="math inline">\(y_i\)</span> than <span class="math inline">\(\overline{y}\)</span>.</li>
<li>The regression model explains some of the deviation of <span class="math inline">\(y\)</span>.</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Partition of Deviation</strong> </span></p>
<ul>
<li><strong>Total deviation = Deviation explained by regression + unexplained deviation</strong></li>
<li><span class="math inline">\((y_i - \overline{y}) = (\hat{y}_i - \overline{y}) + (y_i - \hat{y}_i)\)</span></li>
<li><span class="math inline">\((19 - 9) = (13 - 9) + (19 - 13)\)</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-deviation-explained" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/partition.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.18: Explained vs.&nbsp;unexplained deviation</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Sum of Squares (SS)</em></strong> </span></p>
<ul>
<li><span class="math inline">\(\sum_{i=1}^n(y_i - \overline{y})^2 = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2 + \sum_{i=1}^n(y_i - \hat{y}_i)^2\)</span></li>
<li><strong>Total SS <span class="math inline">\((SS_T)\)</span> = Regression SS <span class="math inline">\((SS_R)\)</span> + Residual SS <span class="math inline">\((SS_{res})\)</span></strong></li>
<li><span class="math inline">\(df_T = df_R + df_{res}\)</span></li>
<li><span class="math inline">\(\color{blue}{(n-1) = 1 +(n-2)}\)</span></li>
</ul>
<hr>
<p><span style="color:blue"> <strong>ANOVA for Testing Significance of Regression</strong> </span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-anova" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/anova_table.png" class="img-fluid figure-img" style="width:90.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.19: Example of an ANOVA table</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>A larger value of <span class="math inline">\(F_{test}\)</span> indicates that the regression is significant.</li>
<li>Reject <span class="math inline">\(H_0\)</span> if
<ul>
<li><span class="math inline">\(F_{test} &gt; F_{\alpha, 1, n-2}\)</span></li>
<li>
<span class="math inline">\(\text{$p$-value} = P(F_{1, n-2} &gt; F_{test}) &lt; \alpha\)</span>.</li>
</ul>
</li>
<li>ANOVA is designed to test the <span class="math inline">\(H_0\)</span> that <strong>all</strong> predictors have no value in predicting <span class="math inline">\(y\)</span>.</li>
<li>In SLR, the <span class="math inline">\(F\)</span>-test of ANOVA gives the same result as a two-sided <span class="math inline">\(t\)</span>-test of <span class="math inline">\(H_0: \beta_1=0\)</span>.</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Coefficient of Determination</strong> </span></p>
<ul>
<li>The <strong>coefficient of determination</strong> <span class="math inline">\((R^2)\)</span> is the proportion of the variation in <span class="math inline">\(y\)</span> that is explained by the regression model.</li>
<li>It is computed as <span class="math display">\[R^2 = \frac{SS_R}{SS_T} =\frac{SS_T - SS_{res}}{SS_T} = 1 - \frac{SS_{res}}{SS_T}\]</span>
</li>
<li>
<span class="math inline">\(R^2\)</span> is the proportionate reduction of total variation associated with the use of <span class="math inline">\(X\)</span>.</li>
<li>
<strong>(a)</strong> <span class="math inline">\(\hat{y}_i = y_i\)</span> and <span class="math inline">\(\small SS_{res} = \sum_{i=1}^n(y_i - \hat{y}_i)^2 = 0\)</span>. <strong>(b)</strong> <span class="math inline">\(\hat{y}_i = \overline{y}\)</span> and <span class="math inline">\(\small SS_R = \sum_{i=1}^n(\hat{y}_i - \overline{y})^2 = 0\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-r-squared" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="./images/img-model/r_square.png" class="img-fluid figure-img" style="width:60.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;23.20: Examples of <span class="math inline">\(R^2\)</span> being equal to 1 and 0</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="prediction" class="level2" data-number="23.6"><h2 data-number="23.6" class="anchored" data-anchor-id="prediction">
<span class="header-section-number">23.6</span> Prediction</h2>
<p><span style="color:blue"> <strong>Predicting the Mean Response</strong> </span></p>
<ul>
<li>With the predictor value <span class="math inline">\(x = x_0\)</span>, we want to estimate the mean response <span class="math inline">\(E(y\mid x_0) = \mu_{y|x_0} = \beta_0 + \beta_1 x_0\)</span>.
<ul>
<li><span style="color:blue"> Example: The <strong>mean</strong> highway MPG <span class="math inline">\(E(y \mid x_0)\)</span> when displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
<li>If <span class="math inline">\(x_0\)</span> is <em>within the range of <span class="math inline">\(x\)</span></em>, an <em>unbiased</em> point estimator for <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math display">\[\widehat{E(y\mid x_0)} = \hat{\mu}_{y | x_0} = b_0 + b_1 x_0\]</span>
</li>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> CI for <span class="math inline">\(E(y\mid x_0)\)</span> is <span class="math inline">\(\boxed{\hat{\mu}_{y | x_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{\frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}}\)</span>.</li>
</ul>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Does the length of the CI for <span class="math inline">\(E(y\mid x_0)\)</span> stay the same at any location of <span class="math inline">\(x_0\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Predicting New Observations</strong> </span></p>
<ul>
<li>Predict the value of a <em>new observation, <span class="math inline">\(y_0\)</span>,</em> with <span class="math inline">\(x = x_0\)</span>.
<ul>
<li><span style="color:blue"> Example: The <strong>highway MPG of a car</strong> <span class="math inline">\(y_0(x_0)\)</span> when its displacement is <span class="math inline">\(x = x_0 = 5.5\)</span>. </span></li>
</ul>
</li>
<li>An <em>unbiased</em> point estimator for <span class="math inline">\(y_0(x_0)\)</span> is <span class="math display">\[\hat{y}_0(x_0) = b_0 + b_1 x_0\]</span>
</li>
<li>The <span class="math inline">\((1-\alpha)100\%\)</span> <strong>prediction interval</strong> (PI) for <span class="math inline">\(y_0(x_0)\)</span> is <span class="math inline">\(\small \boxed{\hat{y_0} \pm t_{\alpha/2, n-2} \hat{\sigma}\sqrt{1+ \frac{1}{n} + \frac{(x_0 - \overline{x})^2}{S_{xx}}}}\)</span>
</li>
</ul>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
What is the difference between CI for <span class="math inline">\(E(y\mid x_0)\)</span> and PI for <span class="math inline">\(y_0(x_0)\)</span>?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<ul>
<li>
<em>The PI is wider as it includes the uncertainty about <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span> as well as <span class="math inline">\(y_0\)</span> due to error, <span class="math inline">\(\epsilon\)</span></em>.</li>
</ul></section><section id="r-lab" class="level2" data-number="23.7"><h2 data-number="23.7" class="anchored" data-anchor-id="r-lab">
<span class="header-section-number">23.7</span> R Lab</h2>
<p><span style="color:blue"> <strong><code>mpg</code> Data</strong> </span></p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>  <span class="co">## use data mpg in ggplot2 package</span></span>
<span><span class="va">mpg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
# ℹ 224 more rows</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Highway MPG <code>hwy</code> vs.&nbsp;Displacement <code>displ</code></strong> </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>,</span>
<span>     las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Fit Simple Linear Regression</strong> </span></p>
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">hwy</span> <span class="op">~</span> <span class="va">displ</span>, </span>
<span>              data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
     35.698       -3.531  </code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## all elements in reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## use $ to extract an element of a list</span></span>
<span><span class="va">reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)       displ 
  35.697651   -3.530589 </code></pre>
</div>
</div>
</div>
</div>
<ul>
<li><span class="math inline">\(\widehat{hwy}_{i} = b_0 + b_1 \times displ_{i} = 35.7 - 3.5 \times displ_{i}\)</span></li>
<li>
<span class="math inline">\(b_1\)</span>: For a one unit (liter) increase of the displacement, we expect the highway MPG to be decreased, on average, by 3.5.</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Fitted Values of <span class="math inline">\(y\)</span></strong> </span></p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 observed response value y</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29 29 31 30 26</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 fitted value y_hat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span>, <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5 
29.34259 29.34259 28.63647 28.63647 25.81200 </code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## the first 5 predictor value x</span></span>
<span><span class="va">mpg</span><span class="op">$</span><span class="va">displ</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.8 1.8 2.0 2.0 2.8</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 234</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Add a Regression Line</strong> </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">displ</span>, y <span class="op">=</span> <span class="va">mpg</span><span class="op">$</span><span class="va">hwy</span>, las <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"navy"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Displacement (litres)"</span>, ylab <span class="op">=</span> <span class="st">"Highway MPG"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Highway MPG vs. Engine Displacement (litres)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">reg_fit</span>, col <span class="op">=</span> <span class="st">"#FFCC00"</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Standard Error of Regression</strong> </span></p>
<div class="cell" data-highlight.output="16">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">summ_reg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1039 -2.1646 -0.2242  2.0589 15.0105 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  35.6977     0.7204   49.55   &lt;2e-16 ***
displ        -3.5306     0.1945  -18.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.836 on 232 degrees of freedom
Multiple R-squared:  0.5868,    Adjusted R-squared:  0.585 
F-statistic: 329.5 on 1 and 232 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># lots of fitted information saved in summary(reg_fit)!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">summ_reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled" </code></pre>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># residual standard error (sigma_hat)</span></span>
<span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.835985</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># from reg_fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">$</span><span class="va">residuals</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">reg_fit</span><span class="op">$</span><span class="va">df.residual</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.835985</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Confidence Intervals and Testing for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></strong> </span></p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">reg_fit</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 34.278353 37.11695
displ       -3.913828 -3.14735</code></pre>
</div>
</div>
<div class="cell" data-highlight.output="[9,10,11,12]" data-output.lines="15">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1039 -2.1646 -0.2242  2.0589 15.0105 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  35.6977     0.7204   49.55   &lt;2e-16 ***
displ        -3.5306     0.1945  -18.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.836 on 232 degrees of freedom
Multiple R-squared:  0.5868,    Adjusted R-squared:  0.585 
F-statistic: 329.5 on 1 and 232 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value      Pr(&gt;|t|)
(Intercept) 35.697651  0.7203676  49.55477 2.123519e-125
displ       -3.530589  0.1945137 -18.15085  2.038974e-46</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>ANOVA Table</strong> </span></p>
<ul>
<li>For <span class="math inline">\(H_0: \beta_1 = 0\)</span> in SLR, <span class="math inline">\(t_{test}^2 = F_{test}\)</span>.</li>
</ul>
<div class="cell" data-highlight.output="[4,5,6]">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">reg_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: hwy
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
displ       1 4847.8  4847.8  329.45 &lt; 2.2e-16 ***
Residuals 232 3413.8    14.7                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value      Pr(&gt;|t|)
(Intercept) 35.697651  0.7203676  49.55477 2.123519e-125
displ       -3.530589  0.1945137 -18.15085  2.038974e-46</code></pre>
</div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 329.4533</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong><span class="math inline">\(R^2\)</span></strong> </span></p>
<div class="cell" data-highlight.output="17" data-hash="model-reg_cache/html/unnamed-chunk-37_f16970b7b668645486a12e6dce44967c">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hwy ~ displ, data = mpg)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.1039 -2.1646 -0.2242  2.0589 15.0105 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  35.6977     0.7204   49.55   &lt;2e-16 ***
displ        -3.5306     0.1945  -18.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.836 on 232 degrees of freedom
Multiple R-squared:  0.5868,    Adjusted R-squared:  0.585 
F-statistic: 329.5 on 1 and 232 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_reg_fit</span><span class="op">$</span><span class="va">r.squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5867867</code></pre>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Prediction</strong> </span></p>
<div class="cell" data-hash="model-reg_cache/html/unnamed-chunk-39_941f3a7dd754a0b43df91c11e5df5113">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## CI for the mean response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"confidence"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 16.27941 15.35839 17.20043</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## PI for the new observation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">reg_fit</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>displ <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>, interval <span class="op">=</span> <span class="st">"predict"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 16.27941 8.665682 23.89314</code></pre>
</div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" data-hash="model-reg_cache/html/unnamed-chunk-41_0b988e9d2959f0286150acdff4cf512f" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="model-reg_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" style="width:88.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="exercises" class="level2" data-number="23.8"><h2 data-number="23.8" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">23.8</span> Exercises</h2>
<p>Use the data in the table below to answer questions 1-7.</p>
<table class="table"><tbody>
<tr class="odd">
<td>Tar</td>
<td>24</td>
<td>28</td>
<td>21</td>
<td>23</td>
<td>20</td>
<td>22</td>
<td>20</td>
<td>25</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Nicotine</td>
<td>1.6</td>
<td>1.7</td>
<td>1.2</td>
<td>1.4</td>
<td>1.1</td>
<td>1.0</td>
<td>1.3</td>
<td>1.2</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol type="1">
<li><p>Construct a scatterplot using tar for the <span class="math inline">\(x\)</span> axis and nicotine for the <span class="math inline">\(y\)</span> axis. Does the scatterplot suggest a linear relationship between the two variables? Are they positively or negatively related?</p></li>
<li><p>Let <span class="math inline">\(y\)</span> be the amount of nicotine and let <span class="math inline">\(x\)</span> be the amount of tar. Fit a simple linear regression to the data and identify the sample regression equation.</p></li>
<li><p>What percentage of the variation in nicotine can be explained by the linear correlation between nicotine and tar?</p></li>
<li><p>The Raleigh brand king size cigarette is not included in the table, and it has 21 mg of tar. What is the best predicted amount of nicotine? How does the predicted amount compare to the actual amount of 1.2 mg of nicotine? What is the value of residual?</p></li>
<li><p>Perform the test <span class="math inline">\(H_0: \beta_1 = 0\)</span> vs.&nbsp;<span class="math inline">\(H_1: \beta_1 \ne 0\)</span>.</p></li>
<li><p>Provide 95% confidence interval for <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>Generate the ANOVA table for the linear regression.</p></li>
</ol>
<p><br></p>
<ol start="8" type="1">
<li>
<strong>Correlation</strong> <em>(30 points)</em>: Match each correlation to the corresponding scatterplot.
<ol type="a">
<li><span class="math inline">\(R = -0.65\)</span></li>
<li><span class="math inline">\(R = 0.47\)</span></li>
<li><span class="math inline">\(R = 0.03\)</span></li>
<li><span class="math inline">\(R = 0.93\)</span></li>
</ol>
</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/correlation.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="9" type="1">
<li>
<strong>Regression</strong> <em>(30 points)</em>: The following regression output is for predicting the heart weight (in g) of cats from their body weight (in kg).
<ol type="a">
<li>Write out the simple linear regression equation.</li>
<li>Which one is the response variable and which one is the predictor (explanatory variable)?</li>
<li>Interpret the slope and intercept.</li>
</ol>
</li>
</ol>
<table class="table"><tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>-0.346</td>
</tr>
<tr class="even">
<td>body wt</td>
<td>3.953</td>
</tr>
</tbody></table>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./model-anova.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./model-logistic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Dr.&nbsp;Cheng-Han Yu</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>