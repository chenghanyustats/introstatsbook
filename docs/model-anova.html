<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An comprehensive introductory statistical data science book.">
<title>Introduction to Statistics - 22&nbsp; Analysis of Variance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./model-reg.html" rel="next">
<link href="./model.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model.html">Statistical Models</a></li><li class="breadcrumb-item"><a href="./model-anova.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Monte Carlo Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Nonparametric Methods</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#anova-rationale" id="toc-anova-rationale" class="nav-link active" data-scroll-target="#anova-rationale"><span class="header-section-number">22.1</span> ANOVA Rationale</a></li>
  <li><a href="#anova-procedures" id="toc-anova-procedures" class="nav-link" data-scroll-target="#anova-procedures"><span class="header-section-number">22.2</span> ANOVA Procedures</a></li>
  <li><a href="#anova-example" id="toc-anova-example" class="nav-link" data-scroll-target="#anova-example"><span class="header-section-number">22.3</span> ANOVA Example</a></li>
  <li><a href="#unequal-variances" id="toc-unequal-variances" class="nav-link" data-scroll-target="#unequal-variances"><span class="header-section-number">22.4</span> Unequal Variances</a></li>
  <li><a href="#anova-mathematical-model" id="toc-anova-mathematical-model" class="nav-link" data-scroll-target="#anova-mathematical-model"><span class="header-section-number">22.5</span> ANOVA Mathematical Model</a></li>
  <li><a href="#pairwise-comparison" id="toc-pairwise-comparison" class="nav-link" data-scroll-target="#pairwise-comparison"><span class="header-section-number">22.6</span> Pairwise Comparison</a></li>
  <li><a href="#two-way-anova" id="toc-two-way-anova" class="nav-link" data-scroll-target="#two-way-anova"><span class="header-section-number">22.7</span> Two-Way ANOVA</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/model-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./model.html">Statistical Models</a></li><li class="breadcrumb-item"><a href="./model-anova.html"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-model-anova" class="quarto-section-identifier"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><span style="color:blue"> <strong>Comparing More Than Two Population Means</strong> </span></p>
<p>We have learned how to compare two population means in <a href="infer-twomean.html" class="quarto-xref"><span>Chapter 16</span></a>. However, in many research settings and questions, we want to compare three or more population means. For example,</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span style="color:blue"> Are there differences in the mean readings of 4 types of devices used to determine the pH of soil samples? </span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/soil.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Source: Unsplash-Markus Spiske.</figcaption></figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><span style="color:blue"> Do different treatments (None, Fertilizer, Irrigation, Fertilizer and Irrigation) affect the mean weights of poplar trees? </span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/poplar.jpeg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Source: Unsplash-Nareeta Martin.</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<!-- ------------------------------------------------------------------------ -->
<p>In both cases, four means are compared. The two-sample <span class="math inline">\(z\)</span> or <span class="math inline">\(t\)</span> test cannot be used anymore. Our solution is the <strong>analysis of variance</strong>, or <strong>ANOVA</strong>.</p>
<section id="anova-rationale" class="level2" data-number="22.1"><h2 data-number="22.1" class="anchored" data-anchor-id="anova-rationale">
<span class="header-section-number">22.1</span> ANOVA Rationale</h2>
<p><span style="color:blue"> <strong>One-Way Analysis of Variance</strong> </span></p>
<p>A <strong>factor</strong> (treatment) is a property or characteristic (categorical variable) that allows us to <em>distinguish the different populations from one another</em>. In fact, when we compare two population means, the two samples are from the populations separated by the categories of a factor. For example, we have gender as a factor that separates the human population into male and female populations, then we compare their mean salary. In our previous examples, <em>type of device</em> and <em>treatment of trees</em> are factors.</p>
<p>One-way ANOVA examines the effect of single <em>categorical variable</em> on the <em>mean of a numerical variable</em>. The ANOVA model is one-way because there is only one factor being considered. If two factors are examined to see how they affect the mean of a numerical variable, the model is called two-way ANOVA. The numerical variable in ANOVA or regression model (<a href="model-reg.html" class="quarto-xref"><span>Chapter 23</span></a>) is called the <strong>response variable</strong> because we want to see how the variable responses to the changes of factors or other variables.</p>
<p>Interestingly, we analyze <span style="color:red"> variances </span> to test the equality of three or more population <span style="color:red"> means</span> 🤔. It sounds counterintuitive, but later you will see why this makes sense.</p>
<p><!-- + The method is **one-way** because we use one single property (categorical variable) for categorizing the populations. --></p>
<p><span style="color:red"> <strong><em>Requirements</em></strong> </span></p>
<p>The one-way ANONA model has the following requirements or assumptions.</p>
<ul>
<li><p><em>Each sub-population formed by the category of the factor is normally distributed.</em> In the two-sample <span class="math inline">\(z\)</span> or <span class="math inline">\(t\)</span> test, we also have such assumption that the two samples are drawn independently from two normally distributed populations or at least both sample sizes are sufficiently large.</p></li>
<li><p><em>The populations have the same variance <span class="math inline">\(\sigma^2\)</span>.</em> ANOVA does not ridiculously assume all the population variances are known. Instead, the model admits the variances are unknown, but assumes they are all equal. Also sounds ridiculous? Anyway, it is what it is, and this is one of the limitations of ANOVA, although equality of variances is a pretty loose requirement. It is also possible to transform our data, so that the transformed samples have similar magnitude of variance. Does this assumption remind you of something? The two-sample pooled <span class="math inline">\(t\)</span>-test has the equality of variance assumption too. In this point of view, one-way ANOVA is a generalization of the two-sample pooled <span class="math inline">\(t\)</span>-test. The next two requirements will be not surprising at all because they are also requirements of the two-sample pooled <span class="math inline">\(t\)</span>-test.</p></li>
<li><p><em>The samples are random samples.</em> Without mentioned explicitly, the inference methods and statistical models introduced in the book are based on random samples.</p></li>
<li><p><em>The samples are independent of each other.</em> They are not matched or paired in any way.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data and Math Notation for ANOVA
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/anova_data.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Source: Table 8.5 of SMD.</figcaption></figure>
</div>
</div>
</div>
<ul>
<li><p><span class="math inline">\(y_{ij}\)</span>: <span class="math inline">\(j\)</span>-th observation from population <span class="math inline">\(i\)</span>. <span class="math inline">\(\color{blue}{(y_{24}:\text{ 4-th observation from population 2})}\)</span></p></li>
<li><p><span class="math inline">\(n_i\)</span>: number of values in the <span class="math inline">\(i\)</span>-th group/sample. (<span class="math inline">\(i = 1, \dots, k = 5\)</span>) <span class="math inline">\(\color{blue}{\small (n_1 = n_2 = \dots = n_5 = 4)}\)</span></p></li>
<li><p><span class="math inline">\(\bar{y}_{i\cdot}\)</span>: the average of values in the <span class="math inline">\(i\)</span>-th sample, <span class="math inline">\(\bar{y}_{i\cdot} = \frac{\sum_{j=1}^{n_i}y_{ij}}{n_i}.\)</span></p></li>
<li><p><span class="math inline">\(N\)</span>: total number of values in all samples combined, <span class="math inline">\(\small N = n_1 + \dots + n_k = \sum_{i=1}^kn_i\)</span>. <span class="math inline">\(\color{blue}{\small (N = 4 + \dots + 4 = 20)}\)</span></p></li>
<li><p><span class="math inline">\(\bar{y}_{\cdot\cdot}\)</span>: the <em>grand</em> sample mean that is the average of all sample values combined, <span class="math inline">\(\bar{y}_{\cdot\cdot} = \frac{\sum_{i=1}^{k}\sum_{j=1}^{n_i}y_{ij}}{N} = \frac{\sum_{i=1}^{k}n_i\bar{y}_{i\cdot}}{n_1 + \dots + n_t}\)</span></p></li>
</ul>
<p>Mathematically, suppose there are <span class="math inline">\(k\)</span> populations/samples, and for group <span class="math inline">\(i =1, \dots, k\)</span>, <span class="math inline">\(n\)</span> observations are drawn. Then</p>
<p><span class="math display">\[y_{ij} \stackrel{iid}{\sim} N(\mu_i, \sigma^2), ~~ j = 1, 2, \dots, n.\]</span></p>
<p>Our goal is to test whether or not <span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_k.\)</span> If we do not reject <span class="math inline">\(H_0: \mu_1 = \mu_2 = \cdots = \mu_k,\)</span> then all samples are viewed as samples from a common normal distribution, i.e., <span class="math inline">\(N(\mu_i, \sigma^2)\)</span> and <span class="math inline">\(\mu = \mu_1 = \mu_2 = \cdots = \mu_k\)</span>.</p>
<p><span class="math display">\[y_{ij} \stackrel{iid}{\sim} N(\mu, \sigma^2), ~~ j = 1, 2, \dots, n.\]</span></p>
</div>
</div>
<p><span style="color:red"> <strong><em>Rationale</em></strong> </span></p>
<p>The section is quite important because we discuss in detail why we use variance size to test whether or not population means are equal.</p>
<p>Suppose we have two data sets Data 1 and Data 2, and both have three groups to be compared. Interestingly, Data 1 and Data 2 have the same group sample means <span class="math inline">\(\bar{y}_1\)</span>, <span class="math inline">\(\bar{y}_2\)</span> and <span class="math inline">\(\bar{y}_3\)</span> denoted as red dots in <a href="#fig-boxplots-var" class="quarto-xref">Figure&nbsp;<span>22.1</span></a>. However, they differ with regards to the variance within each group. Data 1 has small variance within samples, while Data 2 has large variance within samples. Within groups, the data points in Data 1 are quite tight and close each other, and therefore they are all close to their sample mean. On the contrary, the data points in Data 2 are quite distant each other, even they are in the same group. Such distribution pattern tells us that the populations from which the samples of Data 1 are drawn have small variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Before we go into more details, let’s see if you have a great intuition.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For which data do you feel more confident in saying the population means <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\mu_3\)</span> are not all the same?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplots-var" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplots-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-boxplots-var-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.1: Boxplots illustrating the variance within samples.
</figcaption></figure>
</div>
</div>
</div>
<!-- :::{.callout-note icon=false} -->
<!-- ## For which data do you feel more confident in saying the population means $\mu_1$, $\mu_2$ and $\mu_3$ are not all the same? -->
<!-- ::: -->
<p>If your answer is Data 1, congratulations you are correct!</p>
<p>The difference in sample means in Data 1 is more likely due to the true difference in population means (<span class="math inline">\(\mu_1, \mu_2, \mu_3\)</span> not all the same). Because of the small variation within groups, in Data 1 a value drawn from group 1 is very unlikely to be drawn from another group because with the normality assumption, the chance to be drawn from another group is very tiny. <a href="#fig-normal-var" class="quarto-xref">Figure&nbsp;<span>22.2</span></a> clearly illustrates this idea. The samples of Data 1 are so well-separated that we are more confident to say they are drawn from three well-separated populations that are not overlapped each other, and have distinct population means <span class="math inline">\(\mu_1, \mu_2\)</span>, and <span class="math inline">\(\mu_3\)</span>.</p>
<p>If the variance within groups is large, as shown at the bottom of <a href="#fig-normal-var" class="quarto-xref">Figure&nbsp;<span>22.2</span></a>, all three samples are mixed up together, as if they are all from the common population, even though they are in fact are from three distinct populations <span class="math inline">\(N(\mu_1, \sigma^2), N(\mu_2, \sigma^2), N(\mu_3, \sigma^2)\)</span> and <span class="math inline">\(\mu_1 \ne \mu_2 \ne \mu_3\)</span>. Note that the three populations still have their own distinct population mean which is actually identical to the mean with small variance, but it is hard for us to learn this fact from their mixed random samples. Because the three samples are indistinguishable, we don’t have strong evidence to conclude that their corresponding population has its own population mean, and tend to conclude that the three samples are from a common population <span class="math inline">\(N(\mu, \sigma^2)\)</span>.</p>
<!-- Therefore, the blue points can only be the draws from blue normal distribution,  -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-var" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-normal-var-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.2: Populations with small and large variance within samples.
</figcaption></figure>
</div>
</div>
</div>
<p>The three samples in <a href="#fig-normal-one" class="quarto-xref">Figure&nbsp;<span>22.3</span></a> are from a common population <span class="math inline">\(N(\mu, \sigma^2)\)</span>. The samples look pretty similar to the samples with large variance in <a href="#fig-normal-var" class="quarto-xref">Figure&nbsp;<span>22.2</span></a>. In other words, either one common population or three populations with large variance can produce quite similar samples. With the samples only, we cannot tell which data generating mechanism is the true one generating such data.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-one" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-normal-one-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-one-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.3: Three samples drawn from a common normal population.
</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always keep in mind that all we have are samples, and we never know the true means <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span>, and <span class="math inline">\(\mu_3\)</span>. In the figures, we assume we know the true populations, and see what the samples look like. Statistical inference is trickier. We want to have a decision rule, so that we know how much the samples are well separated is enough to say they are from three different populations.</p>
</div>
</div>
<!-- variation between samples is measured by the pairwise distance among the sample means. -->
<!-- variation within samples is measured by the how far away the data points away from each other in each sample group. -->
<hr>
<p><span style="color:blue"> <strong>Variation Between Samples &amp; Variation Within Samples</strong> </span></p>
<p>There are two types of variation we need to consider in order to determine whether population means are identical. They are <strong>variation between samples</strong> and <strong>variation within samples</strong>.</p>
<p>We have discussed the variation within samples or variance within groups, which measures the variability of data points in each group. This is actually the sample point estimate of the population variance <span class="math inline">\(\sigma^2\)</span> because the data points in the <span class="math inline">\(i\)</span>-th group are assumed from the <span class="math inline">\(i\)</span>-th population <span class="math inline">\(N(\mu_i, \sigma^2).\)</span> There are <span class="math inline">\(k\)</span> sample variance, one for each group. Later, we will learn how to combine them to get one single variance within samples as an estimate of <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Variation between samples, on the other hand, measures variability of sample means. <em>The farther away from each other the sample means are, the larger variation between samples</em>. In our Data 1 and Data 2 example, their variation between samples are very close because the relative location of their sample means are basically the same. <a href="#fig-boxplot-bw" class="quarto-xref">Figure&nbsp;<span>22.4</span></a> illustrating the variance between samples. Data 3 and 4 have the same variance within samples, but Data 3 have small variation between samples and Data 4 have large variation between samples. Clearly, the sample means in Data 4 are farther away from each other, comparing to Data 3.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-bw" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplot-bw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-boxplot-bw-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-bw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.4: Boxplots illustrating the variance between samples.
</figcaption></figure>
</div>
</div>
</div>
<p>Let me ask you the same question for Data 3 and 4.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For which data do you feel more confident in saying the population means <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\mu_3\)</span> are not all the same?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>Your answer should be Data 4. When the sample means <span class="math inline">\(\bar{y}_1\)</span>, <span class="math inline">\(\bar{y}_2\)</span> and <span class="math inline">\(\bar{y}_3\)</span> are far away from each other, and they serve as the unbiased point estimate of <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\mu_3\)</span>, respectively, we tend to claim that <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\mu_3\)</span> are not identical.</p>
<p>We have an important finding. <em>Whether or not there is a difference in population means depends on the relative size of variation between samples and variation within samples</em>. When variability between samples is <em>large</em> <em>in comparison to</em> the variation within samples, like Data 1 and Data 4, we tend to conclude that the population means are not all the same. When variation between samples is <em>small</em> relatively to the variation within samples, like Data 2 and Data 3, it’s hard to exclude the possibility that all samples comes from the same population.</p>
<!-- - Data 1: Variability between samples is *large* *in comparison to* the variation within samples. -->
<!-- - Data 2: Variation between samples is *small* relatively to the variation within samples. -->
<!-- - Data 3: Variability between samples is *small* *in comparison to* the variation within samples. -->
<!-- - Data 4: Variation between samples is *large* relatively to the variation within samples. -->
<!-- :::{.callout-note icon=false} -->
<!-- ## We are more confident concluding there is a difference in population means when variation **between** samples is *larger* than variation **within** samples. -->
<!-- ::: -->
<!-- # ```{r, out.width="55%", echo=FALSE, fig.align='center'} -->
<!-- # #| label: fig-var-within -->
<!-- # #| fig-cap: Illustration of small and large variance within samples -->
<!-- # knitr::include_graphics("./images/img-model/figure8-1.png") -->
<!-- # ``` -->
</section><section id="anova-procedures" class="level2" data-number="22.2"><h2 data-number="22.2" class="anchored" data-anchor-id="anova-procedures">
<span class="header-section-number">22.2</span> ANOVA Procedures</h2>
<p>ANOVA is usually done by providing the ANOVA table below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/anova_table_k.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="818"></p>
</figure>
</div>
</div>
</div>
<p>In this section, we are going to learn the meaning of every cell in the table, and how to use the table to do the testing of equality of population means.</p>
<!-- We now introduce the ANOVA procedures for testing the equality of population means. -->
<p>The hypotheses is <span style="color:blue"> <span class="math display">\[\begin{align} &amp;H_0: \mu_1 = \mu_2 = \cdots = \mu_k\\  &amp;H_1: \text{Population means are not all equal} \end{align}\]</span> </span></p>
<p>Note that the alternative hypothesis is not <span class="math inline">\(H_1: \mu_1 \ne \mu_2 \ne \cdots \ne \mu_k\)</span>. This is just one scenario where <span class="math inline">\(H_0\)</span> is not satisfied. Any <span class="math inline">\(\mu_i \ne \mu_j , i \ne j\)</span> violates <span class="math inline">\(H_0\)</span>, and should be a possibility of <span class="math inline">\(H_1\)</span>.</p>
<!-- - We use $F$-test.  -->
<p>We learned that whether or not there is a difference in population means depends on the relative size of variation between samples and variation within samples. Statistician Ronald Fisher found a way to define a variable which is the ratio of variance between samples to variance within samples, and the variable follows the <span class="math inline">\(F\)</span> distribution: <span class="math display">\[\frac{\text{variance between samples}}{\text{variance within samples}} \sim F_{df_B,\, df_W}\]</span> The degrees of freedom <span class="math inline">\(df_B\)</span> is paired with variance between samples and <span class="math inline">\(df_W\)</span> is for variance within samples. Be careful the order matters.</p>
<p>ANONA uses F test. If the variance <em>between</em> samples is much larger than the variance <em>within</em> samples, then the <span class="math inline">\(F\)</span> test statistic <span class="math inline">\(F_{test}\)</span> will be much greater than 1, which may be over the <span class="math inline">\(F\)</span> critical value, and <span class="math inline">\(H_0\)</span> is rejected.</p>
<p>The key question is how variance between samples and variance within samples are defined so that the ratio is <span class="math inline">\(F\)</span> distributed.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## Key -->
<!-- - Define variance between samples and variance within samples so that the ratio is $F$ distributed. -->
<!-- ::: -->
<!-- ------------------------------------------------------------------ -->
<p><span style="color:blue"> <strong>Variance Within Samples</strong> </span></p>
<p>One-way ANOVA is a generalization of the two-sample pooled <span class="math inline">\(t\)</span>-test. In the two-sample pooled <span class="math inline">\(t\)</span>-test with equal variance <span class="math inline">\(\sigma^2\)</span>, we have the pooled sample variance <span class="math display">\[s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}\]</span></p>
<!-- :::{.callout-note icon=false} -->
<!-- ## How about the pooled sample variance for $k$ samples? -->
<!-- ::: -->
<p>How about the pooled sample variance for <span class="math inline">\(k\)</span> samples? ANOVA assumes the populations have the <strong>same variance</strong> such that <span class="math inline">\(\sigma_1^2 = \sigma_2^2 = \cdots = \sigma_k^2 = \sigma^2\)</span>. With the same logic, we can have the pooled sample variance from <span class="math inline">\(k\)</span> samples <span class="math display">\[\boxed{s_W^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2 + \cdots + (n_k-1)s_k^2}{n_1 + n_2 + \cdots + n_k - k}}\]</span> where <span class="math inline">\(s_i^2\)</span>, <span class="math inline">\(i = 1, \dots ,k\)</span>, is the sample variance of <span class="math inline">\(i\)</span>-th group. <span class="math inline">\(s_W^2\)</span> represents a <em>combined</em> estimate of the common variance <span class="math inline">\(\sigma^2\)</span>. It measures variability of the observations within the <span class="math inline">\(k\)</span> populations. Note that each <span class="math inline">\(s_i^2\)</span> measures the variability within the <span class="math inline">\(i\)</span>-th sample. So this pooled estimate is the variance within samples.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/var_within_group.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<!-- ----------------------------------------------------------------- -->
<p><span style="color:blue"> <strong>Variance Between Samples</strong> </span></p>
<p>The variance between samples measures variability <em>among</em> sample means for the <span class="math inline">\(k\)</span> groups, which is defined as <span class="math display">\[\boxed{s^2_{B} = \frac{\sum_{i=1}^k n_i (\bar{y}_{i\cdot} - \bar{y}_{\cdot\cdot})^2}{k-1}}\]</span> where</p>
<ul>
<li>
<span class="math inline">\(\bar{y}_{i\cdot}\)</span> is the <span class="math inline">\(i\)</span>-th sample mean.</li>
<li>
<span class="math inline">\(\bar{y}_{\cdot\cdot}\)</span> is the <em>grand</em> sample mean with all data points in all groups combined.</li>
<li>
<span class="math inline">\(n_i\)</span> is the sample size of the <span class="math inline">\(i\)</span>-th sample.</li>
</ul>
<p>The variance between samples measures the magnitude of how large is the deviation from group means to the overall grand mean. When <span class="math inline">\(\bar{y}_{i\cdot}\)</span>s are away from each other, <span class="math inline">\((\bar{y}_{i\cdot} - \bar{y}_{\cdot\cdot})^2\)</span> will be large, so is <span class="math inline">\(s^2_{B}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/var_between_group.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="737"></p>
</figure>
</div>
</div>
</div>
<p>In fact, not only <span class="math inline">\(s^2_{W}\)</span> estimates <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(s^2_{B}\)</span> is also an estimate of <span class="math inline">\(\sigma^2\)</span>. If <span class="math inline">\(H_0\)</span> is true <span class="math inline">\((\mu_1 = \cdots = \mu_k = \mu)\)</span>, any variation in the sample means is due to chance and randomness, so it shouldn’t be too large. <span class="math inline">\(\bar{y}_{1\cdot}, \cdots, \bar{y}_{k\cdot}\)</span> should be close each other and should be close to <span class="math inline">\(\bar{y}_{\cdot \cdot}\)</span>. This leads to a small <span class="math inline">\(s^2_{B}\)</span> and small ratio <span class="math inline">\(s^2_{B}/s^2_{W}\)</span> that is our <span class="math inline">\(F\)</span> test statistic. That’s why when <span class="math inline">\(\mu_1 = \cdots = \mu_k = \mu\)</span>, we have small <span class="math inline">\(F\)</span> test statistic and tend to not reject <span class="math inline">\(H_0\)</span>.</p>
<!-- ----------------------------------------------------------------- -->
<p><span style="color:blue"> <strong>ANOVA Table: Sum of Squares</strong> </span></p>
<p>In the ANOVA table, there is a column Sum of Squares. There are three types of sum of squares. Let’s learn what they are.</p>
<p><strong>Total Sum of Squares (SST)</strong> measures the total variation around <span class="math inline">\(\bar{y}_{\cdot\cdot}\)</span> in all of the sample data combined (ignoring the groups), which is defined as: <span class="math display">\[\color{blue}{SST = \sum_{j=1}^{n_i}\sum_{i=1}^{k} \left(y_{ij} - \bar{y}_{\cdot\cdot}\right)^2}\]</span> where <span class="math inline">\(y_{ij}\)</span> is the <span class="math inline">\(j\)</span>-th data point in the <span class="math inline">\(i\)</span>-th group.</p>
<p><strong>Sum of Squares Between Samples (SSB)</strong> measures the variation <em>between</em> sample means: <span class="math display">\[\color{blue}{SSB = \sum_{i=1}^{k}n_i \left(\bar{y}_{i\cdot} - \bar{y}_{\cdot\cdot}\right)^2}\]</span></p>
<p><strong>Sum of Squares Within Samples (SSW)</strong> measures the variation of any value, <span class="math inline">\(y_{ij}\)</span>, about its sample mean, <span class="math inline">\(\bar{y}_{i\cdot}\)</span>: <span class="math display">\[\color{blue}{SSW = \sum_{i=1}^{k} \sum_{j=1}^{n_i} \left(y_{ij} - \bar{y}_{i\cdot}\right)^2 = \sum_{i=1}^{k} (n_i - 1)s_i^2}\]</span></p>
<p><span style="color:red"> <strong><em>Sum of Squares Identity</em></strong> </span></p>
<p>The three sum of squares are related by the identity <span class="math display">\[SST = SSB + SSW.\]</span></p>
<p>Intuitively, for data points <span class="math inline">\(y_{ij}\)</span>, their squared distance from the grand sample mean <span class="math inline">\(\bar{y}_{\cdot\cdot}\)</span> can be decomposed into two parts: (1) the squared distance between their own group sample mean and the grand sample mean, and (2) the their squared distance from their own group sample mean.</p>
<p>Note that the sum of squares statistics have associated degrees of freedom. More interestingly, the three degrees of freedom also form an identity. So</p>
<p><span class="math display">\[df_{T} = df_{B} + df_{W}\]</span> where</p>
<ul>
<li>
<span class="math inline">\(df_{T} = N-1\)</span> is the degrees of freedom of <span class="math inline">\(SST\)</span>
</li>
<li>
<span class="math inline">\(df_{B} = k - 1\)</span> is the degrees of freedom of <span class="math inline">\(SSB\)</span>
</li>
<li>
<span class="math inline">\(df_{W} = N - k\)</span> is the degrees of freedom of <span class="math inline">\(SSW\)</span>.</li>
</ul>
<p>When a sum of squares divided by its degrees of freedom, we get its <strong>mean square (MS)</strong>, i.e., <span class="math display">\[\text{mean square} = \dfrac{\text{sum of squares}}{\text{degrees of freedom}}.\]</span> We are particularly interested in the <strong>mean square between</strong> (<strong>MSB</strong>) and <strong>mean square within</strong> (<strong>MSW</strong>):</p>
<ul>
<li><span class="math inline">\(MSB = \frac{SSB}{k-1} = s^2_{B}\)</span></li>
<li><span class="math inline">\(MSW = \frac{SSW}{N-k} = s^2_{W}\)</span></li>
</ul>
<!-- $\begin{align} &df_{T} = df_{B} + df_{W} \\&n - 1 = (k-1) + (n - k) \end{align}$ --><!-- - $\text{Mean Square (MS)} = \frac{\text{sum of squares}}{\text{degrees of freedom}}$ --><!-- - $MSB = \frac{SSB}{k-1} = s^2_{B}$ --><!-- - $MSW = \frac{SSW}{N-k} = s^2_{W}$ --><p>Please check the formula of <span class="math inline">\(SSB\)</span> and <span class="math inline">\(SSW\)</span>. You will find that <span class="math inline">\(MSB\)</span> is our variance between samples and <span class="math inline">\(MSW\)</span> is our variance within samples! So our <span class="math inline">\(F\)</span> test statistic is <span class="math display">\[F_{test} = \frac{MSB}{MSW}.\]</span></p>
<p>Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(s^2_{B}/s_W^2\)</span> is a statistic from <span class="math inline">\(F_{k-1, \, N-k}\)</span> distribution. The first degrees of freedom is <span class="math inline">\(df_{B} = k - 1\)</span>, and the second is <span class="math inline">\(df_{W} = N - k\)</span>. They cannot be switched.</p>
<p>We reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(F_{test} &gt; F_{\alpha, \, k - 1,\, N-k}\)</span>, or <span class="math inline">\(p\)</span>-value <span class="math inline">\(P(F_{k - 1,\, N-k} &gt; F_{test}) &lt; \alpha\)</span> for some significance level <span class="math inline">\(\alpha\)</span>.</p>
<p><span style="color:red"> <strong><em>ANOVA Table</em></strong> </span></p>
<p>We are done! We’ve talked about every cell in the ANOVA table, and we can use the table to do the test and make a conclusion about the equality of population means.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/anova_table_k.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="818"></p>
</figure>
</div>
</div>
</div>
</section><section id="anova-example" class="level2" data-number="22.3"><h2 data-number="22.3" class="anchored" data-anchor-id="anova-example">
<span class="header-section-number">22.3</span> ANOVA Example</h2>
<p>We hypothesize that a nutrient called “isoflavones” varies among three types of food: (1) cereals and snacks, (2) energy bars and (3) veggie burgers.</p>
<div class="columns">
<div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/cereal.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/energy_bar.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/veggie_burger.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>A sample of 5 is taken from each type of food and the amount of isoflavones is measured. Is there a sufficient evidence to conclude that the mean isoflavone levels vary among these food items at <span class="math inline">\(\alpha = 0.05\)</span>?</p>
<hr>
<p>We are going to learn to generate a ANOVA table using R.</p>
<p><span style="color:blue"> <strong>Data</strong> </span></p>
<p>In order to use the R built-in function for ANOVA, we get to make sure the data matrix is in the right format. The original data set we get may be something like object <code>data</code> below, where each column represents the five isoflavones measurements of a food type. It is not a <em>“wrong”</em> data format, but just not what we need for doing ANOVA. The data frame <code>data_anova</code> is the data format needed for ANOVA. There are two columns, our response variable isoflavones measurement labelled <code>y</code>, and the factor or categorical variable that may affect the response value, which is food type labelled <code>food</code>. With this format, there will be totally <span class="math inline">\(N=15\)</span> observations and rows. Please transform any data into this kind of data format before you do ANOVA.</p>
<!-- - We prefer a data format like the one shown on the right. -->
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1  2  3
1  3 19 25
2 17 10 15
3 12  9 12
4 10  7  9
5  4  5  8</code></pre>
</div>
</div>
<!-- :::{.callout-note icon=false} -->
<!-- ## So tell me what is the value of $y_{23}$! -->
<!-- ::: -->
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_anova</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    y    food
1   3 cereals
2  17 cereals
3  12 cereals
4  10 cereals
5   4 cereals
6  19  energy
7  10  energy
8   9  energy
9   7  energy
10  5  energy
11 25  veggie
12 15  veggie
13 12  veggie
14  9  veggie
15  8  veggie</code></pre>
</div>
</div>
</div>
</div>
<p>The boxplot kind of gives us the isoflavones distribution by food type. It is hard to say whether the food type affects isoflavone level or not, and we need ANOVA to help us make the conclusion.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-isoflavone" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-boxplot-isoflavone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-boxplot-isoflavone-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-isoflavone-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.5: Boxplot of the Isoflavone Content in 3 Types of Food
</figcaption></figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Test Assumptions</strong> </span></p>
<p>Before implementing any statistical method, always check its method assumptions.</p>
<p>ANOVA requires</p>
<ul>
<li><span class="math inline">\(\sigma_1 = \sigma_2 = \sigma_3\)</span></li>
<li>Data are generated from a normal distribution for each type of food.</li>
</ul>
<p>Well we did not learn to test the equality of more than two population variances, but believe me I did the test, and the three variances are not significantly different from each other. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Even the the variances are not all equal, the ANOVA performance will not be worse much. Equality of variances is not a strict requirement. George Box of UW-Madison showed that as long as the sample sizes are (nearly) equal, the largest variance can be up to 9 times the smallest one and the result of ANOVA will continue to be reliable. A general rule of thumb for equal variances is to compare the smallest and largest sample standard deviations. This is much like the rule of thumb for equal variances for the test for independent means. If the ratio of these two sample standard deviations falls within 0.5 to 2, then it may be that the assumption is not violated.</p>
<p>To check the normality, we can check their QQ plots. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <a href="#fig-qqplots" class="quarto-xref">Figure&nbsp;<span>22.6</span></a> shows that there is no obvious non-normal pattern although two data points are outside the blue 95% confidence region. The normality is not very restrictive as well. As long as the distribution is not very skewed, ANOVA works pretty well.</p>
<p>We say the ANOVA <span class="math inline">\(F\)</span> test is <strong>robust</strong> to the violation of the two assumptions.</p>
<!-- https://cran.r-project.org/web/packages/onewaytests/index.html -->
<!-- Shapiro-Wilk’s method is widely recommended for normality test and it provides better power than K-S. It is based on the correlation between the data and the corresponding normal scores. -->
<!-- Empirical testing has found[5] that the Anderson–Darling test is not quite as good as the Shapiro–Wilk test, but is better than other tests -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-qqplots" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-qqplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="model-anova_files/figure-html/fig-qqplots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qqplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22.6: QQ plots for each type of food
</figcaption></figure>
</div>
</div>
</div>
<p><span style="color:blue"> <strong>ANOVA Testing</strong> </span></p>
<p>We are interested in the following test:</p>
<p><span style="color:blue"> <span class="math inline">\(\begin{align}&amp;H_0: \mu_1 = \mu_2 = \mu_3\\&amp;H_1: \mu_is \text{ not all equal} \end{align}\)</span> </span></p>
<p>where <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span>, <span class="math inline">\(\mu_3\)</span> stand for the population mean level of isoflavones of food cereals and snacks, energy bars, and veggie burgers respectively.</p>
<p>We could follow the regular six-step testing procedure, but generating the ANOVA table is more straightforward.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-model/anova_table_k.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="818"></p>
</figure>
</div>
</div>
</div>
<p>In R, we can do all the calculations and generate an ANOVA table using just one line of code. We first use the popular function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> to implement ANOVA. The first argument is <code>formula</code> that has the form <code>response ~ factor</code> where <code>response</code> is the numeric response vector, and <code>factor</code> is the categorical factor vector. In our data <code>data_anova</code>, <code>y</code> is our response, and <code>food</code> is our factor. Note that if we just write <code>y</code> and <code>food</code> in the formula, R will render an error because R does not recognize <code>y</code> and <code>food</code> because they are not an R object but a column name of data <code>data_anova</code>. Therefore, we need to tell R where <code>y</code> and <code>food</code> are from by specifying the data set they are referred. If you want to specify the data name, you can get access to the response and factor vector by extracting them using <code>data_anova$y</code> and <code>data_anova$food</code>.</p>
<p>The word <code>lm</code> stands for <strong>linear model</strong>, and ANOVA is a linear model. If you just run <code>lm(formula = data_anova$y ~ data_anova$food)</code>, it will show the linear model output related to ANOVA. We don’t need it at this moment, and we will discuss more about linear model in Regression <a href="model-reg.html" class="quarto-xref"><span>Chapter 23</span></a>.</p>
<p>To obtain the ANOVA table, we apply the function <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> to the <code>lm</code> object. In the output, <code>food</code> is the source of variation between samples. <code>Residuals</code> is for the source of variation within samples. <code>F value</code> is the <span class="math inline">\(F\)</span> test statistic value, not the critical value. <code>Pr(&gt;F)</code> is the <span class="math inline">\(p\)</span>-value. Since <span class="math inline">\(p\)</span>-value &gt; 0.05, we do not reject <span class="math inline">\(H_0\)</span>. The evidence is not sufficient to reject the equality of population means.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">food</span>, data <span class="op">=</span> <span class="va">data_anova</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value Pr(&gt;F)
food       2   60.4  30.200  0.8282 0.4603
Residuals 12  437.6  36.467               </code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">data_anova</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">data_anova</span><span class="op">$</span><span class="va">food</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: data_anova$y
                Df Sum Sq Mean Sq F value Pr(&gt;F)
data_anova$food  2   60.4  30.200  0.8282 0.4603
Residuals       12  437.6  36.467               </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is another way to generate the ANOVA table in R. We use <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> and <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> functions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">food</span>, data <span class="op">=</span> <span class="va">data_anova</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
food         2   60.4   30.20   0.828   0.46
Residuals   12  437.6   36.47               </code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># oneway.test(y ~ food, data = data_anova, var.equal = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section><section id="unequal-variances" class="level2" data-number="22.4"><h2 data-number="22.4" class="anchored" data-anchor-id="unequal-variances">
<span class="header-section-number">22.4</span> Unequal Variances</h2>
<p>To be added.</p>
</section><section id="anova-mathematical-model" class="level2" data-number="22.5"><h2 data-number="22.5" class="anchored" data-anchor-id="anova-mathematical-model">
<span class="header-section-number">22.5</span> ANOVA Mathematical Model</h2>
<p>To be added.</p>
</section><section id="pairwise-comparison" class="level2" data-number="22.6"><h2 data-number="22.6" class="anchored" data-anchor-id="pairwise-comparison">
<span class="header-section-number">22.6</span> Pairwise Comparison</h2>
<p>To be added.</p>
</section><section id="two-way-anova" class="level2" data-number="22.7"><h2 data-number="22.7" class="anchored" data-anchor-id="two-way-anova">
<span class="header-section-number">22.7</span> Two-Way ANOVA</h2>
<p>To be added.</p>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The test I use is Brown-Forsythe test. It can be performed using the function <code>onewaytests::bf.test()</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There are several tests for normality, such as Shapiro–Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html">stats::shapiro.test()</a></code>), Anderson–Darling test (<code><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">nortest::ad.test()</a></code>), and Kolmogorov–Smirnov test (<code><a href="https://rdrr.io/r/stats/ks.test.html">stats::ks.test()</a></code>).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./model.html" class="pagination-link" aria-label="Statistical Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistical Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./model-reg.html" class="pagination-link" aria-label="Linear Regression">
        <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/model-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>