<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.7">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An introductory statistical data science book for STEM students.">
<title>10&nbsp; Discrete Probability Distributions – Introduction to Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./prob-cont.html" rel="next">
<link href="./prob-rv.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-91e0721f6a50cd2c1d42ea2de0943486.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-288caa2835e8f3ae9b218c52903e6099.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d93f0da6b6e6724898f2795888d050da.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-5142df6085ee636785797f8402c7d873.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prob.html">Probability</a></li><li class="breadcrumb-item"><a href="./prob-disc.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introduction-to-Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ready fo<em>R</em> data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-py.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><em>P</em>repare <em>Y</em>ourself for data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability Rules and Bayes Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Random Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-multicomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Multiple Comparison*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-r_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-py_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python Programming</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#probability-mass-function" id="toc-probability-mass-function" class="nav-link active" data-scroll-target="#probability-mass-function"><span class="header-section-number">10.1</span> Probability Mass Function</a></li>
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution"><span class="header-section-number">10.2</span> Binomial Distribution</a></li>
  <li><a href="#poisson-distribution" id="toc-poisson-distribution" class="nav-link" data-scroll-target="#poisson-distribution"><span class="header-section-number">10.3</span> Poisson Distribution</a></li>
  <li><a href="#relationship-between-binomial-and-poisson" id="toc-relationship-between-binomial-and-poisson" class="nav-link" data-scroll-target="#relationship-between-binomial-and-poisson"><span class="header-section-number">10.4</span> Relationship between Binomial and Poisson*</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">10.5</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/prob-disc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prob.html">Probability</a></li><li class="breadcrumb-item"><a href="./prob-disc.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-prob-disc" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>For this and next chapters, we learn about probability distributions. In this chapter, we focus on discrete probability distributions for discrete random variables. We first learn what is a discrete probability distribution, followed by the two popular discrete distributions, binomial and Poisson distributions. We will learn how to use R to calculate probabilities from the distributions.</p>
<section id="probability-mass-function" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="probability-mass-function">
<span class="header-section-number">10.1</span> Probability Mass Function</h2>
<p>A discrete random variable uses a <strong>probability function</strong> or <strong>probability mass function</strong> (<strong>pmf</strong>) to describe its randomness, and the pmf is its associated discrete probability distribution. The probability mass function of a discrete random variable <span class="math inline">\(X\)</span> is a function of <span class="math inline">\(X\)</span>, denoted <span class="math inline">\(P(X = x)\)</span> or <span class="math inline">\(p(x)\)</span> for short, that assigns a probability to <em>every</em> possible number <span class="math inline">\(x\)</span> of <span class="math inline">\(X\)</span>.</p>
<p>The probability distribution for a discrete <span class="math inline">\(X\)</span> <em>displays</em> its probability function. The display can be a <em>table</em>, <em>graph</em> or <em>mathematical formula</em> of <span class="math inline">\(P(X = x)\)</span> as long as every possible value of <span class="math inline">\(X\)</span> has its own corresponding probability. We illustrate the probability function using an example of tossing a coin.</p>
<p><span style="color:blue"> <strong>Example:</strong>🪙🪙 Toss a fair coin twice independently where <span class="math inline">\(X\)</span> is the number of heads. </span></p>
<p>With the example, first the possible values of <span class="math inline">\(X\)</span> by its definition are 0, 1, and 2. Both results can be tails and <span class="math inline">\(X = 0\)</span>. We can have one heads and one tails, or <span class="math inline">\(X=1\)</span>, and we can have two heads showing up <span class="math inline">\(X = 2\)</span>. We cannot have <span class="math inline">\(X=3\)</span> or any number greater than 2 because the coin is tossed twice only. Also, the possible value of <span class="math inline">\(X\)</span> cannot be any non-integer values, like 1.5 or 0.8 because <span class="math inline">\(X\)</span> is the number times, and it is discrete.</p>
<p>To present its probability distribution in a table, for each possible value of <span class="math inline">\(X\)</span>, we get to compute its probability, then list all probabilities as the table below.</p>
<!-- - The probability distribution of $X$ as a table is  -->
<!-- <center> -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small"><tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">P(X = x)</td>
<td style="text-align: left;">0.25</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.25</td>
</tr>
</tbody></table>
</div>
</div>
<!-- </center> -->
<!-- Here,  -->
<!-- :::{.callout-note icon=false} -->
<!-- ## 👉 $\{X = x\}$ corresponds to an event of some experiment. -->
<!-- - What is the event that $\{X = 0\}$ corresponds to? -->
<!-- - How do we determine $P(X = 0)$, $P(X=1)$ and $P(X=2)$ ? -->
<!-- ::: -->
<p>Let me show the calculation of the probabilities.</p>
<ul>
<li><p><span class="math inline">\(P(X = 0) = P(\{\text{tails}, \text{tails}\}) = P(\text{tails})P(\text{tails}) = (0.5)(0.5) = 0.25.\)</span></p></li>
<li><p><span class="math inline">\(\begin{align*} P(X = 1) &amp;= P(\{\text{heads}, \text{tails}\} \cup \{\text{tails}, \text{heads}\})\\ &amp;= P(\{\text{heads}, \text{tails}\}) + P(\{\text{tails}, \text{heads}\}) \\ &amp;= (0.5)(0.5) + (0.5)(0.5) = 0.5. \end{align*}\)</span></p></li>
<li><p><span class="math inline">\(P(X = 2) = P(\{\text{heads}, \text{heads}\}) = P(\text{heads})P(\text{heads}) = (0.5)(0.5) = 0.25.\)</span></p></li>
</ul>
<p>We can also display the probability distribution using graphs. We put possible values of <span class="math inline">\(X\)</span> in the x-axis, and the y-axis stands for the probability <span class="math inline">\(P(X=x)\)</span>. Then for each <span class="math inline">\(x\)</span>, we draw a vertical bar at <span class="math inline">\(X=x\)</span> from <span class="math inline">\(y = 0\)</span> to <span class="math inline">\(y = P(X=x)\)</span>. <a href="#fig-prob-hist" class="quarto-xref">Figure&nbsp;<span>10.1</span></a> shows the discrete probability distribution of two coin flips as a graph.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-prob-hist" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-prob-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="prob-disc_files/figure-html/fig-prob-hist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prob-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Discrete probability distribution of two coin flips as a graph
</figcaption></figure>
</div>
</div>
</div>
<p>If you love math, you can specify the probability distribution using mathematical formula:</p>
<p><span class="math display">\[
P(X = x)=
\begin{cases}
{2 \choose x}\left( \frac{1}{4}\right), ~~ x = 0, 1, 2,\\
0,  ~~ \text{otherwise},
\end{cases}
\]</span> where <span class="math inline">\({2 \choose x} = \frac{2!}{x!(2-x)!}\)</span>. Keep in mind that where <span class="math inline">\(x\)</span> takes values or the <strong>support</strong> of <span class="math inline">\(x\)</span> should be clearly specified.</p>
<p>Now let’s talk a little bit about the properties of pmf.</p>
<ul>
<li><p><span class="math inline">\(0 \le P(X = x) \le 1\)</span> for every value <span class="math inline">\(x\)</span> of <span class="math inline">\(X\)</span>. Remember that <span class="math inline">\(P(X = x)\)</span> is a probability of some event, for example <span class="math inline">\(P(X = 0) = P(\{\text{tails}, \text{tails}\})\)</span>, and we’ve learned that <span class="math inline">\(0 \le P(A) \le 1\)</span> for any event <span class="math inline">\(A\)</span>. <!-- + <span style="color:blue"> $x = 0, 1, 2$ </span> --></p></li>
<li><p>The probabilities for a discrete <span class="math inline">\(X\)</span> are <strong>additive</strong> because <span class="math inline">\(\{X = a\}\)</span> and <span class="math inline">\(\{X = b\}\)</span> are <em>disjoint</em> for any possible values <span class="math inline">\(a \ne b\)</span>. In our coin tossing example, <span class="math inline">\(\{X = 0\}\)</span> and <span class="math inline">\(\{X = 1\}\)</span> are disjoint because when tossing a fair coin two times independently, we cannot have no heads and one heads results at the same time. Therefore, <span class="math display">\[P(X = 0 \text{ or } 1) = P(\{X = 0\} \cup \{X = 1\}) = P(X = 0) + P(X = 1).\]</span></p></li>
<li><p><span class="math inline">\(\sum_{x}P(X=x) = 1\)</span>, where <span class="math inline">\(x\)</span> assumes <em>all</em> possible values. In our coin tossing example, <span class="math inline">\(P(X = 0) + P(X = 1) + P(X = 2) = 0.25 + 0.5 + 0.25 = 1\)</span>. The reason is that <span class="math inline">\(\{X = 0\}\)</span>, <span class="math inline">\(\{X = 1\}\)</span>, and <span class="math inline">\(\{X = 2\}\)</span> form a partition of the entire sample space, where in the example <span class="math inline">\(\mathcal{S} = \left\{ \{\text{tails}, \text{tails}\}, \{\text{heads}, \text{tails}\}, \{\text{tails}, \text{heads}\}, \{\text{heads}, \text{heads}\} \right\}\)</span>. Therefore, <span class="math inline">\(\sum_{x}P(X=x) = P(\mathcal{S}) = 1\)</span>.</p></li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Mean</strong> </span></p>
<p>Remember that a probability distribution describes the randomness pattern of a random variable <span class="math inline">\(X\)</span>. Given its distribution, people are usually interested in its average value or central tendency and how uncertain it is or its dispersion.</p>
<p>For the central tendency, we consider the <strong>mean</strong> of a discrete variable <span class="math inline">\(X\)</span>. Suppose <span class="math inline">\(X\)</span> takes values <span class="math inline">\(x_1, \dots, x_k\)</span> with probabilities <span class="math inline">\(P(X = x_1), \dots, P(X = x_k)\)</span>. The <strong>mean</strong> or <strong>expected value</strong> of <span class="math inline">\(X\)</span>, written as <span class="math inline">\(E(X)\)</span>, is the sum of each outcome multiplied by its corresponding probability: <span class="math display">\[E(X) := x_1 \times P(X = x_1) + \dots + x_k \times P(X = x_k) = \sum_{i=1}^kx_iP(X=x_i)\]</span></p>
<p>The Greek letter <span class="math inline">\(\mu\)</span> may also be used in place of the notation <span class="math inline">\(E(X)\)</span>.</p>
<p>The mean of a discrete random variable <span class="math inline">\(X\)</span> is actually a <strong>weighted average</strong> of <span class="math inline">\(x\)</span> <em>weighted by their corresponding probability</em>. <!-- - The possible values, $x$, are *weighted by their corresponding probability*. --></p>
<!-- :::{.callout-note} -->
<!-- - The mean of a discrete random variable $X$ is a **weighted average**. -->
<!-- - The possible values, $x$, are *weighted by their corresponding probability*. -->
<!-- ::: -->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the mean of <span class="math inline">\(X\)</span> (the number of heads) in the coin example?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>If you calculate it correctly, your answer should be one. It tells us that if we toss a fair coin twice independently, on average we’ll see one heads showing up.</p>
<hr>
<p><span style="color:blue"> <strong>Variance</strong> </span></p>
<p>As sample variance calculated from the sample data, we calculate the variance of the random variable <span class="math inline">\(X\)</span> to quantify its variability and dispersion. Suppose <span class="math inline">\(X\)</span> takes values <span class="math inline">\(x_1, \dots , x_k\)</span> with probabilities <span class="math inline">\(P(X = x_1), \dots, P(X = x_k)\)</span> and expected value <span class="math inline">\(\mu = E(X)\)</span>. The variance of <span class="math inline">\(X\)</span>, denoted by <span class="math inline">\(Var(X)\)</span> or <span class="math inline">\(\sigma^2\)</span>, is</p>
<p><span class="math display">\[\small \begin{align*} Var(X) &amp;:= (x_1 - \mu)^2 \times P(X = x_1) + \dots + (x_k - \mu)^2 \times P(X = x_k) \\ &amp;= \sum_{i=1}^k(x_i - \mu)^2P(X=x_i) \\ &amp;= E[(X-\mu)^2] \end{align*}.\]</span></p>
<p>The standard deviation of <span class="math inline">\(X\)</span>, <span class="math inline">\(\sigma\)</span>, is the square root of the variance.</p>
<p>Intuitively, the variance of a discrete random variable <span class="math inline">\(X\)</span> is the <em>weighted sum of squared deviation from the mean</em> weighted by probability values. It is the mean squared distance from the mean.</p>
<!-- :::{.callout-note} -->
<!-- - The variance of a discrete random variable $X$ is also weighted. -->
<!-- - It is the sum of squared deviation from the mean weighted by probability values. -->
<!-- ::: -->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What is the variance of <span class="math inline">\(X\)</span> (the number of heads) in the previous example?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The mean (<span class="math inline">\(\mu\)</span>) and variance (<span class="math inline">\(\sigma^2\)</span>) of a random variable or probability distribution are <em>not</em> the same as the sample mean (<span class="math inline">\(\overline{x}\)</span>) and sample variance (<span class="math inline">\(s^2\)</span>) calculated from the sample data. Their main difference will be discussed in the Part Inference.</li>
</ul>
<!-- - Sometimes the sample mean and sample variance are also called empirical mean and empirical variance. -->
</div>
</div>
<p>We have learned the general discrete probability distributions. Next we are going to learn two popular discrete probability distributions, binomial and Poisson distribution.</p>
</section><section id="binomial-distribution" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="binomial-distribution">
<span class="header-section-number">10.2</span> Binomial Distribution</h2>
<p><span style="color:blue"> <strong>Binomial Experiment and Random Variable</strong> </span></p>
<p>Binomial distribution is generated from the so-called binomial experiment that has the following properties:</p>
<ol type="1">
<li><p>👉 The experiment consists of a <strong>fixed</strong> number of <strong>identical</strong> trials, say <span class="math inline">\(n\)</span>. That is, <span class="math inline">\(n\)</span> is pre-specified before the experiment is conducted, and remains unchanged while the experiment is in progress. Also, all the trials or repetitions in the experiment should be performed with exactly the same condition or procedure.</p></li>
<li><p>👉 Each trial results in one of <strong>exactly two</strong> outcomes. In practice, we use <em>success</em> (S) and <em>failure</em> (F) to represent the two outcomes. The word <em>success</em> just means one of the two outcomes and <em>does not necessarily mean something good.</em> 😲 Depending on your research question, you could define <em>Drug abuse</em> as success and <em>No drug abuse</em> as failure.</p></li>
<li><p>👉 Trials are <strong>independent</strong>, meaning that the outcome of one trial does not affect the outcome of any other trial.</p></li>
<li><p>👉 The probability of success, say <span class="math inline">\(\pi\)</span>, is <strong>constant</strong> for all trials.</p></li>
</ol>
<p>If a binomial experiment is conducted, and <span class="math inline">\(X\)</span> is defined as <span style="color:blue"> the number of successes observed in <span class="math inline">\(n\)</span> trials </span>, then <span class="math inline">\(X\)</span> is a binomial random variable.</p>
<!-- :::{.callout-note} -->
<!-- - The word *success* just means one of the two outcomes and *does not necessarily mean something good. * -->
<!-- - 😲 We can define *Drug abuse* as success and *No drug abuse* as failure. -->
<!-- ::: -->
<hr>
<p><span style="color:blue"> <strong>Distribution</strong> </span></p>
<p>The probability function <span class="math inline">\(P(X = x)\)</span> of a binomial variable <span class="math inline">\(X\)</span> can be <em>fully</em> determined by the number of trials <span class="math inline">\(n\)</span> and the probability of success <span class="math inline">\(\pi\)</span>. Once <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span> are fixed and known, we know exactly what the distribution looks like, and we can form a table, graph, and provide a mathematical formula of the binomial probability function. A different <span class="math inline">\((n, \pi)\)</span> pair generates a different binomial probability distribution. The value(s) that determines an entire probability distribution is called the <strong>parameter</strong> of the distribution. Therefore, <span class="math inline">\(X\)</span> is said to <em>follow a binomial distribution with <strong>parameters</strong> <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span></em>, written as <span class="math inline">\(\color{blue}{X \sim binomial(n, \pi)}\)</span>.</p>
<p>The binomial probability function is <span class="math display">\[ \color{blue}{P(X = x \mid n, \pi) = \frac{n!}{x!(n-x)!}\pi^x(1-\pi)^{n-x}, \quad x = 0, 1, 2, \dots, n}\]</span></p>
<p>It is not that important to memorize the formula as nowadays we use computing software to obtain <span class="math inline">\(P(X = x)\)</span> for any <span class="math inline">\(x\)</span>. Notice that the maximal possible number of <span class="math inline">\(x\)</span> is <span class="math inline">\(n\)</span>, the number of trials. We cannot have 5 successes when there are only 4 trials in the experiment. Second, when both <span class="math inline">\(n\)</span> and <span class="math inline">\(pi\)</span> are known and fixed, with a value of <span class="math inline">\(x\)</span>, everything in the formula is known, and the probability can be calculated.</p>
<p>It can be shown that the binomial distribution has mean <span class="math inline">\(\mu = E(X) = n\pi\)</span> and variance <span class="math inline">\(\sigma^2 = Var(X) = n\pi(1-\pi)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb1-0"><a href="#cb1-0" aria-hidden="true" tabindex="-1"></a>viewof params <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">200</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`n`</span>})<span class="op">,</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\p</span><span class="vs">i`</span>})<span class="op">,</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb2-0"><a href="#cb2-0" aria-hidden="true" tabindex="-1"></a>viewof kvantil <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> params[<span class="dv">0</span>]]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"quantile"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb3-0"><a href="#cb3-0" aria-hidden="true" tabindex="-1"></a>viewof approx <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"show normal approximation"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb4-0"><a href="#cb4-0" aria-hidden="true" tabindex="-1"></a>jstat <span class="op">=</span> <span class="pp">require</span>(<span class="st">'jstat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb5-0"><a href="#cb5-0" aria-hidden="true" tabindex="-1"></a>binomcdf <span class="op">=</span> jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">cdf</span>(kvantil<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">,</span> params[<span class="dv">1</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb6-0"><a href="#cb6-0" aria-hidden="true" tabindex="-1"></a>normalapproxpdf <span class="op">=</span> {</span>
<span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> params[<span class="dv">0</span>]<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> normalapproxpdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params[<span class="dv">1</span>])))}))<span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> normalapproxpdf</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb7-0"><a href="#cb7-0" aria-hidden="true" tabindex="-1"></a>normalapproxcdf <span class="op">=</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">cdf</span>(kvantil<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params[<span class="dv">1</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb8-0"><a href="#cb8-0" aria-hidden="true" tabindex="-1"></a>normalapproxcdf_corrected <span class="op">=</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">cdf</span>(kvantil<span class="op">+</span><span class="fl">0.5</span><span class="op">,</span> params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params[<span class="dv">1</span>])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb9-0"><a href="#cb9-0" aria-hidden="true" tabindex="-1"></a>binompdf <span class="op">=</span> {</span>
<span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> params[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> binompdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">,</span> params[<span class="dv">1</span>])<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"exact"</span>}))<span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> normalapproxpdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params[<span class="dv">1</span>])))<span class="op">,</span><span class="dt">type</span><span class="op">:</span> <span class="st">"approx"</span>}))<span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> binompdf<span class="op">.</span><span class="fu">concat</span>(normalapproxpdf)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb10--1"><a href="#cb10--1" aria-hidden="true" tabindex="-1"></a>moments <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb10-0"><a href="#cb10-0" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="vs">ext{If } X </span><span class="sc">\s</span><span class="vs">im </span><span class="sc">\o</span><span class="vs">peratorname{Binom}(</span><span class="sc">${</span>params[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>params[<span class="dv">1</span>]<span class="sc">}</span><span class="vs">) </span><span class="sc">\t</span><span class="vs">ext{ then }</span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="vs">E( X) =n  </span><span class="sc">\p</span><span class="vs">i = </span><span class="sc">${</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>])<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="vs">Var( X) =n  </span><span class="sc">\p</span><span class="vs">i (1-</span><span class="sc">\p</span><span class="vs">i) =</span><span class="sc">${</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params[<span class="dv">1</span>]))<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb11-0"><a href="#cb11-0" aria-hidden="true" tabindex="-1"></a>cdfs <span class="op">=</span> </span>
<span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cdf<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (approx){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  cdf <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\b</span><span class="vs">egin{array}{ll}</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\t</span><span class="vs">ext{Exact binomial:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>binomcdf<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.25em]</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\t</span><span class="vs">ext{Normal approx:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>normalapproxcdf<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.25em]</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\t</span><span class="vs">ext{Normal approx - corr:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil<span class="sc">}</span><span class="vs">)  =</span><span class="sc">${</span>normalapproxcdf_corrected<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[1em]</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\e</span><span class="vs">nd{array}</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span>}</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>   cdf <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\b</span><span class="vs">egin{array}{ll}</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\t</span><span class="vs">ext{Exact:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>binomcdf<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[1em]</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">\e</span><span class="vs">nd{array}</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cdf<span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt_binom <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> { </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> approx</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> params[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"P(X = x)"</span><span class="op">,</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span><span class="fl">1.1</span><span class="op">*</span>jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">pdf</span>(params[<span class="dv">0</span>]<span class="op">*</span>params[<span class="dv">1</span>]<span class="op">,</span> params[<span class="dv">0</span>]<span class="op">,</span>params[<span class="dv">1</span>])]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"#C04000"</span><span class="op">,</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#C04000"</span><span class="op">,</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(binompdf<span class="op">,</span>{<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"exact"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span> <span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.8</span><span class="op">,</span> </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">pdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(binompdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"exact"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> kvantil<span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"darkorange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">pdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(normalapproxpdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> approx<span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">stroke</span> <span class="op">:</span> <span class="st">"steelblue"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})    </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ojs-cell-12" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ojs-cell-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ojs-cell-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Source: <a href="https://observablehq.com/@mattiasvillani/binomial-distribution" class="uri">https://observablehq.com/@mattiasvillani/binomial-distribution</a>
</figcaption></figure>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
If we toss a fair coin two times independently and let <span class="math inline">\(X =\)</span> # of heads, is <span class="math inline">\(X\)</span> a binomial random variable?
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>To answer this question, we need to check if the experiment satisfies the four properties.</p>
<ol type="1">
<li><p>The number of trials is 2, and the two trials, tossing a fair coin are identical (if you are not nitpicking).</p></li>
<li><p>Each trial results in one of exactly two outcomes, heads or tails.</p></li>
<li><p>Trials are independent. Well it’s hard to say, but at least they are nearly independent.</p></li>
<li><p>The probability of heads is 1/2 for all trials because we got a fair coin.</p></li>
</ol>
<p>So, is <span class="math inline">\(X\)</span> a binomial random variable? You tell me.</p>
<p><span style="color:blue"> <strong>Example</strong> </span></p>
<div class="columns">
<div class="column" style="width:85%;">
<p>Assume that 20% of all drivers have a blood alcohol level above the legal limit. For a random sample of 15 vehicles, compute the probability that:</p>
<ol type="1">
<li><p>Exactly 6 of the 15 drivers will <em>exceed</em> the legal limit.</p></li>
<li><p>Of the 15 drivers, 6 or more will <em>exceed</em> the legal limit.</p></li>
</ol>
</div><div class="column" style="width:15%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-prob/alcohol.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Suppose it’s a binomial experiment with <span class="math inline">\(n = 15\)</span> and <span class="math inline">\(\pi = 0.2\)</span>. Let <span class="math inline">\(X\)</span> be the number of drivers exceeding limit. Then <span class="math inline">\(X \sim binomial(15, 0.2)\)</span>. Therefore,</p>
<p><span class="math display">\[ \color{blue}{P(X = x \mid n=15, \pi=0.2) = \frac{15!}{x!(15-x)!}(0.2)^x(1-0.2)^{15-x}, \quad x = 0, 1, 2, \dots, 15.}\]</span></p>
<p>Since we know the value of parameter <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span>, the entire binomial distribution can be described, as shown in <a href="#fig-binomial-plot" class="quarto-xref">Figure&nbsp;<span>10.3</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-binomial-plot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-binomial-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="prob-disc_files/figure-html/fig-binomial-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binomial-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Binomial Distribution Example <span class="math inline">\(X \sim binomial(15, 0.2).\)</span>
</figcaption></figure>
</div>
</div>
</div>
<p>To answer the first question, we just need to calculate <span class="math inline">\(P(X = 6)\)</span> using the formula: <span class="math display">\[\small P(X = 6) = \frac{n!}{x!(n-x)!}\pi^x(1-\pi)^{n-x} = \frac{15!}{6!(15-6)!}(0.2)^6(1-0.2)^{15-6} = 0.043\]</span></p>
<p>The second question asks for <span class="math inline">\(P(X \ge 6)\)</span> because of “<em>6 or more will <em>exceed</em> the legal limit</em>”. One can calculate the probability like <span class="math inline">\(\small P(X \ge 6) = P(X = 6 \cup X = 7 \cup \cdots \cup X = 15) = p(6) + \dots + p(15)\)</span>. It requires 10 probability calculations. One simpler way of obtaining the probability is to consider the complement set of <span class="math inline">\(\{X \ge 6\}\)</span> which is <span class="math inline">\(\{X \le 5\}\)</span>. Then use the property that <span class="math inline">\(P(A) = 1 - P(A^c)\)</span> to get the answer. So we can do the following <span class="math inline">\(P(X \ge 6) = 1 - P(X \le 5) = 1 - (p(0) + p(1) + \dots + p(5)) = 0.0611\)</span>. In this case, we only need to calculate 6 probabilities from the formula.</p>
<p>Well I believe you’ve seen how tedious calculating a binomial probability is! It is so true especially when <span class="math inline">\(n\)</span> is relatively large. No worries. We are living in the 21th century with lots of advancing computing technology. We’ll never do such calculation by hand, and we’ll learn to compute them using R!</p>
<!-- :::{.callout-tip} -->
<!-- Never do this by hand. We can compute them using R! -->
<!-- ::: -->
<!-- ------------------------------------------------------------- -->
<!-- <span style="color:blue"> **Computation in R** -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>In practice, we are not gonna calculate probabilities of binomial or other commonly used probability distributions. Instead, we use computing software. In R we can use <code>dpqr</code> family functions to calculate probabilities or generate values from the distributions. In general, for some distribution, short for <code>dist</code>, R has the following functions</p>
<ul>
<li>
<strong>d</strong><code>dist(x, ...)</code>: calculate density value <span class="math inline">\(f(x)\)</span> or probability value <span class="math inline">\(P(X = x)\)</span>.</li>
<li>
<strong>p</strong><code>dist(q, ...)</code>: calculate <span class="math inline">\(P(X \le q)\)</span>.</li>
<li>
<strong>q</strong><code>dist(p, ...)</code>: obtain quantile of probability <span class="math inline">\(p\)</span>.</li>
<li>
<strong>r</strong><code>dist(n, ...)</code>: generate <span class="math inline">\(n\)</span> random numbers.</li>
</ul>
<p>When we use these functions, the <code>dist</code> is replaced with the shortened name of the distribution we consider. For example, we use <code>dbinom(x, ...)</code> to do the calculation for the binomial distribution.</p>
<p>The function <code>ddist(x, ...)</code> gives us the <strong>probability density</strong> value <span class="math inline">\(f(x)\)</span> if the distribution is continuous, and it is why the function starts with <code>d</code>. The continuous probability distribution will be discussed in <a href="prob-cont.html" class="quarto-xref"><span>Chapter 11</span></a> in detail. If the distribution is discrete, like binomial, it gives us the value <span class="math inline">\(P(X = x)\)</span> where <span class="math inline">\(X\)</span> follows the distribution being considered, and <span class="math inline">\(x\)</span> is the value specified in the first argument of the function.</p>
<p>For the binomial distribution, we use <strong><code>dbinom(x, size, prob)</code></strong> to compute <span class="math inline">\(P(X = x)\)</span>, where <code>size</code> is the number of trials and <code>prob</code> is the probability of success. Besides <span class="math inline">\(x\)</span>, we need to provide the values of <code>size</code> and <code>prob</code> because remember that they are the parameters of the binomial distribution. Without them, we cannot have a specific binomial distribution, and its probability cannot be calculated.</p>
<p>To obtain <span class="math inline">\(P(X = 6)\)</span> where <span class="math inline">\(X \sim binomial(n=15, \pi=0.2)\)</span>, in R, we do</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04299262</code></pre>
</div>
</div>
<p>To answer the second question <span class="math inline">\(P(X \ge 6)\)</span>, we can use the function <strong><code>pbinom(q, size, prob)</code></strong> that calculates <span class="math inline">\(P(X \le q)\)</span> for <span class="math inline">\(X \sim bionomial(n = \texttt{size}, \pi = \texttt{prob})\)</span>. Notice that <span class="math inline">\(P(X &gt;= 6) = 1 - P(X &lt;= 5)\)</span>, so in R, we can do</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06105143</code></pre>
</div>
</div>
<p>By default, the function <code>pbinom(q, size, prob)</code> calculates the probability <span class="math inline">\(P(X \le q)\)</span> which is the left or <strong>lower tail</strong> part of the distribution. The function provides an argument <code>lower.tail</code> that is logical, and is <code>TRUE</code> by default. When we set <code>lower.tail = FALSE</code> in the function, it will instead calculate <span class="math inline">\(P(X &gt; q)\)</span> which is the right or <strong>upper tail</strong> part of the distribution. Since <span class="math inline">\(P(X \ge 6) = P(X &gt; 5)\)</span>, in R we can do</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06105143</code></pre>
</div>
</div>
<p>Notice that we use <code>q = 5</code> instead of <code>q = 6</code> because we want <span class="math inline">\(P(X &gt; 5)\)</span>. Also, <code>lower.tail = FALSE</code> is added into the function, and the probability value is the same as the value before.</p>
<!-- - R Shiny app is at [Binomial Calculator](http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/) -->
<!-- - With `size` being the number of trials and `prob` being the probability of success, -->
<p><!-- + use **`dbinom(x, size, prob)`** to compute $P(X = x)$ --> <!-- + use **`pbinom(q, size, prob)`** to compute $P(X \le q)$ --> <!-- + use **`pbinom(q, size, prob, lower.tail = FALSE)`** to compute $P(X > q)$ --></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="49.5%"} -->
<!-- ```{r binomial_r_1} -->
<!-- ## 1. P(X = 6) -->
<!-- dbinom(x = 6, size = 15, prob = 0.2)  -->
<!-- ## 2. P(X >= 6) = 1 - P(X <= 5) -->
<!-- 1 - pbinom(q = 5, size = 15, prob = 0.2)  -->
<!-- ``` -->
<!-- ::: -->
<!-- :::{.column width="2%"} -->
<!-- ::: -->
<!-- :::{.column width="48.5%"} -->
<!-- ```{r binomial_r_2} -->
<!-- ## 2. P(X >= 6) = P(X > 5) -->
<!-- pbinom(q = 5, size = 15, prob = 0.2,  -->
<!--        lower.tail = FALSE)   -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<p>Below is an example of how to generate the binomial probability distribution as a graph.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, size <span class="op">=</span> <span class="fl">15</span>, prob <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, </span>
<span>     type <span class="op">=</span> <span class="st">'h'</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"P(X = x)"</span>, </span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>, main <span class="op">=</span> <span class="st">"Binomial(15, 0.2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="prob-disc_files/figure-html/binom-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here a sequence of integers 0 to 15 are created and put in the x-axis. Then <code>dbinom(0:15, size = 15, prob = 0.2)</code> is used to create probabilities of <span class="math inline">\(binomial(15, 0.2)\)</span> for each integer. The vertical bar geometry comes from the argument <code>type = 'h'</code> standing for “<strong>h</strong>istogram”.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Since <span class="math inline">\(n = 15\)</span> and <span class="math inline">\(\pi = 0.2\)</span>, the mean is <span class="math inline">\((15)(0.2) = 3\)</span>. For the binomial distribution, it means that the number of success is more likely to be happened around <span class="math inline">\(x = 3\)</span>. It is very uncommon to see that more than 10 drivers have alcohol level above the legal limit.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>In practice, we are not gonna calculate probabilities of binomial or other commonly used probability distributions. Instead, we use computing software. In Python we can use the methods in the <code>scipy.stats.binom</code> module to calculate probabilities or generate values from the distributions. In general, for some distribution, short for dist, Python has the following functions</p>
<ul>
<li>
<code>dist.pmf(k, ...)</code>: calculate probability value <span class="math inline">\(P(X = k)\)</span>.
<ul>
<li>
<code>pmf</code> means <strong>p</strong>robability <strong>m</strong>ass <strong>f</strong>unction.</li>
</ul>
</li>
<li>
<code>dist.pdf(x, ...)</code>: calculate probability density <span class="math inline">\(f(x)\)</span>.
<ul>
<li>
<code>pdf</code> means <strong>p</strong>robability <strong>d</strong>ensity <strong>f</strong>unction.</li>
</ul>
</li>
<li>
<code>dist.cdf(k, ...)</code>: calculate <span class="math inline">\(P(X \le k)\)</span>.
<ul>
<li>
<code>cdf</code> means <strong>c</strong>umulative <strong>d</strong>istribution <strong>f</strong>unction.</li>
</ul>
</li>
<li>
<code>dist.sf(k, ...)</code>: calculate <span class="math inline">\(P(X &gt; k)\)</span>.
<ul>
<li>
<code>sf</code> means <strong>s</strong>urvival <strong>f</strong>unction.</li>
</ul>
</li>
<li>
<code>dist.ppf(q, ...)</code>: obtain quantile of probability <span class="math inline">\(q\)</span>.
<ul>
<li>
<code>ppf</code> means <strong>p</strong>ercent <strong>p</strong>oint <strong>f</strong>unction.</li>
</ul>
</li>
<li>
<code>dist.rvs(n, ...)</code>: generate <span class="math inline">\(n\)</span> random numbers.
<ul>
<li>
<code>rvs</code> means <strong>r</strong>andom <strong>v</strong>ariable<strong>s</strong>.</li>
</ul>
</li>
</ul>
<p>When we use these functions, the dist is replaced with the shortened name of the distribution we consider. For example, we use <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binom.html"><code>binom.pmf(k, ...)</code></a> to do the calculation for the binomial distribution.</p>
<p>For the binomial distribution, we use <code>binom.pmf(k, n, p)</code> to compute <span class="math inline">\(P(X = k)\)</span>, where <code>n</code> is the number of trials and <code>p</code> is the probability of success. Besides <code>k</code>, we need to provide the values of <code>n</code> and <code>p</code> because remember that they are the parameters of the binomial distribution. Without them, we cannot have a specific binomial distribution, and its probability cannot be calculated.</p>
<p>To obtain <span class="math inline">\(P(X = 6)\)</span> where <span class="math inline">\(X \sim binomial(n=15, \pi=0.2)\)</span>, in Python, we do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binomial distribution calculations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. P(X = 6)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>binom.pmf(k<span class="op">=</span><span class="dv">6</span>, n<span class="op">=</span><span class="dv">15</span>, p<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.04299262263296005</code></pre>
</div>
</div>
<p>To answer the second question <span class="math inline">\(P(X \ge 6)\)</span>, we can use the function <strong><code>binom.cdf(k, n, p)</code></strong> that calculates <span class="math inline">\(P(X \le k)\)</span> for <span class="math inline">\(X \sim bionomial(n = \texttt{n}, \pi = \texttt{p})\)</span>. Notice that <span class="math inline">\(P(X &gt;= 6) = 1 - P(X &lt;= 5)\)</span>, so in Python, we can do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. P(X &gt;= 6) = 1 - P(X &lt;= 5)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-</span> binom.cdf(k<span class="op">=</span><span class="dv">5</span>, n<span class="op">=</span><span class="dv">15</span>, p<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.06105142961766408</code></pre>
</div>
</div>
<p>The function <code>binom.cdf(q, n, p)</code> calculates the probability <span class="math inline">\(P(X \le k)\)</span> which is the left or <strong>lower tail</strong> part of the distribution. We can use <code>binom.sf(q, n, p)</code> to calculate <span class="math inline">\(P(X &gt; q)\)</span> which is the right or <strong>upper tail</strong> part of the distribution. Since <span class="math inline">\(P(X \ge 6) = P(X &gt; 5)\)</span>, in Python we can do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, using the upper tail probability</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>binom.sf(<span class="dv">5</span>, n<span class="op">=</span><span class="dv">15</span>, p<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.061051429617664056</code></pre>
</div>
</div>
<p>Notice that we use <code>k=5</code> instead of <code>k=6</code> because we want <span class="math inline">\(P(X &gt; 5)\)</span>. The probability value is the same as the value before.</p>
<p>Below is an example of how to generate the binomial probability distribution as a graph. We use the stem plot <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.stem.html">plt.stem()</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15])</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="prob-disc_files/figure-html/binom-plot-py-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here a sequence of integers 0 to 15 are created and put in the x-axis. <code>np.arange(0, 16)</code> is a way to generate a sequence of numbers from 0 to 15. Again 0 is included but 16 is not. Then <code>binom.pmf(np.arange(0, 16), n=15, p=0.2)</code> is used to create probabilities of <span class="math inline">\(binomial(15, 0.2)\)</span> for each integer.</p>
<p>Since <span class="math inline">\(n = 15\)</span> and <span class="math inline">\(\pi = 0.2\)</span>, the mean is <span class="math inline">\((15)(0.2) = 3\)</span>. For the binomial distribution, it means that the number of success is more likely to be happened around <span class="math inline">\(x = 3\)</span>. It is very uncommon to see that more than 10 drivers have alcohol level above the legal limit.</p>
</div>
</div>
</div>
</section><section id="poisson-distribution" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="poisson-distribution">
<span class="header-section-number">10.3</span> Poisson Distribution</h2>
<p><span style="color:blue"> <strong>Poisson Random Variables</strong> </span></p>
<p>If we want to count <strong>the number of occurrences of some event<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> over a unit of time or space/region/volume</strong> and observe its associated probability, we could consider the <strong>Poisson distribution</strong>. For example,</p>
<ul>
<li>The number of COVID patients arriving at ICU in one hour</li>
<li>The number of Marquette students logging onto D2L in one day</li>
<li>The number of dandelions per square meter on Marquette’s campus</li>
</ul>
<p>Let <span class="math inline">\(X\)</span> be a Poisson random variable. Then <span class="math inline">\(\color{blue}{X \sim Poisson(\lambda)}\)</span>, where <span class="math inline">\(\lambda\)</span> is the parameter representing the <strong>mean</strong> number of occurrences of the event in some time interval or region. The Poisson probability function is</p>
<p><span class="math display">\[\color{blue}{P(X = x \mid \lambda) = \frac{\lambda^x e^{-\lambda}}{x!}, \quad x = 0, 1, 2, \dots}\]</span></p>
<p>Again, the parameter <span class="math inline">\(\lambda\)</span> determines the shape of the distribution. The constant <span class="math inline">\(e\)</span> is the Euler’s number that is approximately <span class="math inline">\(2.7182818284\)</span>. <span class="math inline">\(x! = x \times (x-1) \times \cdots \times 2 \times 1\)</span> and <span class="math inline">\(0! = 1\)</span>. Note that the possible value of <span class="math inline">\(x\)</span> could be any positive integer. Theoretically speaking, there is no upper limit for the number of occurrences of any event. No worries. You don’t need to memorize the formula, but it’s good to recognize it.</p>
<p>One interesting property of the Poisson distribution is that its mean and variance are both equal to its parameter <span class="math inline">\(\lambda\)</span>. So a <span class="math inline">\(Poisson(5)\)</span> distribution has mean and variance being equal to 5.</p>
<!-- - Both the mean and the variance are equal to $\lambda$. -->
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb25-0"><a href="#cb25-0" aria-hidden="true" tabindex="-1"></a>viewof params_pois <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="dv">20</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\l</span><span class="vs">ambda:`</span>})<span class="op">,</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">40</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"quantile:"</span>})</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb26-0"><a href="#cb26-0" aria-hidden="true" tabindex="-1"></a>dist_quantile <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{If } X </span><span class="sc">\s</span><span class="vs">im </span><span class="sc">\o</span><span class="vs">peratorname{Poisson}(</span><span class="sc">${</span>params_pois[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">) </span><span class="sc">\t</span><span class="vs">ext{ then } `</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb27-0"><a href="#cb27-0" aria-hidden="true" tabindex="-1"></a>moments_pois <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="vs">egin{aligned}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\m</span><span class="vs">athrm{E}( X) =  </span><span class="sc">\l</span><span class="vs">ambda = </span><span class="sc">${</span>params_pois[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\m</span><span class="vs">athrm{Var}( X) =  </span><span class="sc">\l</span><span class="vs">ambda  = </span><span class="sc">${</span>params_pois[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\m</span><span class="vs">athrm{P}( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>params_pois[<span class="dv">1</span>]<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>poiscdf<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="vs">nd{aligned}</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plt_pois <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"P(X = x)"</span><span class="op">,</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"#097969"</span><span class="op">,</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#097969"</span><span class="op">,</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(poispdf<span class="op">,</span>{<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#C1E1C1"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">pdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(poispdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> params_pois[<span class="dv">1</span>]<span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#50C878"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">pdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ojs-cell-16" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ojs-cell-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ojs-cell-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.4: Source: <a href="https://observablehq.com/@mattiasvillani/poisson-distribution" class="uri">https://observablehq.com/@mattiasvillani/poisson-distribution</a>
</figcaption></figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb29-0"><a href="#cb29-0" aria-hidden="true" tabindex="-1"></a>poispdf <span class="op">=</span> {</span>
<span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> params_pois[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">4</span><span class="op">*</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params_pois[<span class="dv">0</span>])<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">poisson</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params_pois[<span class="dv">0</span>])}))<span class="op">;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb30-0"><a href="#cb30-0" aria-hidden="true" tabindex="-1"></a>poiscdf <span class="op">=</span> jstat<span class="op">.</span><span class="at">poisson</span><span class="op">.</span><span class="fu">cdf</span>(params_pois[<span class="dv">1</span>]<span class="op">,</span> params_pois[<span class="dv">0</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Assumptions and Properties of Poisson Variables</strong> </span></p>
<p>As the binomial distribution, the Poisson distribution comes from the Poisson experiment having the following properties and assumptions:</p>
<ul>
<li><p>👉 <strong>Events occur one at a time</strong>; two or more events do not occur at the same time or in the same space or spot. For example, one cannot say two patients arrived at ICU at the same time. There must be a way to separate one event from the other, and one can always know which patient arrives at ICU earlier.</p></li>
<li><p>👉 The occurrence of an event in a given period of time or region of space is <strong>independent</strong> of the occurrence of the event in a <strong>nonoverlapping</strong> time period or region of space. For example, number of patients arriving at ICU between 2 PM and 3 PM has nothing to do with the number of patients arriving at ICU between 8 PM and 9 PM because the two time periods have no overlap.</p></li>
<li><p>👉 <span class="math inline">\(\lambda\)</span> is <strong>constant</strong> for any period or region. For example, the <em>mean</em> number of patients arriving at ICU between 2 PM and 3 PM is the same as the <em>mean</em> number of patients arriving at ICU between 8 PM and 9 PM. This assumption is pretty strong, and usually violated in reality. If you want to use Poisson distribution to build your statistical model, use it with additional care.</p></li>
</ul>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What are the differences between Binomial and Poisson distributions?
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Poisson distribution</p>
<ul>
<li><p>is determined by one single parameter <span class="math inline">\(\lambda\)</span></p></li>
<li><p>has possible values <span class="math inline">\(x = 0, 1, 2, \dots\)</span> with no upper limit (countable), while a binomial variable has possible values <span class="math inline">\(0, 1, 2, \dots, n\)</span> (finite)</p></li>
</ul>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Example</strong> </span></p>
<div class="columns">
<div class="column" style="width:80%;">
<p>Last year there were 4200 births at the University of Wisconsin Hospital. Let <span class="math inline">\(X\)</span> be the number of births in a given day at the center, and assume <span class="math inline">\(X \sim Poisson(\lambda)\)</span>. Find</p>
<ol type="1">
<li><p><span class="math inline">\(\lambda\)</span>, the mean number of births <strong>per day</strong>.</p></li>
<li><p>the probability that on a randomly selected day, there are exactly 10 births.</p></li>
<li><p><span class="math inline">\(P(X &gt; 10)\)</span>?</p></li>
</ol>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-prob/baby.jpeg" class="img-fluid figure-img" width="1226"></p>
<figcaption>Source: Unsplash kaushal mishra</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<ol type="1">
<li><p><span class="math inline">\(\small \lambda = \frac{\text{Number of birth in a year}}{\text{Number of days}} = \frac{4200}{365} = 11.5.\)</span> There are totally 4200 births in one year, so on average there are 11.5 per day. According to how we define <span class="math inline">\(X\)</span>, the time unit is a day, not a year. The parameter <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(X\)</span> should have the same time unit.</p></li>
<li><p><span class="math inline">\(\small P(X = 10 \mid \lambda = 11.5) = \frac{\lambda^x e^{-\lambda}}{x!} = \frac{11.5^{10} e^{-11.5}}{10!} = 0.113.\)</span></p></li>
<li><p><span class="math inline">\(\small P(X &gt; 10) = p(11) + p(12) + \dots + p(20) + \dots\)</span> (No end!) <span class="math inline">\(\small P(X &gt; 10) = 1 - P(X \le 10) = 1 - (p(1) + p(2) + \dots + p(10))\)</span>.</p></li>
</ol>
<p>Did you see how tedious it is to calculate the Poisson probabilities even using a calculator? I know you are waiting for R/Python implementation!</p>
<!-- --------------------------------------------------------------- -->
<!-- <span style="color:blue"> **Computation in R** </span> -->
<!-- - R Shiny app is at [Poisson Calculator](http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/) -->
<!-- P(X <= 10) = 0.392 -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Instead of using <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> and <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code>, for Poisson distribution, we replace <code>binom</code> with <code>pois</code>, and use <code>dpois(x, lambda)</code> and <code>ppois(q, lambda)</code> to calculate the probabilities.</p>
<p>With <code>lambda</code> being the mean of Poisson distribution, and <span class="math inline">\(X\sim Poisson(\lambda)\)</span>, we use</p>
<ul>
<li><p><strong><code>dpois(x, lambda)</code></strong> to compute <span class="math inline">\(P(X = x \mid \lambda)\)</span></p></li>
<li><p><strong><code>ppois(q, lambda)</code></strong> to compute <span class="math inline">\(P(X \le q \mid \lambda)\)</span></p></li>
<li><p><strong><code>ppois(q, lambda, lower.tail = FALSE)</code></strong> to compute <span class="math inline">\(P(X &gt; q \mid \lambda)\)</span></p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.50685</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.112834</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5990436</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5990436</code></pre>
</div>
</div>
<!-- ::::{.columns} -->
<!-- :::{.column width="49%"} -->
<!-- ```{r pois_1} -->
<!-- (lam <- 4200 / 365) -->
<!-- ## P(X = 10) -->
<!-- dpois(x = 10, lambda = lam)   -->
<!-- ``` -->
<!-- ::: -->
<!-- :::{.column width="2%"} -->
<!-- ::: -->
<!-- :::{.column width="49%"} -->
<!-- ```{r poisson_r_2} -->
<!-- ## P(X > 10) = 1 - P(X <= 10) -->
<!-- 1 - ppois(q = 10, lambda = lam)   -->
<!-- ## P(X > 10) -->
<!-- ppois(q = 10, lambda = lam,  -->
<!--       lower.tail = FALSE)  -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<p>Below is an example of how to generate the Poisson probability distribution as a graph.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">24</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">24</span>, lambda <span class="op">=</span> <span class="va">lam</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'h'</span>, </span>
<span>     lwd <span class="op">=</span> <span class="fl">5</span>, ylab <span class="op">=</span> <span class="st">"P(X = x)"</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Poisson(11.5)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/pois-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Be careful that the Poisson <span class="math inline">\(X\)</span> has no upper limit; the graph is <em>truncated</em> at <span class="math inline">\(x = 24\)</span>. Strictly speaking, the graph does not accurately display the <span class="math inline">\(Poisson(11.5)\)</span> distribution. Since the mean is 11.5, we know that it is very unlikely to have a very large <span class="math inline">\(x\)</span>, that is <span class="math inline">\(P(X = x)\)</span> is very close to zero for <span class="math inline">\(x &gt; 25\)</span>. As the binomial distribution, the number of occurrences is more likely to be around its mean number 11.5, and the chance is decaying as the number is away from the mean.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Instead of using <code>binom.pnf()</code> and <code>binom.cdf()</code>, for Poisson distribution, we replace <code>binom</code> with <code>poisson</code>, and use <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.poisson.html"><code>poisson.pmf(k, mu)</code></a> and <code>poisson.cdf(k, mu)</code> to calculate the probabilities.</p>
<p>With <code>lambda</code> being the mean of Poisson distribution, and <span class="math inline">\(X\sim Poisson(\lambda)\)</span>, we use</p>
<ul>
<li><p><strong><code>poisson.pmf(k, mu = lambda)</code></strong> to compute <span class="math inline">\(P(X = k \mid \lambda)\)</span></p></li>
<li><p><strong><code>poisson.cdf(k, mu = lambda)</code></strong> to compute <span class="math inline">\(P(X \le k \mid \lambda)\)</span></p></li>
<li><p><strong><code>poisson.sf(k, mu = lambda)</code></strong> to compute <span class="math inline">\(P(X &gt; k \mid \lambda)\)</span></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>11.506849315068493</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1128340209466802</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>0.5990435715682069</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5990435715682069</code></pre>
</div>
</div>
<p>Below is an example of how to generate the Poisson probability distribution as a graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plt.stem(np.arange(<span class="dv">0</span>, <span class="dv">25</span>), poisson.pmf(np.arange(<span class="dv">0</span>, <span class="dv">25</span>), mu<span class="op">=</span>lam), </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>         basefmt<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"P(X = x)"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Poisson(11.5)"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/pois-plot-py-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Be careful that the Poisson <span class="math inline">\(X\)</span> has no upper limit; the graph is <em>truncated</em> at <span class="math inline">\(x = 24\)</span>. Strictly speaking, the graph does not accurately display the <span class="math inline">\(Poisson(11.5)\)</span> distribution. Since the mean is 11.5, we know that it is very unlikely to have a very large <span class="math inline">\(x\)</span>, that is <span class="math inline">\(P(X = x)\)</span> is very close to zero for <span class="math inline">\(x &gt; 25\)</span>. As the binomial distribution, the number of occurrences is more likely to be around its mean number 11.5, and the chance is decaying as the number is away from the mean.</p>
<!-- :::{.callout-note} -->
<!-- - $X$ has no upper limit; the graph is *truncated* at $x = 24$.  -->
<!-- ::: -->
</div>
</div>
</div>
</section><section id="relationship-between-binomial-and-poisson" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="relationship-between-binomial-and-poisson">
<span class="header-section-number">10.4</span> Relationship between Binomial and Poisson*</h2>
<p>Actually binomial and Poisson distributions are somewhat related. Let’s consider the following example.</p>
<p>Suppose a store owner believes that customers arrive at his store at a rate of 3.6 customers per hour on average. He wants to find the distribution of the number customers who will arrive during a particular one-hour period. And here is what he plans to do.</p>
<p>He models customer arrivals in different time periods as independent. Then he divides the one-hour period into 3600 seconds and thinks of the arrival rate as being <span class="math inline">\(3.6/3600 = 0.001\)</span> per second.During each second either 0 or 1 customer will arrive, and the probability of an arrival during any single second is <span class="math inline">\(0.001\)</span>.</p>
<!-- - He then tries to use the binomial distribution with -->
<!-- parameters $n = 3600$ and $\pi = 0.001$ for the distribution of the number of customers -->
<!-- who arrive during the one-hour period later in the day. -->
<p>Think about it. what he does is actually an <strong>binomial</strong> experiment because his experiment has</p>
<ul>
<li>A fixed number of identical trials: <strong>3600 seconds (each second is one trial)</strong>
</li>
<li>Each trial results in one of two outcomes <strong>(No customer or 1 customer)</strong>
</li>
<li>Trials are independent. <strong>(customer arrivals in different time periods are independent)</strong>
</li>
<li>The probability of success is constant. <strong>(the probability of an arrival during any single second is 0.001)</strong>
</li>
</ul>
<p>If we let <span class="math inline">\(X\)</span> be the number of customers arrived during one-hour period or 3600 seconds, then <span class="math inline">\(X \sim binomial(n=3600, \pi = 0.001)\)</span>. However, since he’s actually counting the number of occurrences over a unit of time, we know that he can model <span class="math inline">\(X\)</span> as a Poisson random variable with mean 3.6 customers per hour which is happened to be equal to <span class="math inline">\(n\pi\)</span> in the binomial distribution: <span class="math inline">\(X \sim Poisson(\lambda = 3.6 = n\pi)\)</span>.</p>
<p>So what do we learn from this example? <em>“All models are wrong, but some are useful” – George E. Box (1919 - 2013)</em>. We can deal with a problem using different approaches or models. Also, the binomial and Poisson distributions are somehow related with each other.</p>
<hr>
<p>So in fact, when <span class="math inline">\(n\)</span> is large and <span class="math inline">\(\pi\)</span> is small, like the ones in our example, we can use Poisson distribution as approximation to binomial distribution with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span>, where the <span class="math inline">\(\lambda\)</span> parameter in Poisson distribution equals <span class="math inline">\(n\pi\)</span>.</p>
<p>Let’s see the two probability distributions with different size of <span class="math inline">\(n\)</span> and <span class="math inline">\(\pi\)</span>. On the left, <span class="math inline">\(n\)</span> is not large, just 10, and <span class="math inline">\(\pi\)</span> is not small, just <span class="math inline">\(0.5\)</span>. We can see that the two distributions are not alike. The binomial distribution is symmetric and the Poisson is a little bit right-skewed, and more spread out.</p>
<p>When <span class="math inline">\(n\)</span> is large, say 100, and <span class="math inline">\(\pi\)</span> is small like <span class="math inline">\(0.01\)</span>, the two distributions are almost the same! It is hard to distinguish them by our eyes. If you want to learn formal proof about how a binomial distribution converges to Poisson as <span class="math inline">\(n\)</span> goes to infinity, and <span class="math inline">\(\pi\)</span> goes to zero while <span class="math inline">\(n\pi\)</span> stays constant, you can take a probability theory course.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/poisson_approx_1-3.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/poisson_approx_1-4.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/poisson_approx_2-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="prob-disc_files/figure-html/poisson_approx_2-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb42" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb42-0"><a href="#cb42-0" aria-hidden="true" tabindex="-1"></a>viewof params_binom_pois <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">200</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`n`</span>})<span class="op">,</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.001</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\p</span><span class="vs">i`</span>})<span class="op">,</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb43" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb43--1"><a href="#cb43--1" aria-hidden="true" tabindex="-1"></a>viewof kvantil_binom_pois <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> params_binom_pois[<span class="dv">0</span>]]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"quantile"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb44" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb44--1"><a href="#cb44--1" aria-hidden="true" tabindex="-1"></a>moments_binom_pois <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb44-0"><a href="#cb44-0" aria-hidden="true" tabindex="-1"></a><span class="sc">\t</span><span class="vs">ext{If } X </span><span class="sc">\s</span><span class="vs">im </span><span class="sc">\o</span><span class="vs">peratorname{Binom}(</span><span class="sc">${</span>params_binom_pois[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>params_binom_pois[<span class="dv">1</span>]<span class="sc">}</span><span class="vs">) </span><span class="sc">\t</span><span class="vs">ext{ then }</span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="vs">E( X) =n  </span><span class="sc">\p</span><span class="vs">i = </span><span class="sc">${</span>(params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>])<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="vs">Var( X) =n  </span><span class="sc">\p</span><span class="vs">i (1-</span><span class="sc">\p</span><span class="vs">i) =</span><span class="sc">${</span>(params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params_binom_pois[<span class="dv">1</span>]))<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.5em]</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb45" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb45--1"><a href="#cb45--1" aria-hidden="true" tabindex="-1"></a>cdfs_poisapprox <span class="op">=</span> </span>
<span id="cb45-0"><a href="#cb45-0" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cdf<span class="op">;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (poisapprox){</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>      cdf <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\b</span><span class="vs">egin{array}{ll}</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\t</span><span class="vs">ext{Exact:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil_binom_pois<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>binomcdf_binom_pois<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.25em]</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\t</span><span class="vs">ext{Poisson approx} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil_binom_pois<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>poissonapproxcdf<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\e</span><span class="vs">nd{array}</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>      cdf <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\b</span><span class="vs">egin{array}{ll}</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\t</span><span class="vs">ext{Exact:} &amp; P( X</span><span class="sc">\l</span><span class="vs">eq </span><span class="sc">${</span>kvantil_binom_pois<span class="sc">}</span><span class="vs">) =</span><span class="sc">${</span>binomcdf_binom_pois<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">\e</span><span class="vs">nd{array}</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span> </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cdf<span class="op">;</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb46" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb46--1"><a href="#cb46--1" aria-hidden="true" tabindex="-1"></a>viewof plotselector <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"poisson"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"plot approximation:"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="st">"poisson approximation"</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb47" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb47--1"><a href="#cb47--1" aria-hidden="true" tabindex="-1"></a>plt_pdf <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb47-0"><a href="#cb47-0" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>          <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>          <span class="dt">domain</span><span class="op">:</span> legenddomain<span class="op">.</span><span class="fu">filter</span>( (d<span class="op">,</span>i) <span class="kw">=&gt;</span> boolselect[i])<span class="op">,</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>          <span class="dt">range</span><span class="op">:</span> legendcolor<span class="op">.</span><span class="fu">filter</span>( (d<span class="op">,</span>i) <span class="kw">=&gt;</span> boolselect[i])</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> xrange</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"P(X = x)"</span><span class="op">,</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span><span class="fl">1.1</span><span class="op">*</span>jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">pdf</span>(params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>]<span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">,</span>params_binom_pois[<span class="dv">1</span>])]</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"b39640"</span><span class="op">,</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"b39640"</span><span class="op">,</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(approxpdf<span class="op">,</span>{<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"binompdf"</span><span class="op">,</span> <span class="dt">fill</span> <span class="op">:</span> <span class="st">"#C1CFE4"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.8</span><span class="op">,</span> </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">binompdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">barY</span>(approxpdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> kvantil_binom_pois<span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"binompdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#98afd2"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="vs">`P(X=</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">) = </span><span class="sc">${</span>(d<span class="op">.</span><span class="at">binompdf</span>)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.line(approxpdf, {filter: d =&gt; normalapprox, x: "x", y: "normalpdf", stroke : "#AB8D61", strokeWidth: 3}),</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.dot(approxpdf, {filter: d =&gt; normalapprox, x: "x", y: "normalpdf", stroke : "#AB8D61", strokeWidth: 3}),</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.line(approxpdf, {filter: d =&gt; normalapproxcorr, x: "x", y: "normalpdfcorr", stroke : "#007878", strokeWidth: 3}),</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.dot(approxpdf, {filter: d =&gt; normalapproxcorr, x: "x", y: "normalpdfcorr", stroke : "#007878", strokeWidth: 3}),</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>(approxpdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> poisapprox <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"poissonpdf"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#780000"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span>  </span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(approxpdf<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> poisapprox <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"poissonpdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#780000"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">5</span>})<span class="op">,</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb48" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb48--1"><a href="#cb48--1" aria-hidden="true" tabindex="-1"></a>approxpdf <span class="op">=</span> {</span>
<span id="cb48-0"><a href="#cb48-0" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> xrange<span class="op">;</span></span>
<span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> approxpdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">binompdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">,</span> params_binom_pois[<span class="dv">1</span>])<span class="op">,</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// normalpdf: jstat.normal.pdf(x, params[0]*params[1], Math.sqrt(params[0]*params[1]*(1-params[1]))), </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// normalpdfcorr: jstat.normal.pdf(x + 0.5, params[0]*params[1], Math.sqrt(params[0]*params[1]*(1-params[1]))),</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">poissonpdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">poisson</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>])</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> approxpdf</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb49" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb49--1"><a href="#cb49--1" aria-hidden="true" tabindex="-1"></a>xrange <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> high <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb50" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb50--1"><a href="#cb50--1" aria-hidden="true" tabindex="-1"></a>high <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">inv</span>(<span class="fl">0.9999</span><span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>params_binom_pois[<span class="dv">1</span>]))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="declaration">

</div>
</div>
</div>
<!-- ```{ojs} -->
<!-- //low = Math.floor(jstat.normal.inv(0.0001, params_binom_pois[0]*params_binom_pois[1], Math.sqrt(params_binom_pois[0]*params_binom_pois[1]*(1-params_binom_pois[1])))) -->
<!-- ``` -->
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb51" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb51--1"><a href="#cb51--1" aria-hidden="true" tabindex="-1"></a>legendcolor <span class="op">=</span> [<span class="st">"#C1CFE4"</span><span class="op">,</span> <span class="st">"#AB8D61"</span><span class="op">,</span> <span class="st">"#007878"</span><span class="op">,</span> <span class="st">"#780000"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb52" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb52--1"><a href="#cb52--1" aria-hidden="true" tabindex="-1"></a>boolselect <span class="op">=</span> [<span class="kw">true</span><span class="op">,</span> poisapprox]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb53" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb53--1"><a href="#cb53--1" aria-hidden="true" tabindex="-1"></a>poisapprox <span class="op">=</span> plotselector<span class="op">.</span><span class="fu">includes</span>(<span class="st">"poisson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb54" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb54--1"><a href="#cb54--1" aria-hidden="true" tabindex="-1"></a>legenddomain <span class="op">=</span> [<span class="st">"binomial"</span><span class="op">,</span> <span class="st">"poisson"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb55" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb55--1"><a href="#cb55--1" aria-hidden="true" tabindex="-1"></a>poissonapproxcdf <span class="op">=</span> jstat<span class="op">.</span><span class="at">poisson</span><span class="op">.</span><span class="fu">cdf</span>(kvantil_binom_pois<span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">*</span>params_binom_pois[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-32" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb56" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb56--1"><a href="#cb56--1" aria-hidden="true" tabindex="-1"></a>binomcdf_binom_pois <span class="op">=</span> jstat<span class="op">.</span><span class="at">binomial</span><span class="op">.</span><span class="fu">cdf</span>(kvantil_binom_pois<span class="op">,</span> params_binom_pois[<span class="dv">0</span>]<span class="op">,</span> params_binom_pois[<span class="dv">1</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-33" data-nodetype="declaration">

</div>
</div>
</div>
</section><section id="exercises" class="level2" data-number="10.5"><h2 data-number="10.5" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">10.5</span> Exercises</h2>
<ol type="1">
<li>Data collected by the Substance Abuse and Mental Health Services Administration (SAMSHA) suggests that 65% of 18-20 year olds consumed alcoholic beverages in any given year.
<ol type="a">
<li>Suppose a random sample of twelve 18-20 year olds is taken. When does it make sense to use binomial distribution for calculating the probability that exactly five consumed alcoholic beverages?</li>
<li>What is the probability that exactly five out of twelve 18-20 year olds have consumed an alcoholic beverage?</li>
<li>What is the probability that at most 3 out of 7 randomly sampled 18-20 year olds have consumed alcoholic beverages?</li>
</ol>
</li>
<li>A Dunkin’ Donuts in Milwaukee serves an average of 65 customers per hour during the morning rush.
<ol type="a">
<li>Which distribution have we studied that is most appropriate for calculating the probability of a given number of customers arriving within one hour during this time of day?</li>
<li>What are the mean and the standard deviation of the number of customers this Starbucks serves in one hour during this time of day?</li>
<li>Calculate the probability that this Dunkin’ Donuts serves 55 customers in one hour during this time of day.</li>
</ol>
</li>
</ol>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>It is a little misleading. The <code>'h'</code> type here is just a notation for this bar-like plotting type, not really the histogram we discussed in <a href="data-graphics.html" class="quarto-xref"><span>Chapter 5</span></a>. To draw a histogram, we use the function <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In this Poisson distribution section, the word event means an incident or happening. It is not the event used in probability, which is a set conceptually.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwYXJhbXMgPSBJbnB1dHMuZm9ybShbXG4gICAgICBJbnB1dHMucmFuZ2UoWzEsIDIwMF0sIHt2YWx1ZTogMTAsIHN0ZXA6IDEsIGxhYmVsOiB0ZXhgbmB9KSxcbiAgICAgIElucHV0cy5yYW5nZShbMCwgMV0sIHt2YWx1ZTogMC41LCBzdGVwOiAwLjAxLCBsYWJlbDogdGV4YFxccGlgfSksXG4gICAgXSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBrdmFudGlsID0gSW5wdXRzLnJhbmdlKFsxLCBwYXJhbXNbMF1dLCB7dmFsdWU6IDMsIHN0ZXA6IDEsIGxhYmVsOiBcInF1YW50aWxlXCJ9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGFwcHJveCA9IElucHV0cy50b2dnbGUoe2xhYmVsOiBcInNob3cgbm9ybWFsIGFwcHJveGltYXRpb25cIiwgdmFsdWU6IGZhbHNlfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImpzdGF0ID0gcmVxdWlyZSgnanN0YXQnKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYmlub21jZGYgPSBqc3RhdC5iaW5vbWlhbC5jZGYoa3ZhbnRpbCwgcGFyYW1zWzBdLCBwYXJhbXNbMV0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibm9ybWFsYXBwcm94cGRmID0ge1xuICBjb25zdCB4ID0gZDMucmFuZ2UoMCwgcGFyYW1zWzBdLCAxKTtcbiAgY29uc3Qgbm9ybWFsYXBwcm94cGRmID0geC5tYXAoeCA9PiAoe3g6IHgsIHBkZjoganN0YXQubm9ybWFsLnBkZih4LCBwYXJhbXNbMF0qcGFyYW1zWzFdLCBNYXRoLnNxcnQocGFyYW1zWzBdKnBhcmFtc1sxXSooMS1wYXJhbXNbMV0pKSl9KSk7XG4gIHJldHVybiBub3JtYWxhcHByb3hwZGZcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im5vcm1hbGFwcHJveGNkZiA9IGpzdGF0Lm5vcm1hbC5jZGYoa3ZhbnRpbCwgcGFyYW1zWzBdKnBhcmFtc1sxXSwgTWF0aC5zcXJ0KHBhcmFtc1swXSpwYXJhbXNbMV0qKDEtcGFyYW1zWzFdKSkpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJub3JtYWxhcHByb3hjZGZfY29ycmVjdGVkID0ganN0YXQubm9ybWFsLmNkZihrdmFudGlsKzAuNSwgcGFyYW1zWzBdKnBhcmFtc1sxXSwgTWF0aC5zcXJ0KHBhcmFtc1swXSpwYXJhbXNbMV0qKDEtcGFyYW1zWzFdKSkpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJiaW5vbXBkZiA9IHtcbiAgY29uc3QgeCA9IGQzLnJhbmdlKDAsIHBhcmFtc1swXSsxLCAxKTtcbiAgY29uc3QgYmlub21wZGYgPSB4Lm1hcCh4ID0+ICh7eDogeCwgcGRmOiBqc3RhdC5iaW5vbWlhbC5wZGYoeCwgcGFyYW1zWzBdLCBwYXJhbXNbMV0pLCB0eXBlOiBcImV4YWN0XCJ9KSk7XG4gIGNvbnN0IG5vcm1hbGFwcHJveHBkZiA9IHgubWFwKHggPT4gKHt4OiB4LCBwZGY6IGpzdGF0Lm5vcm1hbC5wZGYoeCwgcGFyYW1zWzBdKnBhcmFtc1sxXSwgTWF0aC5zcXJ0KHBhcmFtc1swXSpwYXJhbXNbMV0qKDEtcGFyYW1zWzFdKSkpLHR5cGU6IFwiYXBwcm94XCJ9KSk7XG4gIGNvbnN0IGRhdGEgPSBiaW5vbXBkZi5jb25jYXQobm9ybWFsYXBwcm94cGRmKVxuICByZXR1cm4gZGF0YVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vbWVudHMgPSB0ZXhgXG5cXHRleHR7SWYgfSBYIFxcc2ltIFxcb3BlcmF0b3JuYW1le0Jpbm9tfSgke3BhcmFtc1swXX0sJHtwYXJhbXNbMV19KSBcXHRleHR7IHRoZW4gfVxcXFxbMC41ZW1dXG5cbkUoIFgpID1uICBcXHBpID0gJHsocGFyYW1zWzBdKnBhcmFtc1sxXSkudG9QcmVjaXNpb24oMyl9IFxcXFxbMC41ZW1dXG5WYXIoIFgpID1uICBcXHBpICgxLVxccGkpID0keyhwYXJhbXNbMF0qcGFyYW1zWzFdKigxLXBhcmFtc1sxXSkpLnRvUHJlY2lzaW9uKDMpfSBcXFxcWzAuNWVtXVxuXG5gXG5cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjZGZzID0gXG57XG4gIHZhciBjZGY7XG4gIGlmIChhcHByb3gpe1xuICBjZGYgPSB0ZXhgXG4gIFxcYmVnaW57YXJyYXl9e2xsfVxuICBcXHRleHR7RXhhY3QgYmlub21pYWw6fSAmIFAoIFhcXGxlcSAke2t2YW50aWx9KSA9JHtiaW5vbWNkZi50b1ByZWNpc2lvbig0KX0gXFxcXFswLjI1ZW1dXG4gIFxcdGV4dHtOb3JtYWwgYXBwcm94On0gJiBQKCBYXFxsZXEgJHtrdmFudGlsfSkgPSR7bm9ybWFsYXBwcm94Y2RmLnRvUHJlY2lzaW9uKDQpfSBcXFxcWzAuMjVlbV1cbiAgXFx0ZXh0e05vcm1hbCBhcHByb3ggLSBjb3JyOn0gJiBQKCBYXFxsZXEgJHtrdmFudGlsfSkgID0ke25vcm1hbGFwcHJveGNkZl9jb3JyZWN0ZWQudG9QcmVjaXNpb24oNCl9IFxcXFxbMWVtXVxuICBcXGVuZHthcnJheX1cbiAgYH1cbiAgZWxzZXtcbiAgIGNkZiA9IHRleGBcbiAgXFxiZWdpbnthcnJheX17bGx9XG4gIFxcdGV4dHtFeGFjdDp9ICYgUCggWFxcbGVxICR7a3ZhbnRpbH0pID0ke2Jpbm9tY2RmLnRvUHJlY2lzaW9uKDQpfSBcXFxcWzFlbV1cbiAgXFxlbmR7YXJyYXl9XG4gIGAgXG4gIH1cbiAgcmV0dXJuIGNkZjtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwbHRfYmlub20gPSBQbG90LnBsb3Qoe1xuICAgIGNvbG9yOiB7IFxuICAgICAgbGVnZW5kOiBhcHByb3hcbiAgICB9LFxuICAgIHg6IHtcbiAgICAgIGxhYmVsOiBcInhcIixcbiAgICAgIGF4aXM6IHRydWUsXG4gICAgICBkb21haW46IGQzLnJhbmdlKDAsIHBhcmFtc1swXSsxLCAxKVxuICAgIH0sXG4gICAgeToge1xuICAgICAgbGFiZWw6IFwiUChYID0geClcIixcbiAgICAgIGRvbWFpbjogWzAsMS4xKmpzdGF0LmJpbm9taWFsLnBkZihwYXJhbXNbMF0qcGFyYW1zWzFdLCBwYXJhbXNbMF0scGFyYW1zWzFdKV1cbiAgICB9LFxuICB0b29sdGlwOiB7XG4gICAgZmlsbDogXCIjQzA0MDAwXCIsXG4gICAgc3Ryb2tlOiBcIiNDMDQwMDBcIixcbiAgICBvcGFjaXR5OiAxLFxuICB9LFxuICAgIG1hcmtzOiBbXG4gICAgICBQbG90LnJ1bGVZKFswXSksXG4gICAgICBQbG90LmJhclkoYmlub21wZGYse2ZpbHRlcjogZCA9PiBkLnR5cGUgPT0gXCJleGFjdFwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbCA6IFwib3JhbmdlXCIsIHN0cm9rZVdpZHRoOiAwLCBvcGFjaXR5OiAwLjgsIFxuICAgICAgICB0aXRsZTogKGQpID0+IGBQKFg9JHtkLnh9KSA9ICR7KGQucGRmKS50b1ByZWNpc2lvbig0KX1gfSksXG4gICAgICBQbG90LmJhclkoYmlub21wZGYsIHtmaWx0ZXI6IGQgPT4gZC50eXBlID09IFwiZXhhY3RcIiAmJiBkLnggPD0ga3ZhbnRpbCwgeDogXCJ4XCIsIHk6IFwicGRmXCIsIGZpbGw6IFwiZGFya29yYW5nZVwiLCBvcGFjaXR5OiAxLFxuICAgICAgICB0aXRsZTogKGQpID0+IGBQKFg9JHtkLnh9KSA9ICR7KGQucGRmKS50b1ByZWNpc2lvbig0KX1gfSksXG4gICAgICBQbG90LmxpbmUobm9ybWFsYXBwcm94cGRmLCB7ZmlsdGVyOiBkID0+IGFwcHJveCwgeDogXCJ4XCIsIHk6IFwicGRmXCIsIHN0cm9rZSA6IFwic3RlZWxibHVlXCIsIHN0cm9rZVdpZHRoOiAyfSkgICAgXG4gICAgXVxuICB9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwYXJhbXNfcG9pcyA9IElucHV0cy5mb3JtKFtcbiAgICAgIElucHV0cy5yYW5nZShbMC4xLCAyMF0sIHt2YWx1ZTogMiwgc3RlcDogMC4xLCBsYWJlbDogdGV4YFxcbGFtYmRhOmB9KSxcbiAgICAgIElucHV0cy5yYW5nZShbMSwgNDBdLCB7dmFsdWU6IDEsIHN0ZXA6IDEsIGxhYmVsOiBcInF1YW50aWxlOlwifSlcbiAgICBdKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRpc3RfcXVhbnRpbGUgPSB0ZXhgXFx0ZXh0e0lmIH0gWCBcXHNpbSBcXG9wZXJhdG9ybmFtZXtQb2lzc29ufSgke3BhcmFtc19wb2lzWzBdfSkgXFx0ZXh0eyB0aGVuIH0gYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vbWVudHNfcG9pcyA9IHRleGBcblxcYmVnaW57YWxpZ25lZH1cbiZcXG1hdGhybXtFfSggWCkgPSAgXFxsYW1iZGEgPSAke3BhcmFtc19wb2lzWzBdLnRvUHJlY2lzaW9uKDMpfSBcXFxcWzAuNWVtXVxuJlxcbWF0aHJte1Zhcn0oIFgpID0gIFxcbGFtYmRhICA9ICR7cGFyYW1zX3BvaXNbMF0udG9QcmVjaXNpb24oMyl9IFxcXFxbMC41ZW1dXG4mXFxtYXRocm17UH0oIFhcXGxlcSAke3BhcmFtc19wb2lzWzFdfSkgPSR7cG9pc2NkZi50b1ByZWNpc2lvbig0KX1cblxcZW5ke2FsaWduZWR9XG5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGx0X3BvaXMgPSBQbG90LnBsb3Qoe1xuICAgIGNvbG9yOiB7XG4gICAgICBsZWdlbmQ6IGZhbHNlXG4gICAgfSxcbiAgICB4OiB7XG4gICAgICBsYWJlbDogXCJ4XCIsXG4gICAgICBheGlzOiB0cnVlXG4gICAgfSxcbiAgICB5OiB7XG4gICAgICBsYWJlbDogXCJQKFggPSB4KVwiLFxuICAgICAgYXhpczogdHJ1ZVxuICAgIH0sXG4gIHRvb2x0aXA6IHtcbiAgICBmaWxsOiBcIiMwOTc5NjlcIixcbiAgICBzdHJva2U6IFwiIzA5Nzk2OVwiLFxuICAgIG9wYWNpdHk6IDEsXG4gIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIFBsb3QucnVsZVkoWzBdKSxcbiAgICAgIFBsb3QuYmFyWShwb2lzcGRmLHt4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCIjQzFFMUMxXCIsIHN0cm9rZVdpZHRoOiAwLCBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAoZCkgPT4gYFAoWD0ke2QueH0pID0gJHsoZC5wZGYpLnRvUHJlY2lzaW9uKDQpfWB9KSxcbiAgICAgIFBsb3QuYmFyWShwb2lzcGRmLCB7ZmlsdGVyOiBkID0+IGQueCA8PSBwYXJhbXNfcG9pc1sxXSwgeDogXCJ4XCIsIHk6IFwicGRmXCIsIGZpbGw6IFwiIzUwQzg3OFwiLCBvcGFjaXR5OiAxLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAoZCkgPT4gYFAoWD0ke2QueH0pID0gJHsoZC5wZGYpLnRvUHJlY2lzaW9uKDQpfWB9KVxuICAgIF1cbiAgfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwb2lzcGRmID0ge1xuICBjb25zdCB4ID0gZDMucmFuZ2UoMCwgcGFyYW1zX3BvaXNbMF0gKyA0Kk1hdGguc3FydChwYXJhbXNfcG9pc1swXSksIDEpO1xuICBjb25zdCBkYXRhID0geC5tYXAoeCA9PiAoe3g6IHgsIHBkZjoganN0YXQucG9pc3Nvbi5wZGYoeCwgcGFyYW1zX3BvaXNbMF0pfSkpO1xuICByZXR1cm4gZGF0YVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBvaXNjZGYgPSBqc3RhdC5wb2lzc29uLmNkZihwYXJhbXNfcG9pc1sxXSwgcGFyYW1zX3BvaXNbMF0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwYXJhbXNfYmlub21fcG9pcyA9IElucHV0cy5mb3JtKFtcbiAgICAgIElucHV0cy5yYW5nZShbMSwgMjAwXSwge3ZhbHVlOiAxMCwgc3RlcDogMSwgbGFiZWw6IHRleGBuYH0pLFxuICAgICAgSW5wdXRzLnJhbmdlKFswLjAwMSwgMV0sIHt2YWx1ZTogMC41LCBzdGVwOiAwLjAwMSwgbGFiZWw6IHRleGBcXHBpYH0pLFxuICAgIF0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGt2YW50aWxfYmlub21fcG9pcyA9IElucHV0cy5yYW5nZShbMCwgcGFyYW1zX2Jpbm9tX3BvaXNbMF1dLCB7dmFsdWU6IDMsIHN0ZXA6IDEsIGxhYmVsOiBcInF1YW50aWxlXCJ9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1vbWVudHNfYmlub21fcG9pcyA9IHRleGBcblxcdGV4dHtJZiB9IFggXFxzaW0gXFxvcGVyYXRvcm5hbWV7Qmlub219KCR7cGFyYW1zX2Jpbm9tX3BvaXNbMF19LCR7cGFyYW1zX2Jpbm9tX3BvaXNbMV19KSBcXHRleHR7IHRoZW4gfVxcXFxbMC41ZW1dXG5cblxuRSggWCkgPW4gIFxccGkgPSAkeyhwYXJhbXNfYmlub21fcG9pc1swXSpwYXJhbXNfYmlub21fcG9pc1sxXSkudG9QcmVjaXNpb24oMyl9IFxcXFxbMC41ZW1dXG5WYXIoIFgpID1uICBcXHBpICgxLVxccGkpID0keyhwYXJhbXNfYmlub21fcG9pc1swXSpwYXJhbXNfYmlub21fcG9pc1sxXSooMS1wYXJhbXNfYmlub21fcG9pc1sxXSkpLnRvUHJlY2lzaW9uKDMpfSBcXFxcWzAuNWVtXVxuXG5gXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY2Rmc19wb2lzYXBwcm94ID0gXG57XG4gIHZhciBjZGY7XG4gIGlmIChwb2lzYXBwcm94KXtcbiAgICAgIGNkZiA9IHRleGBcbiAgICAgICAgXFxiZWdpbnthcnJheX17bGx9XG4gICAgICAgIFxcdGV4dHtFeGFjdDp9ICYgUCggWFxcbGVxICR7a3ZhbnRpbF9iaW5vbV9wb2lzfSkgPSR7Ymlub21jZGZfYmlub21fcG9pcy50b1ByZWNpc2lvbigzKX0gXFxcXFswLjI1ZW1dXG4gICAgICAgIFxcdGV4dHtQb2lzc29uIGFwcHJveH0gJiBQKCBYXFxsZXEgJHtrdmFudGlsX2Jpbm9tX3BvaXN9KSA9JHtwb2lzc29uYXBwcm94Y2RmLnRvUHJlY2lzaW9uKDMpfSBcbiAgICAgICAgXFxlbmR7YXJyYXl9XG4gICAgICAgIGBcbiAgfVxuICBlbHNle1xuICAgICAgY2RmID0gdGV4YFxuICAgICAgICBcXGJlZ2lue2FycmF5fXtsbH1cbiAgICAgICAgXFx0ZXh0e0V4YWN0On0gJiBQKCBYXFxsZXEgJHtrdmFudGlsX2Jpbm9tX3BvaXN9KSA9JHtiaW5vbWNkZl9iaW5vbV9wb2lzLnRvUHJlY2lzaW9uKDMpfVxuICAgICAgICBcXGVuZHthcnJheX1cbiAgICAgICAgYCBcbiAgfVxuICByZXR1cm4gY2RmO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwbG90c2VsZWN0b3IgPSBJbnB1dHMuY2hlY2tib3goW1wicG9pc3NvblwiXSwge2xhYmVsOiBcInBsb3QgYXBwcm94aW1hdGlvbjpcIiwgdmFsdWU6IFtcInBvaXNzb24gYXBwcm94aW1hdGlvblwiXX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGx0X3BkZiA9IFBsb3QucGxvdCh7XG4gICAgY29sb3I6IHtcbiAgICAgICAgICBsZWdlbmQ6IHRydWUsXG4gICAgICAgICAgZG9tYWluOiBsZWdlbmRkb21haW4uZmlsdGVyKCAoZCxpKSA9PiBib29sc2VsZWN0W2ldKSxcbiAgICAgICAgICByYW5nZTogbGVnZW5kY29sb3IuZmlsdGVyKCAoZCxpKSA9PiBib29sc2VsZWN0W2ldKVxuICAgICAgICB9LFxuICAgIHg6IHtcbiAgICAgIGxhYmVsOiBcInhcIixcbiAgICAgIGF4aXM6IHRydWUsXG4gICAgICBkb21haW46IHhyYW5nZVxuICAgIH0sXG4gICAgeToge1xuICAgICAgbGFiZWw6IFwiUChYID0geClcIixcbiAgICAgIGRvbWFpbjogWzAsMS4xKmpzdGF0LmJpbm9taWFsLnBkZihwYXJhbXNfYmlub21fcG9pc1swXSpwYXJhbXNfYmlub21fcG9pc1sxXSwgcGFyYW1zX2Jpbm9tX3BvaXNbMF0scGFyYW1zX2Jpbm9tX3BvaXNbMV0pXVxuICAgIH0sXG4gIHRvb2x0aXA6IHtcbiAgICBmaWxsOiBcImIzOTY0MFwiLFxuICAgIHN0cm9rZTogXCJiMzk2NDBcIixcbiAgICBvcGFjaXR5OiAxLFxuICB9LFxuICAgIG1hcmtzOiBbXG4gICAgICBQbG90LnJ1bGVZKFswXSksXG4gICAgICBQbG90LmJhclkoYXBwcm94cGRmLHt4OiBcInhcIiwgeTogXCJiaW5vbXBkZlwiLCBmaWxsIDogXCIjQzFDRkU0XCIsIHN0cm9rZVdpZHRoOiAwLCBvcGFjaXR5OiAwLjgsIFxuICAgICAgICB0aXRsZTogKGQpID0+IGBQKFg9JHtkLnh9KSA9ICR7KGQuYmlub21wZGYpLnRvUHJlY2lzaW9uKDQpfWB9KSxcbiAgICAgIFBsb3QuYmFyWShhcHByb3hwZGYsIHtmaWx0ZXI6IGQgPT4gZC54IDw9IGt2YW50aWxfYmlub21fcG9pcywgeDogXCJ4XCIsIHk6IFwiYmlub21wZGZcIiwgZmlsbDogXCIjOThhZmQyXCIsIG9wYWNpdHk6IDEsXG4gICAgICAgIHRpdGxlOiAoZCkgPT4gYFAoWD0ke2QueH0pID0gJHsoZC5iaW5vbXBkZikudG9QcmVjaXNpb24oNCl9YH0pLFxuICAgICAgXG4gICAgICAvLyBQbG90LmxpbmUoYXBwcm94cGRmLCB7ZmlsdGVyOiBkID0+IG5vcm1hbGFwcHJveCwgeDogXCJ4XCIsIHk6IFwibm9ybWFscGRmXCIsIHN0cm9rZSA6IFwiI0FCOEQ2MVwiLCBzdHJva2VXaWR0aDogM30pLFxuICAgICAgLy8gUGxvdC5kb3QoYXBwcm94cGRmLCB7ZmlsdGVyOiBkID0+IG5vcm1hbGFwcHJveCwgeDogXCJ4XCIsIHk6IFwibm9ybWFscGRmXCIsIHN0cm9rZSA6IFwiI0FCOEQ2MVwiLCBzdHJva2VXaWR0aDogM30pLFxuICAgICAgXG4gICAgICAvLyBQbG90LmxpbmUoYXBwcm94cGRmLCB7ZmlsdGVyOiBkID0+IG5vcm1hbGFwcHJveGNvcnIsIHg6IFwieFwiLCB5OiBcIm5vcm1hbHBkZmNvcnJcIiwgc3Ryb2tlIDogXCIjMDA3ODc4XCIsIHN0cm9rZVdpZHRoOiAzfSksXG4gICAgICAvLyBQbG90LmRvdChhcHByb3hwZGYsIHtmaWx0ZXI6IGQgPT4gbm9ybWFsYXBwcm94Y29yciwgeDogXCJ4XCIsIHk6IFwibm9ybWFscGRmY29yclwiLCBzdHJva2UgOiBcIiMwMDc4NzhcIiwgc3Ryb2tlV2lkdGg6IDN9KSxcbiAgICAgIFxuICAgICAgUGxvdC5ydWxlWChhcHByb3hwZGYsIHtmaWx0ZXI6IGQgPT4gcG9pc2FwcHJveCAmJiBkLnggPj0gMCwgeDogXCJ4XCIsIHk6IFwicG9pc3NvbnBkZlwiLCBzdHJva2U6IFwiIzc4MDAwMFwiLCBzdHJva2VXaWR0aDogMn0pLCAgXG4gICAgICBQbG90LmRvdChhcHByb3hwZGYsIHtmaWx0ZXI6IGQgPT4gcG9pc2FwcHJveCAmJiBkLnggPj0gMCwgeDogXCJ4XCIsIHk6IFwicG9pc3NvbnBkZlwiLCBmaWxsOiBcIiM3ODAwMDBcIiwgcjogNX0pLFxuICAgIF1cbiAgfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhcHByb3hwZGYgPSB7XG4gIGNvbnN0IHggPSB4cmFuZ2U7XG4gIGNvbnN0IGFwcHJveHBkZiA9IHgubWFwKHggPT4gKHtcbiAgICB4OiB4LCBcbiAgICBiaW5vbXBkZjoganN0YXQuYmlub21pYWwucGRmKHgsIHBhcmFtc19iaW5vbV9wb2lzWzBdLCBwYXJhbXNfYmlub21fcG9pc1sxXSksXG4gICAgLy8gbm9ybWFscGRmOiBqc3RhdC5ub3JtYWwucGRmKHgsIHBhcmFtc1swXSpwYXJhbXNbMV0sIE1hdGguc3FydChwYXJhbXNbMF0qcGFyYW1zWzFdKigxLXBhcmFtc1sxXSkpKSwgXG4gICAgLy8gbm9ybWFscGRmY29ycjoganN0YXQubm9ybWFsLnBkZih4ICsgMC41LCBwYXJhbXNbMF0qcGFyYW1zWzFdLCBNYXRoLnNxcnQocGFyYW1zWzBdKnBhcmFtc1sxXSooMS1wYXJhbXNbMV0pKSksXG4gICAgcG9pc3NvbnBkZjoganN0YXQucG9pc3Nvbi5wZGYoeCwgcGFyYW1zX2Jpbm9tX3BvaXNbMF0qcGFyYW1zX2Jpbm9tX3BvaXNbMV0pXG4gIH0pKTtcbiAgcmV0dXJuIGFwcHJveHBkZlxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InhyYW5nZSA9IGQzLnJhbmdlKDAsIGhpZ2ggKyAxLCAxKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJoaWdoID0gTWF0aC5jZWlsKGpzdGF0Lm5vcm1hbC5pbnYoMC45OTk5LCBwYXJhbXNfYmlub21fcG9pc1swXSpwYXJhbXNfYmlub21fcG9pc1sxXSwgTWF0aC5zcXJ0KHBhcmFtc19iaW5vbV9wb2lzWzBdKnBhcmFtc19iaW5vbV9wb2lzWzFdKigxLXBhcmFtc19iaW5vbV9wb2lzWzFdKSkpKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImxlZ2VuZGNvbG9yID0gW1wiI0MxQ0ZFNFwiLCBcIiNBQjhENjFcIiwgXCIjMDA3ODc4XCIsIFwiIzc4MDAwMFwiXVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJvb2xzZWxlY3QgPSBbdHJ1ZSwgcG9pc2FwcHJveF1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwb2lzYXBwcm94ID0gcGxvdHNlbGVjdG9yLmluY2x1ZGVzKFwicG9pc3NvblwiKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImxlZ2VuZGRvbWFpbiA9IFtcImJpbm9taWFsXCIsIFwicG9pc3NvblwiXVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBvaXNzb25hcHByb3hjZGYgPSBqc3RhdC5wb2lzc29uLmNkZihrdmFudGlsX2Jpbm9tX3BvaXMsIHBhcmFtc19iaW5vbV9wb2lzWzBdKnBhcmFtc19iaW5vbV9wb2lzWzFdKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJpbm9tY2RmX2Jpbm9tX3BvaXMgPSBqc3RhdC5iaW5vbWlhbC5jZGYoa3ZhbnRpbF9iaW5vbV9wb2lzLCBwYXJhbXNfYmlub21fcG9pc1swXSwgcGFyYW1zX2Jpbm9tX3BvaXNbMV0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwYXJhbXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgna3ZhbnRpbCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhcHByb3gnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncGFyYW1zX3BvaXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncGFyYW1zX2Jpbm9tX3BvaXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgna3ZhbnRpbF9iaW5vbV9wb2lzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Bsb3RzZWxlY3RvcicpIn1dfQ==
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./prob-rv.html" class="pagination-link" aria-label="Random Variables">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Random Variables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./prob-cont.html" class="pagination-link" aria-label="Continuous Probability Distributions">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/prob-disc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/chenghanyustats/introstatsbook">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>