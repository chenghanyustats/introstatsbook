<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.7">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An introductory statistical data science book for STEM students.">
<title>16&nbsp; Hypothesis Testing ‚Äì Introduction to Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infer-twomean.html" rel="next">
<link href="./infer-bt.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-91e0721f6a50cd2c1d42ea2de0943486.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-288caa2835e8f3ae9b218c52903e6099.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-d93f0da6b6e6724898f2795888d050da.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-5142df6085ee636785797f8402c7d873.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-ht.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introduction-to-Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ready fo<em>R</em> data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-py.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><em>P</em>repare <em>Y</em>ourself for data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability Rules and Bayes Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Random Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-multicomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Multiple Comparison*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-r_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-py_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python Programming</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">16.1</span> Introduction</a></li>
  <li><a href="#how-to-formally-do-a-statistical-hypothesis-testing" id="toc-how-to-formally-do-a-statistical-hypothesis-testing" class="nav-link" data-scroll-target="#how-to-formally-do-a-statistical-hypothesis-testing"><span class="header-section-number">16.2</span> How to Formally Do a Statistical Hypothesis Testing</a></li>
  <li><a href="#sec-ex-two-tailed" id="toc-sec-ex-two-tailed" class="nav-link" data-scroll-target="#sec-ex-two-tailed"><span class="header-section-number">16.3</span> Example: Two-tailed z-test</a></li>
  <li><a href="#testing-summary" id="toc-testing-summary" class="nav-link" data-scroll-target="#testing-summary"><span class="header-section-number">16.4</span> Testing Summary</a></li>
  <li><a href="#type-i-and-type-ii-errors" id="toc-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#type-i-and-type-ii-errors"><span class="header-section-number">16.5</span> Type I and Type II Errors</a></li>
  <li>
<a href="#statistical-power-and-choosing-sample-size" id="toc-statistical-power-and-choosing-sample-size" class="nav-link" data-scroll-target="#statistical-power-and-choosing-sample-size"><span class="header-section-number">16.6</span> Statistical Power and Choosing Sample Size*</a>
  <ul class="collapse">
<li><a href="#power-of-a-hypothesis-test" id="toc-power-of-a-hypothesis-test" class="nav-link" data-scroll-target="#power-of-a-hypothesis-test"><span class="header-section-number">16.6.1</span> Power of a Hypothesis Test</a></li>
  <li><a href="#power-calculation" id="toc-power-calculation" class="nav-link" data-scroll-target="#power-calculation"><span class="header-section-number">16.6.2</span> Power Calculation</a></li>
  <li><a href="#power-analysis" id="toc-power-analysis" class="nav-link" data-scroll-target="#power-analysis"><span class="header-section-number">16.6.3</span> Power Analysis</a></li>
  </ul>
</li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">16.7</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-ht.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-ht.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-infer-ht" class="quarto-section-identifier"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>We finished the discussion of estimation, interval estimation in particular in the previous chapter. The other part of statistical inference is <strong>hypothesis testing</strong>. In this chapter, we first discuss the meaning a hypothesis in statistical analysis, followed by the testing procedures for population mean <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\sigma\)</span> is known and when <span class="math inline">\(\sigma\)</span> is unknown. Pay attention to similarity and difference of estimation and testing.</p>
<section id="introduction" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">16.1</span> Introduction</h2>
<p><span style="color:blue"> <strong>What is Hypothesis Testing?</strong> </span></p>
<p>In statistics, a <strong>hypothesis</strong> is a claim or statement about a <em>property of a population</em>, often the value of a population distribution parameter. For example,</p>
<ul>
<li><p><span style="color:blue"> The mean body temperature of humans is less than <span class="math inline">\(98.6^{\circ}\)</span> F. </span> Here the mean body temperature is a property or characteristic of target population human beings. We can turn the verbal claim into a brief mathematical expression <span class="math inline">\(\mu &lt; 98.6\)</span>.</p></li>
<li><p><span style="color:blue"> Marquette students‚Äô IQ scores has standard deviation equal to 15. </span> The IQ score standard deviation is a characteristic of the population Marquette students. Mathematically, we can write the claim as <span class="math inline">\(\sigma = 15\)</span>.</p></li>
</ul>
<p>You can see that we usually focus on claims about a population distribution parameter. <!-- - A **hypothesis testing** <sup>1</sup> is a procedure for testing a hypothesis. --></p>
<p>The <strong>null hypothesis</strong>, denoted <span class="math inline">\(H_0\)</span>, is a statement that the value of a parameter is <em>equal</em> to some claim value, or the <em>negation</em> of the <strong>alternative hypothesis</strong> that will be discussed in a minute. Often <span class="math inline">\(H_0\)</span> represents a skeptical perspective or a claim to be tested, or the current status of the parameter. For example, the claim <em>‚Äúthe percentage of Marquette female students loving Japanese food is equal to 80%‚Äù</em> is a <span class="math inline">\(H_0\)</span> claim because of the key word ‚Äúequal‚Äù. Usually we are not very convinced that the <span class="math inline">\(H_0\)</span> claim is true, and in our analysis we want to <em>test</em> the claim, and see whether the evidence and information we collect is strong enough to make a conclusion that the percentage is not equal to 80%.</p>
<p>The <strong>alternative hypothesis</strong>, denoted <span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_a\)</span>, is a claim that the parameter is <strong>less than</strong>, <strong>greater than</strong> or <strong>not equal</strong> to some value. It is usually our <strong>research hypothesis</strong> of some new scientific theory or finding. If we think the percentage of Marquette female students loving Japanese food is greater than 80%, this hypothesis is the <span class="math inline">\(H_1\)</span> claim. If after a formal testing procedure, we conclude that the percentage is greater than 80%, we sort of make a new research discovery that overturns the previous claim or status quo that the percentage is equal to 80%.</p>
<p>Let‚Äôs do one more exercise. Is the statement <em>‚ÄúOn average, Marquette students consume less than 3 drinks per week.‚Äù</em> a <span class="math inline">\(H_0\)</span> or <span class="math inline">\(H_1\)</span> claim? Because of the key word ‚Äúless than‚Äù, it is a <span class="math inline">\(H_1\)</span> claim.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## Are these $H_0$ or $H_1$ claims? -->
<!-- - <span style="color:blue"> The percentage of Marquette female students loving Japanese food is **equal** to 80%.</span> -->
<!-- - <span style="color:blue"> On average, Marquette students consume **less than** 3 drinks per week. </span> -->
<!-- ::: -->
<p>So what is <strong>hypothesis testing</strong>? <strong>Hypothesis testing</strong> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is a procedure to <strong>decide whether or not to reject <span class="math inline">\(H_0\)</span></strong> based on how much evidence there is against <span class="math inline">\(H_0\)</span>. If the evidence is strong enough, we <em>reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span></em>.</p>
<hr>
<p><span style="color:blue"> <strong>Example</strong> </span></p>
<p>Before we jump into the formal hypothesis testing procedure, let‚Äôs talk about a criminal charge example. How a criminal is convicted is similar to the formal testing procedure.</p>
<div class="columns">
<div class="column" style="width:90%;">
<p><em>Suppose a person is charged with a crime, and a jury will decide whether the person is guilty or not. We all know the rule: Even though the person is charged with the crime, at the beginning of the trial, the accuse is assumed to be innocent until the jury declares otherwise. Only if overwhelming evidence of the person‚Äôs guilt can be shown is the jury expected to declare the person guilty, otherwise the person is considered not guilty.</em></p>
</div><div class="column" style="width:10%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/law.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1353"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>If we want to make a claim about whether the person is guilty or not, what are our <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>? Remember that the null hypothesis represents a skeptical perspective or a claim to be tested, or the current status of the parameter, so we have</p>
<ul>
<li>
<span class="math inline">\(H_0:\)</span> The person is <span style="color:blue"> not guilty </span> üôÇ</li>
</ul>
<p>This is how we write a hypothesis: start with <span class="math inline">\(H_0:\)</span> followed by the statement. Being not guilty is the default status quo of anyone, although the jury may doubt or be skeptical of the person being not guilty. The prosecutors and police detectives are trying their best the collect enough strong evidence to proof beyond a reasonable doubt to the jury. Therefore the alternative hypothesis is</p>
<ul>
<li>
<span class="math inline">\(H_1:\)</span> The person is <span style="color:blue"> guilty </span> üòü</li>
</ul>
<p>In the example, the <strong>evidence</strong> could be <span style="color:blue"> photos, videos, witnesses, fingerprints, DNA, and so on </span>. How do we decide to keep <span class="math inline">\(H_0\)</span> or to accept <span class="math inline">\(H_1\)</span>? After all evidence including defense attorney and prosecutor‚Äôs arguments are presented to the jury, the <strong>decision rule</strong> is the <span style="color:blue"> jury‚Äôs voting </span>. Finally, to close the case, we need a <strong>conclusion</strong> that is the verdict <span style="color:blue"> ‚Äúguilty‚Äù </span> or <span style="color:blue"> ‚ÄúNot enough evidence to convict‚Äù </span>.</p>
<p>Please go through the entire criminal charge process again:</p>
<p><span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_a\)</span> =&gt; Evidence =&gt; Decision rule =&gt; Conclusion</p>
<p>The process is quite similar to the formal procedure for a hypothesis testing.</p>
</section><section id="how-to-formally-do-a-statistical-hypothesis-testing" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="how-to-formally-do-a-statistical-hypothesis-testing">
<span class="header-section-number">16.2</span> How to Formally Do a Statistical Hypothesis Testing</h2>
<p>The entire hypothesis testing can be wrapped up in the following six steps. No worries if you don‚Äôt have any idea of it. We will learn this step by step using a test for the population mean <span class="math inline">\(\mu\)</span>.</p>
<ul>
<li><p><strong>Step 0: Check Method Assumptions</strong></p></li>
<li><p><strong>Step 1: Set the <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_a\)</span> in Symbolic Form from a Claim</strong></p></li>
<li><p><strong>Step 2: Set the Significance Level <span class="math inline">\(\alpha\)</span></strong></p></li>
<li><p><strong>Step 3: Calculate the Test Statistic</strong> (Evidence)</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Decision Rule I: Critical Value Method</strong></p>
<ul>
<li><p><span style="color:blue"> <strong>Step 4-c: Find the Critical Value</strong> </span></p></li>
<li><p><span style="color:blue"> <strong>Step 5-c: Draw a Conclusion Using Critical Value Method</strong> </span></p></li>
</ul>
</div><div class="column" data-widht="50%">
<p><strong>Decision Rule II: P-Value Method</strong></p>
<ul>
<li><p><span style="color:red"> <strong>Step 4-p: Find the P-Value</strong> </span></p></li>
<li><p><span style="color:red"> <strong>Step 5-p: Draw a Conclusion Using P-Value Method</strong> </span></p></li>
</ul>
</div>
</div>
<ul>
<li><strong>Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim</strong></li>
</ul>
<p>Let‚Äôs look at this example: Is the New Treatment Effective?</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>A population of patients with hypertension is normal and has mean blood pressure (BP) of 150. After 6 months of treatment, the BP of 25 patients from this population was recorded. The sample mean BP is <span class="math inline">\(\overline{x} = 147.2\)</span> and the sample standard deviation is <span class="math inline">\(s = 5.5\)</span>.</p>
</div><div class="column" style="width:40%;">
<div class="tiny">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/blood_pressure.jpeg" class="img-fluid figure-img" width="2360"></p>
<figcaption>Source: https://unsplash.com/photos/i1iqQRLULlg</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Our goal is to determine whether a new treatment is effective in reducing BP. Let‚Äôs learn the testing procedure step by step using this example.</p>
<!-- - üòé We will learn this step by step! -->
<hr>
<p><span style="color:blue"> <strong>Step 0: Check Method Assumptions</strong> </span></p>
<p>Any statistical method is based on some assumptions. To use the method, and analyze our data appropriately, we have to make sure that the assumptions are satisfied. In this book, most of the distribution-based methods require</p>
<ul>
<li><p>Random sample</p></li>
<li><p>The population is normally distributed and/or the sample size <span class="math inline">\(n &gt; 30\)</span>.</p></li>
</ul>
<!-- - The testing methods are based on normality or approximate normality by CLT. --><div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/normal_dist.jpeg" class="img-fluid figure-img" width="237"></p>
<figcaption>Source: https://www.pinterest.ph/pin/633387417082544/</figcaption></figure>
</div>
</div>
</div>
<!-- <span style="color:blue"> **Step-by-Step** </span> -->
<p><span style="color:red"> <strong><em>Example Step 0: Check Method Assumptions</em></strong> </span></p>
<ul>
<li>From the question description, <span style="color:blue"> A population of hypertension group is <strong>normal</strong> </span>.</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Step 1: Set the <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> from a Claim</strong> </span></p>
<p>The first step of testing is to understand the <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> claims, and express them using mathematically using population parameters. The followings provdie three examples.</p>
<ul>
<li>üßë‚Äçüè´ The <em>mean</em> IQ score of statistics professors is <strong>higher than</strong> 120.
<ul>
<li><span style="color:blue"> <span class="math inline">\(\begin{align}&amp;H_0: \mu \le 120 \\ &amp;H_1: \mu &gt; 120 \end{align}\)</span> </span></li>
</ul>
</li>
<li>üíµ The <em>mean</em> starting salary for Marquette graduates who didn‚Äôt take MATH 4720 is <strong>less than</strong> $60,000.
<ul>
<li><span style="color:blue"> <span class="math inline">\(\begin{align} &amp;H_0: \mu \ge 60000 \\ &amp;H_1: \mu &lt; 60000 \end{align}\)</span> </span></li>
</ul>
</li>
<li>üì∫ The <em>mean</em> time between uses of a TV remote control by males during commercials <strong>equals</strong> 5 sec.&nbsp;
<ul>
<li><span style="color:blue"> <span class="math inline">\(\begin{align} &amp;H_0: \mu = 5 \\ &amp;H_1: \mu \ne 5 \end{align}\)</span> </span></li>
</ul>
</li>
</ul>
<p>Keep in mind that the equality sign is always put in <span class="math inline">\(H_0\)</span>, and <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> are mutually exclusive. Also, the claims are for population parameters, not sample statistics. We are not sure the value of the parameter being tested, but we want to collect evidence, and see which claim about the parameter is supported by the evidence.</p>
<p><span style="color:red"> <strong><em>Example Step 1: Set the <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> from a Claim</em></strong> </span></p>
<p>The claim that <em>the new treatment is effective in reducing BP</em> means the <em>mean BP is less than 150</em>, which is an <span class="math inline">\(H_1\)</span> claim. So we can write our <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> as</p>
<p><span style="color:blue"> <span class="math inline">\(\small \begin{align} &amp;H_0: \mu = 150 \\ &amp;H_1: \mu &lt; 150 \end{align}\)</span> </span></p>
<p>where <span class="math inline">\(\mu\)</span> is the mean blood pressure.</p>
<hr>
<p><span style="color:blue"> <strong>Step 2: Set the Significance Level <span class="math inline">\(\alpha\)</span></strong> </span></p>
<p>Next, we set the <strong>significance level</strong> <span class="math inline">\(\alpha\)</span> that determines <em>how rare or unlikely our evidence must be</em> in order to represent sufficient evidence against <span class="math inline">\(H_0\)</span>. It tells us how strong the collected evidence must be in order to overturn the current claim. An <span class="math inline">\(\alpha\)</span> level of 0.05 implies that evidence occurring with probability lower than 5% will be considered sufficient evidence to reject <span class="math inline">\(H_0\)</span>. Mathematically, <span class="math display">\[\alpha = P(\text{Reject } H_0 \mid H_0 \text{ is true})\]</span> As a result, <span class="math inline">\(\alpha = 0.05\)</span> means that we <strong>incorrectly reject <span class="math inline">\(H_0\)</span> 5 out of every 100 times</strong> we collect a sample and run the test.</p>
<p>Here is the idea. When we want to see if what we care about (the population parameter) is not as described as in the null hypothesis <span class="math inline">\(H_0\)</span>, we first assume or believe <span class="math inline">\(H_0\)</span> is right, then based on this, we see if there is sufficient and strong evidence to conclude that it is probably not the case, and find the alternative hypothesis more reasonable.</p>
<p>Let‚Äôs explain <span class="math inline">\(\alpha\)</span> by an example. Suppose we would like to test the claim that <em>‚ÄúThe mean IQ of statistics professors is greater than 120.‚Äù</em> Or in short <span class="math inline">\(H_0: \mu = 120\)</span> vs.&nbsp;<span class="math inline">\(H_1: \mu &gt; 120\)</span>. With large sample size, we can assume <span class="math inline">\(\overline{X}\)</span> follows a normal distribution. Now, to test whether the mean IQ is greater than 120, we need to first treat the mean not being greater than 120 unless later we have sufficient evidence to say it is greater than 120. In particular, we need to do the test and analysis on the basis that the mean is under <span class="math inline">\(H_0\)</span>. That is, we first assume the mean is 120, or <span class="math inline">\(\mu = 120\)</span>, then see if the assumption really makes sense.</p>
<p>Because <span class="math inline">\(\overline{X}\)</span> is normal, we do the test under the assumption that <span class="math inline">\(\overline{X} \sim N(120, \sigma^2)\)</span> for some <span class="math inline">\(\sigma^2\)</span>, say <span class="math inline">\(9\)</span>. (Let‚Äôs focus on <span class="math inline">\(\mu\)</span> and ignore <span class="math inline">\(\sigma\)</span> at this moment). If <span class="math inline">\(\overline{X}\)</span> has mean 120, and from our sample data we got the sample mean <span class="math inline">\(\overline{x} = 121\)</span>, do you think the claim <span class="math inline">\(H_0: \mu = 120\)</span> make sense? How about you got <span class="math inline">\(\overline{x} = 127\)</span>? Now <span class="math inline">\(\alpha\)</span> comes into play. Let me ask you a question. What is the threshold or value of the sample mean <span class="math inline">\(\overline{x}\)</span> that you think it is too large to believe that <span class="math inline">\(H_0: \mu = 120\)</span> is a reasonable assumption or data generating mechanism? What is the threshold that makes you start to believe that <span class="math inline">\(H_1: \mu &gt; 120\)</span> makes more sense than <span class="math inline">\(H_0: \mu = 120\)</span>? The significance level <span class="math inline">\(\alpha\)</span> is such threshold value. With <span class="math inline">\(\alpha\)</span> being specified, we know what is the corresponding sample mean threshold <span class="math inline">\(\overline{x}^*\)</span>, which is the one such that <span class="math inline">\(P(\overline{X} &gt; \overline{x}^*) = \alpha\)</span>.</p>
<p><a href="#fig-set-alpha" class="quarto-xref">Figure&nbsp;<span>16.1</span></a> illustrates the significance level <span class="math inline">\(\alpha\)</span>. Once we decide <span class="math inline">\(\alpha\)</span>, we determines how rare or unlikely our sample mean <span class="math inline">\(\overline{x}\)</span> must be in order to represent sufficient evidence against <span class="math inline">\(H_0: \mu = 120\)</span>. In this example, if our <span class="math inline">\(\overline{x}\)</span> is greater than 125, we would think the evidence is strong enough to conclude that <span class="math inline">\(\mu = 120\)</span> is not so reasonable because the chance of such value happening is no larger than <span class="math inline">\(\alpha\)</span>. We instead think <span class="math inline">\(H_1: \mu &gt; 120\)</span> makes more sense.</p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-set-alpha" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-set-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-ht_files/figure-html/fig-set-alpha-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-set-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Illustration of significance level, alpha.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<p>The entire rationale is the rare event rule.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>Rare Event Rule</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>If, under a given assumption, the probability of a particular observed event is exceptionally small, we conclude that the assumption is probably not correct.</p>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p>The level <span class="math inline">\(\alpha\)</span> is related to the <span class="math inline">\(\alpha\)</span> used in confidence intervals for defining a ‚Äúcritical value‚Äù.</p>
<p><span style="color:red"> <strong><em>Example Step 2: Set the Significance Level <span class="math inline">\(\alpha\)</span></em></strong> </span></p>
<p>There is no <span class="math inline">\(\alpha\)</span> mentioned in the question description. Usually <span class="math inline">\(\alpha\)</span> is set by researchers themselves. Let‚Äôs set <span class="math inline">\(\alpha= 0.05\)</span>. This means we are asking, ‚Äú<em>Is there a sufficient evidence at <span class="math inline">\(\alpha= 0.05\)</span> that the new treatment is effective?</em>‚Äù</p>
<hr>
<p><span style="color:blue"> <strong>Step 3: Calculate the Test Statistic</strong> </span></p>
<p>Setting <span class="math inline">\(\alpha\)</span> is kind of setting the threshold for determining whether our collected evidence is sufficient or strong enough or not. In this step, we are collecting our evidence. The evidence is collected from the information we have, which is the sample data. Sample data is the only source we have for the inference about the unknown parameter. So to do a test about the parameter, or decide whether a statement about the parameter makes sense, we let the data and evidence speak up.</p>
<p>The evidence used in the hypothesis testing is called <strong>test statistic</strong>: a sample statistic value used in making a decision about the <span class="math inline">\(H_0\)</span>. Suppose <span style="color:blue"> the test we are interested is <span class="math inline">\(H_0: \mu = \mu_0\)</span> and <span class="math inline">\(\quad H_1: \mu &lt; \mu_0\)</span> </span> where <span class="math inline">\(\mu_0\)</span> is some population mean value that could be 150 lbs, 175 cm, 50 ounces, etc. When computing a test statistic, we assume <span class="math inline">\(H_0\)</span> is <em>true</em>. Remember, we are trying to see if there is any strong evidence that is against <span class="math inline">\(H_0\)</span>. We should do our analysis in the world of <span class="math inline">\(H_0\)</span> or the status quo. If the evidence is not sufficient, we stay in our current situation.</p>
<p>When <span class="math inline">\(\sigma\)</span> is <strong>known</strong>, the test statistic for testings about <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[\boxed{ z_{test} = \frac{\overline{x} - \color{blue}{\mu_0}}{\sigma/\sqrt{n}} }\]</span></p>
<p>When <span class="math inline">\(\sigma\)</span> is <strong>unknown</strong>, the test statistic for testings about <span class="math inline">\(\mu\)</span> is</p>
<p><span class="math display">\[\boxed{ t_{test} = \frac{\overline{x} - \color{blue}{\mu_0}}{s/\sqrt{n}} }\]</span></p>
<p>Familiar with them? Those are <span class="math inline">\(z\)</span> score and <span class="math inline">\(t\)</span> score. Those are the sample statistics used for testing. When we calculate the test statistics, we need the value of <span class="math inline">\(\mu\)</span>. What value we should use? You are right if you use the value assumed in <span class="math inline">\(H_0\)</span>! The test statistics are the evidence we use in testing. The evidence is collected under the assumption that <span class="math inline">\(\mu = \mu_0\)</span>. We collect any evidence to prove that a suspect committed a crime under the assumption that he is innocent, right? We shouldn‚Äôt look at any person through colored spectacles, or frame anyone by treating someone as criminal, then make up a fake story for what he‚Äôs never done.</p>
<p><span style="color:red"> <strong><em>Example Step 3: Calculate the Test Statistic</em></strong> </span></p>
<p>Since we don‚Äôt know the true <span class="math inline">\(\sigma\)</span>, and only know <span class="math inline">\(s\)</span>, we use <span class="math inline">\(t\)</span> distribution and the test statistic is <span style="color:blue"> <span class="math display">\[\small t_{test} = \frac{\overline{x} - \mu_0}{s/\sqrt{n}} =  \frac{147.2 - 150}{5.5/\sqrt{25}} = -2.55.\]</span> </span> So if the true mean blood pressure is 150, our test statistic or evidence is about 2.55 standard deviations below the mean. Is this number too weird or uncommon to believe that the mean blood pressure is really 150? We need a decision rule, and that is what we are going to learn in the step 4.</p>
<hr>
<p><span style="color:blue"> <strong>Step 4-c: Find the Critical Value</strong> </span></p>
<p>In this step, we set the decision rule. There are two methods in testing, the critical-value method and the p-value method. The two methods are equivalent, leading to the same decision and conclusion. Let‚Äôs first talk about the critical-value method.</p>
<p>In step 2, we set the <span class="math inline">\(\alpha\)</span>, and in step 3, we collect the evidence. Now we need a way to decide whether the collected evidence is sufficient or not to reject the <span class="math inline">\(H_0\)</span> claim. The <strong>critical value(s)</strong> is a value determined by the significance level <span class="math inline">\(\alpha\)</span> that separates the <strong>rejection region</strong> or <strong>critical region</strong>, where we reject <span class="math inline">\(H_0\)</span>, from the values of the test statistic that do not lead to the rejection of <span class="math inline">\(H_0\)</span>.</p>
<!-- - The **critical value(s)**  -->
<p>Which critical value to be used depends on whether our test is a <strong>right-tailed</strong>, <strong>left-tailed</strong> or <strong>two-tailed</strong>. The right-tailed test, or right-sided test is the test with <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span>. When we are interested of <span class="math inline">\(\mu\)</span> is greater than some value, say <span class="math inline">\(\mu_0\)</span>, in the sampling distribution, we will focus on the right hand side of the distribution, because the evidence, the test statistic calculated in the step 3, will usually be on the right hand side of the distribution, so is the critical value used in the decision rule. Similarly, The left-tailed test, or left-sided test is the test with <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>. For a two-tailed or two-sided test, we have <span class="math inline">\(H_1: \mu \ne \mu_0\)</span>. In this case, we wonder <span class="math inline">\(\mu\)</span> is larger or smaller than the assumed <span class="math inline">\(\mu_0\)</span>. So we need to pay attention to both sides of the sampling distribution.</p>
<p><a href="#fig-tail-type" class="quarto-xref">Figure&nbsp;<span>16.2</span></a> illustrates rejection regions for the different types of hypothesis tests. Let‚Äôs assume <span class="math inline">\(\sigma\)</span> is known as the unknown <span class="math inline">\(\sigma\)</span> case is similar and we just replace the <span class="math inline">\(z\)</span> score with the <span class="math inline">\(t\)</span> score. Given the significance level <span class="math inline">\(\alpha\)</span>, for a right-tailed test, the critical value is <span class="math inline">\(z_{\alpha}\)</span>, the standard normal quantile so that <span class="math inline">\(P(Z &gt; z_{\alpha}) = \alpha\)</span>, where <span class="math inline">\(Z \sim N(0, 1)\)</span>. For a right-tailed test, the critical value is <span class="math inline">\(-z_{\alpha}\)</span>, or in fact <span class="math inline">\(z_{1-\alpha}\)</span>, the standard normal quantile so that <span class="math inline">\(P(Z &lt; -z_{\alpha}) = \alpha\)</span> or <span class="math inline">\(P(Z &gt; -z_{\alpha}) = 1-\alpha\)</span>. When the test is a two-tailed test, there are two critical values, one at the right-hand side, the other at the left-hand side of the distribution. Here, we need to split <span class="math inline">\(\alpha\)</span> equally into <span class="math inline">\(\alpha/2\)</span>, and the critical value at the right-hand side is <span class="math inline">\(z_{\alpha/2}\)</span> such that <span class="math inline">\(P(Z &gt; z_{\alpha/2}) = \alpha\)</span> and the critical value at the left-hand side is <span class="math inline">\(-z_{\alpha/2}\)</span> such that <span class="math inline">\(P(Z &lt; -z_{\alpha/2}) = \alpha/2\)</span>. Note that by definition, <span class="math inline">\(z_{\alpha}\)</span> and <span class="math inline">\(t_{\alpha, n-1}\)</span> are <em>always positive</em> and on the right hand side of the distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tail-type" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-tail-type-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/test_type.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tail-type-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: Rejection regions for the different types of hypothesis tests. Source: https://towardsdatascience.com/everything-you-need-to-know-about-hypothesis-testing-part-i-4de9abebbc8a
</figcaption></figure>
</div>
</div>
</div>
<!-- - $z_{\alpha}$ is such that $P(Z > z_{\alpha}) = \alpha$ and $Z \sim N(0, 1)$. -->
<!-- - $t_{\alpha, n-1}$ is such that $P(T > t_{\alpha, n-1}) = \alpha$ and $T \sim t_{n-1}$. -->
<p>The following table is the summary of the critical values under different cases. When <span class="math inline">\(\sigma\)</span> is known, we use <span class="math inline">\(z\)</span> scores, and when <span class="math inline">\(\sigma\)</span> is unknown, we use <span class="math inline">\(t\)</span> scores.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Condition &nbsp; &nbsp;</th>
<th style="text-align: center;">
<strong>Right</strong>-tailed <span class="math inline">\((H_1: \mu &gt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Left</strong>-tailed <span class="math inline">\((H_1: \mu &lt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Two-tailed</strong> <span class="math inline">\((H_1: \mu \ne \mu_0)\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> known</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-z_{\alpha}\)</span></td>
<td style="text-align: center;">
<span class="math inline">\(-z_{\alpha/2}\)</span> and <span class="math inline">\(z_{\alpha/2}\)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> unknown</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha, n-1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-t_{\alpha, n-1}\)</span></td>
<td style="text-align: center;">
<span class="math inline">\(-t_{\alpha/2, n-1}\)</span> and <span class="math inline">\(t_{\alpha/2, n-1}\)</span>
</td>
</tr>
</tbody>
</table>
<!-- - $z_{0.025} =$ 1.96, $z_{0.05} =$ 1.64 --><!-- - $z_{\alpha}$ and $t_{\alpha, n-1}$ are *always positive*. --><p><span style="color:red"> <strong><em>Example Step 4-c: Find the Critical Value</em></strong> </span></p>
<p>Since the test is a left-tailed test, and <span class="math inline">\(\sigma\)</span> is unknown and <span class="math inline">\(n = 25\)</span>, the critical value is <span class="math inline">\(-t_{\alpha, n-1}\)</span> that is <span style="color:blue"> <span class="math inline">\(\small -t_{0.05, 25-1} = -t_{0.05, 24} = -1.711.\)</span> </span></p>
<hr>
<p><span style="color:blue"> <strong>Step 5-c: Draw a Conclusion Using Critical Value</strong> </span></p>
<p>The critical value separates the the standard normal values into the rejection region and non-rejection region. For a right-tailed test, the rejection region is any <span class="math inline">\(z\)</span> value greater than <span class="math inline">\(z_{\alpha}\)</span>, and the non-rejection region is any <span class="math inline">\(z\)</span> value smaller than or equal to <span class="math inline">\(z_{\alpha}\)</span>. For a left-tailed test, the rejection region is any <span class="math inline">\(z\)</span> value small than <span class="math inline">\(-z_{\alpha}\)</span>, and the non-rejection region is any <span class="math inline">\(z\)</span> value greater than or equal to <span class="math inline">\(-z_{\alpha}\)</span>. For a two-tailed test, the rejection region is the union of any <span class="math inline">\(z\)</span> value smaller than <span class="math inline">\(-z_{\alpha/2}\)</span> and any <span class="math inline">\(z\)</span> value greater than <span class="math inline">\(z_{\alpha/2}\)</span>.</p>
<p>If the test statistic <span class="math inline">\(z_{test}\)</span> is in the rejection region, we reject <span class="math inline">\(H_0\)</span>. If <span class="math inline">\(z_{test}\)</span> is <em>not</em> in the rejection region, we <em>do not</em> or <em>fail to</em> reject <span class="math inline">\(H_0\)</span>. <a href="#fig-rejection-region" class="quarto-xref">Figure&nbsp;<span>16.3</span></a> is an example that we reject <span class="math inline">\(H_0\)</span> in a right-tailed test. The test statistic is 2.5 which is greater than the critical value 1.645, so the test statistic falls in the rejection region.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rejection-region" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-rejection-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/rejection_region.gif" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rejection-region-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: Test statistic inside of critical region. Source: https://www.thoughtco.com/example-of-a-hypothesis-test-3126398
</figcaption></figure>
</div>
</div>
</div>
<p>The rejection region for any type of tests is shown in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Condition &nbsp; &nbsp;</th>
<th style="text-align: center;">
<strong>Right</strong>-tailed <span class="math inline">\((H_1: \mu &gt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Left</strong>-tailed <span class="math inline">\((H_1: \mu &lt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Two-tailed</strong> <span class="math inline">\((H_1: \mu \ne \mu_0)\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> known</td>
<td style="text-align: center;"><span class="math inline">\(z_{test} &gt; z_{\alpha}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(z_{test} &lt; -z_{\alpha}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mid z_{test}\mid \, &gt; z_{\alpha/2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> unknown</td>
<td style="text-align: center;"><span class="math inline">\(t_{test} &gt; t_{\alpha, n-1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_{test} &lt; -t_{\alpha, n-1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mid t_{test}\mid \, &gt; t_{\alpha/2, n-1}\)</span></td>
</tr>
</tbody>
</table>
<p>Remember that a test statistic works as our evidence, and the critical value is a threshold to determine whether the evidence is strong enough. When the test statistic is more extreme than the critical value, it means that from our point of view, the chance of our evidence happening is way too small given the current rules of the game or under <span class="math inline">\(H_0\)</span>. Therefore, we don‚Äôt think we live in the world of <span class="math inline">\(H_0\)</span>, and it probably makes more sense to think we live in the world of <span class="math inline">\(H_1\)</span>, and it is commonplace to see these evidence happening.</p>
<p><span style="color:red"> <strong><em>Example Step 5-c: Draw a Conclusion Using Critical Value</em></strong> </span></p>
<p>We reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(t_{test} &lt; -t_{\alpha, n-1}\)</span>. Since <span style="color:blue"> <span class="math inline">\(\small t_{test} = \frac{\overline{x} - \mu_0}{s/\sqrt{n}} =  \frac{147.2 - 150}{5.5/\sqrt{25}} = -2.55\)</span> </span> and <span style="color:blue"> <span class="math inline">\(\small -t_{0.05, 25-1} = -t_{0.05, 24} = -1.711\)</span> </span>, we have <span class="math inline">\(\small t_{test} = -2.55 &lt; -1.711 = -t_{\alpha, n-1}\)</span>, so we reject <span class="math inline">\(H_0\)</span>.</p>
<hr>
<p><span style="color:blue"> <strong>Step 4-p: Find the P-Value</strong> </span></p>
<p>Another decision rule is the p-value method. The <strong><span class="math inline">\(p\)</span>-value</strong> measures the strength of the evidence against <span class="math inline">\(H_0\)</span> provided by the data. <em>The smaller the <span class="math inline">\(p\)</span>-value, the greater the evidence against <span class="math inline">\(H_0\)</span></em>. As the name implies, the <span class="math inline">\(p\)</span>-value is the <em>probability</em> of getting a test statistic value that is <em>at least as extreme as</em> the one obtained from the data, assuming that <em><span class="math inline">\(H_0\)</span> is true. <span class="math inline">\((\mu = \mu_0)\)</span></em>. For example, <span class="math inline">\(p\)</span>-value <span class="math inline">\(= P(Z \ge z_{test} \mid H_0)\)</span> for a right-tailed test. We are more likely to get a <span class="math inline">\(p\)</span>-value near 0 when <span class="math inline">\(H_0\)</span> is false than when <span class="math inline">\(H_0\)</span> is true. Because when <span class="math inline">\(H_0\)</span> is true, <span class="math inline">\(z_{test}\)</span> will be closer to zero or located around the center of the distribution (the <span class="math inline">\(\mu_0\)</span> value assumed in <span class="math inline">\(H_0\)</span>), and its p-value will be around 0.5. On the other hand, when <span class="math inline">\(H_0\)</span> is false, or the true <span class="math inline">\(\mu\)</span> is not <span class="math inline">\(\mu_0\)</span>, the test statistic <span class="math inline">\(z_{test}\)</span> will be farther away from <span class="math inline">\(\mu_0\)</span> and located at the either tail of the distribution. Therefore, its p-value will be small.</p>
<p><span style="color:red"> <strong><em>P-Value Illustration</em></strong> </span></p>
<p>Since p-value is a probability, in the distribution, it represents the area under the density curve for values that are at least as extreme as the test statistic‚Äôs value. <a href="#fig-pvalue" class="quarto-xref">Figure&nbsp;<span>16.4</span></a> shows the p-value for different tests. Note that the p-value for a two-tailed test depends on whether the test statistic is positive or negative. If the calculated test statistic is on the right (left) hand side, the p-value will be the right (left) tail area times two.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pvalue" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-pvalue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-ht_files/figure-html/fig-pvalue-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pvalue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.4: Illustration of p-values for different types of hypothesis tests
</figcaption></figure>
</div>
</div>
</div>
<p>Mathematically, the p-value for any type of tests is shown in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Condition &nbsp; &nbsp;</th>
<th style="text-align: center;">
<strong>Right</strong>-tailed <span class="math inline">\((H_1: \mu &gt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Left</strong>-tailed <span class="math inline">\((H_1: \mu &lt; \mu_0)\)</span>
</th>
<th style="text-align: center;">
<strong>Two-tailed</strong> <span class="math inline">\((H_1: \mu \ne \mu_0)\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> known</td>
<td style="text-align: center;"><span class="math inline">\(P(Z &gt; z_{test} \mid H_0)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(P(Z &lt; z_{test} \mid H_0)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(2P(Z &gt; \,\mid z_{test} \mid \, \mid H_0)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">
<span class="math inline">\(\sigma\)</span> unknown</td>
<td style="text-align: center;"><span class="math inline">\(P(T &gt; t_{test} \mid H_0)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(P(T &lt; t_{test} \mid H_0)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(2P(T &gt; \, \mid t_{test} \mid  \, \mid H_0)\)</span></td>
</tr>
</tbody>
</table>
<p><span style="color:red"> <strong><em>Example Step 4-p: Find the P-Value</em></strong> </span></p>
<p><span style="color:blue">This is a left-tailed test, so the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P(T &lt; t_{test})=P(T &lt; -2.55) =\)</span> 0.01 </span></p>
<hr>
<p><span style="color:blue"> <strong>Step 5-p: Draw a Conclusion Using P-Value Method</strong> </span></p>
<p>How do we use the p-value to make the decision? Well, here the p-value is like our evidence, and the significance level <span class="math inline">\(\alpha\)</span> is the cut-off for measuring the strength of the evidence. If the <span class="math inline">\(p\)</span>-value <span class="math inline">\(\le \alpha\)</span> , we reject <span class="math inline">\(H_0\)</span>. If instead the <span class="math inline">\(p\)</span>-value <span class="math inline">\(&gt; \alpha\)</span>, we do not reject or fail to reject <span class="math inline">\(H_0\)</span>.</p>
<p>Yes, it is a pretty simple decision rule, but the <span class="math inline">\(p\)</span>-value has been misinterpreted and misused for a long time. When we do a hypothesis testing, it is dangerous to simply compare the size of <span class="math inline">\(p\)</span>-value and <span class="math inline">\(\alpha\)</span>, then jump into the conclusion. You can find more issues of p-value at XXX.</p>
<p><span style="color:red"> <strong><em>Example Step 5-p: Draw a Conclusion Using P-Value Method</em></strong> </span></p>
<p><span style="color:blue"> We reject <span class="math inline">\(H_0\)</span> if the <span class="math inline">\(p\)</span>-value &lt; <span class="math inline">\(\alpha\)</span>. Since <span class="math inline">\(p\)</span>-value <span class="math inline">\(= 0.01 &lt; 0.05 = \alpha\)</span>, we reject <span class="math inline">\(H_0\)</span>.</span></p>
<hr>
<p><span style="color:blue"> <strong>Both Methods Lead to the Same Conclusion</strong> </span></p>
<p>Remember I say both critical-value method and <span class="math inline">\(p\)</span>-value method lead to the same conclusion? <a href="#fig-conclusions" class="quarto-xref">Figure&nbsp;<span>16.5</span></a> shows why. Test statistic and critical value are variable values, either <span class="math inline">\(z\)</span> or <span class="math inline">\(t\)</span> scores. The p-value and significance level <span class="math inline">\(\alpha\)</span> are probabilities, either <span class="math inline">\(z\)</span> or <span class="math inline">\(t\)</span> probabilities. The p-value is computed from the test statistic, and <span class="math inline">\(\alpha\)</span> defines the critical value. The more extreme test statistic implies the smaller p-value, and smaller <span class="math inline">\(\alpha\)</span> means more extreme critical value. When we reject <span class="math inline">\(H_0\)</span>, the following three statements are equivalent:</p>
<ul>
<li>test statistic is in the rejection region.</li>
<li>the test statistic is more extreme than the critical value</li>
<li>the p-value is smaller than <span class="math inline">\(\alpha\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-conclusions" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-conclusions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-ht_files/figure-html/fig-conclusions-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conclusions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.5: The conclusion is the same regardless of the method used (Critical Value or P-Value).
</figcaption></figure>
</div>
</div>
</div>
<!-- Take a left-tailed test as an example.  -->
<p>The following distribution shows the equivalence of the critical-value method and the p-value method in the blood pressure example.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim</strong> </span></p>
<p>The final step in the entire hypothesis testing procedure is to make a verbal conclusion, and address the original claim. <a href="#fig-conclusion" class="quarto-xref">Figure&nbsp;<span>16.6</span></a> gives you a guideline of how we make a conclusion.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-conclusion" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-conclusion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/testing_conclusion.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="767">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-conclusion-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.6: Conclusions based on testing results. Source: https://www.drdawnwright.com/category/statistics/
</figcaption></figure>
</div>
</div>
</div>
<p>Here is a reminder. We never say <em>we accept</em> <span class="math inline">\(H_0\)</span>. Why can‚Äôt we say we ‚Äúaccept the null‚Äù? The reason is that we are assuming the null hypothesis is true or the situation we are currently in. We are trying to see if there is evidence against it. Therefore, the conclusion should be in terms of rejecting the null. We don‚Äôt accept <span class="math inline">\(H_0\)</span> when we don‚Äôt have evidence against it because we are already in the world of <span class="math inline">\(H_0\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-yoda" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-yoda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/yoda.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-yoda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.7: Meme about hypothesis testing conclusions. Source: https://www.pinterest.com/pin/287878601159173631/
</figcaption></figure>
</div>
</div>
</div>
<!-- ------------------------------------------------------------------ -->
<p><span style="color:red"> <strong><em>Example Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim</em></strong> </span></p>
<p>We have a <span class="math inline">\(H_1\)</span> claim and we reject <span class="math inline">\(H_0\)</span>, so we conclude that <span style="color:blue"> <strong>There is sufficient evidence to support the claim that the new treatment is effective</strong>. </span></p>
<!-- ------------------------------------------------------------------ -->
<!-- <span style="color:blue"> **Example Calculation in R** </span> -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Below is a demonstration of how to work through the blood pressure example using R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## create objects for any information we have</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>; <span class="va">mu_0</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="fl">147.2</span>; <span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">5.5</span>; <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span></span>
<span><span class="co">## Test statistic</span></span>
<span><span class="op">(</span><span class="va">t_test</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x_bar</span> <span class="op">-</span> <span class="va">mu_0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.545455</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Critical value</span></span>
<span><span class="op">(</span><span class="va">t_cri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="va">alpha</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.710882</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## p-value</span></span>
<span><span class="op">(</span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t_test</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.008878158</code></pre>
</div>
</div>
<p>The critical value is <span class="math inline">\(-t_{\alpha, n-1}\)</span>, or the quantile such that <span class="math inline">\(P(T_{n-1} &lt; -t_{\alpha, n-1}) = \alpha\)</span>. Therefore, we use <code><a href="https://rdrr.io/r/stats/TDist.html">qt()</a></code> to get the <span class="math inline">\(t\)</span> value. Notice that the p-value is a probability that the Student‚Äôs t variable with degrees of freedom <span class="math inline">\(n-1\)</span> is smaller (more extreme) than the test statistic. In R, we use <code><a href="https://rdrr.io/r/stats/TDist.html">pt()</a></code> to get the probability. Without specifying the <code>lower.tail</code> argument in the function, by default, both <code><a href="https://rdrr.io/r/stats/TDist.html">qt()</a></code> and <code><a href="https://rdrr.io/r/stats/TDist.html">pt()</a></code> function focuses on the lower tail or left tail, which is what we need in this left-tail test.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Below is a demonstration of how to work through the blood pressure example using Python.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## create objects to be used</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">;</span> mu_0 <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="op">=</span> <span class="fl">147.2</span><span class="op">;</span> s <span class="op">=</span> <span class="fl">5.5</span><span class="op">;</span> n <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the t-test statistic</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>t_test <span class="op">=</span> (x_bar <span class="op">-</span> mu_0) <span class="op">/</span> (s <span class="op">/</span> np.sqrt(n))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>t_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-2.5454545454545556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the critical t value</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> t.ppf(alpha, df<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>t_crit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-1.7108820799094282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the p-value</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p_val <span class="op">=</span> t.cdf(t_test, df<span class="op">=</span>n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.008878157746280955</code></pre>
</div>
</div>
<p>The critical value is <span class="math inline">\(-t_{\alpha, n-1}\)</span>, or the quantile such that <span class="math inline">\(P(T_{n-1} &lt; -t_{\alpha, n-1}) = \alpha\)</span>. Therefore, we use <code>t.ppf()</code> to get the <span class="math inline">\(t\)</span> value. Notice that the p-value is a probability that the Student‚Äôs t variable with degrees of freedom <span class="math inline">\(n-1\)</span> is smaller (more extreme) than the test statistic. In Python, we use <code>t.cdf()</code> to get the probability. Both <code>t.ppf()</code> and <code>t.cdf()</code> function focuses on the lower tail or left tail, which is what we need in this left-tail test.</p>
</div>
</div>
</div>
</section><section id="sec-ex-two-tailed" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="sec-ex-two-tailed">
<span class="header-section-number">16.3</span> Example: Two-tailed z-test</h2>
<div class="columns">
<div class="column" style="width:80%;">
<p>The milk price of a gallon of 2% milk is normally distributed with standard deviation of $0.10. Last week the mean price of a gallon of milk was 2.78. This week, based on a sample of size 25, the sample mean price of a gallon of milk was <span class="math inline">\(\overline{x} = 2.80\)</span>. Under <span class="math inline">\(\alpha = 0.05\)</span>, determine if the mean price is different this week.</p>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/milk.jpeg" class="img-fluid figure-img" width="1296"></p>
<figcaption>Source: https://unsplash.com/photos/BYlHH_1j2GA</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>Step-by-Step</strong> </span></p>
<p><span style="color:red"> <strong><em>Step 1: Set the <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span> from a Claim</em></strong> </span></p>
<p>Form the sentence <em>‚Äúdetermine if the mean price is different this week‚Äù</em>, we know the claim or what we are interested is an <span class="math inline">\(H_1\)</span> claim. If we let <span class="math inline">\(\mu\)</span> be the mean milk price this week, we have the test <span style="color:blue"> <span class="math inline">\(\small \begin{align}&amp;H_0: \mu = 2.78 \\ &amp;H_1: \mu \ne 2.78 \end{align}\)</span> </span> where 2.78 is the mean milk price last week.</p>
<p><span style="color:red"> <strong><em>Step 2: Set the Significance Level <span class="math inline">\(\alpha\)</span></em></strong> </span></p>
<p><span style="color:blue"> <span class="math inline">\(\small \alpha = 0.05\)</span> </span></p>
<p><span style="color:red"> <strong><em>Step 3: Calculate the Test Statistic</em></strong> </span></p>
<p>From the question we know that the population is normally distributed, and <span class="math inline">\(\sigma\)</span> is known. So we use the <span class="math inline">\(z\)</span>-test, and the test statistic is <span style="color:blue"> <span class="math inline">\(\small z_{test} = \frac{\overline{x} - \mu_0}{\sigma/\sqrt{n}} =  \frac{2.8 - 2.78}{0.1/\sqrt{25}} = 1.00\)</span> </span></p>
<p><span style="color:red"> <strong><em>Step 4-c: Find the Critical Value</em></strong> </span></p>
<p>Since it is a two-tailed test, we have two potential critical values. Because <span class="math inline">\(z_{test} &gt; 0\)</span> and on the right hand side of the standard normal distribution, we compare it with the critical value on the right, which is <span style="color:blue"> <span class="math inline">\(\small z_{0.05/2} = 1.96\)</span>. </span></p>
<p><span style="color:red"> <strong><em>Step 5-c: Draw a Conclusion Using Critical Value</em></strong> </span></p>
<p><span style="color:blue">This is a two-tailed test, and we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(|z_{test}| &gt; z_{\alpha/2}\)</span>. Since <span class="math inline">\(\small |z_{test}| = 1 &lt; 1.96 = z_{\alpha/2}\)</span>, we DO NOT reject <span class="math inline">\(H_0\)</span>.</span></p>
<p><span style="color:red"> <strong><em>Step 4-p: Find the P-Value</em></strong> </span></p>
<p><span style="color:blue">This is a two-tailed test, and the test statistic is on the right <span class="math inline">\((&gt; 0)\)</span>, so the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(2P(Z &gt; z_{test})=\)</span> 0.317 </span>.</p>
<p><span style="color:red"> <strong><em>Step 5-p: Draw a Conclusion Using P-Value Method</em></strong> </span></p>
<p><span style="color:blue"> We reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(p\)</span>-value &lt; <span class="math inline">\(\alpha\)</span>. Since <span class="math inline">\(p\)</span>-value <span class="math inline">\(= 0.317 &gt; 0.05 = \alpha\)</span>, we DO NOT reject <span class="math inline">\(H_0\)</span>.</span></p>
<p>The critical-value and p-value method are illustrated in <a href="#fig-illustration-methods" class="quarto-xref">Figure&nbsp;<span>16.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-illustration-methods" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-illustration-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-ht_files/figure-html/fig-illustration-methods-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-illustration-methods-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.8: Illustration of Critical Value and P-Value methods
</figcaption></figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Step 6: Restate the Conclusion in Nontechnical Terms, and Address the Original Claim</em></strong> </span></p>
<p><span style="color:blue"> <strong>There is <em>insufficient</em> evidence to support the claim that this week the mean price of milk is different from the price last week</strong>. </span></p>
<!-- -------------------------------------------------------------------- -->
<!-- <span style="color:blue"> **Calculation in R** </span> -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Below is an example of how to perform the two-tailed <span class="math inline">\(z\)</span>-test in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## create objects to be used</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>; <span class="va">mu_0</span> <span class="op">&lt;-</span> <span class="fl">2.78</span>; </span>
<span><span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="fl">2.8</span>; <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>; <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span></span>
<span><span class="co">## Test statistic</span></span>
<span><span class="op">(</span><span class="va">z_test</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x_bar</span> <span class="op">-</span> <span class="va">mu_0</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Critical value</span></span>
<span><span class="op">(</span><span class="va">z_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## p-value</span></span>
<span><span class="op">(</span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">z_test</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3173105</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Below is an example of how to perform the two-tailed <span class="math inline">\(z\)</span>-test in Python.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## create objects to be used</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">;</span> mu_0 <span class="op">=</span> <span class="fl">2.78</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="op">=</span> <span class="fl">2.8</span><span class="op">;</span> sigma <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span> n <span class="op">=</span> <span class="dv">25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the z-test statistic</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>z_test <span class="op">=</span> (x_bar <span class="op">-</span> mu_0) <span class="op">/</span> (sigma <span class="op">/</span> np.sqrt(n))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>z_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0000000000000009</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the critical z value</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># z_crit = norm.isf(alpha/2)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>z_crit <span class="op">=</span> norm.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>z_crit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.959963984540054</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate the p-value</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p_val <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> norm.sf(z_test)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>p_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3173105078629137</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb27-0"><a href="#cb27-0" aria-hidden="true" tabindex="-1"></a>hypotext <span class="op">=</span> </span>
<span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> hyposign<span class="op">;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'equal to'</span>){</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    hyposign <span class="op">=</span> <span class="st">"</span><span class="sc">\\</span><span class="st">neq"</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'less than'</span>){</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    hyposign <span class="op">=</span> <span class="st">"&lt;"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    hyposign <span class="op">=</span> <span class="st">"&gt;"</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">extbf{Hypotheses }</span><span class="sc">\\</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="vs">              H_0: </span><span class="sc">\m</span><span class="vs">u = </span><span class="sc">\m</span><span class="vs">u_0 = </span><span class="sc">${</span>mu0<span class="sc">}\\</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="vs">              H_A: </span><span class="sc">\m</span><span class="vs">u </span><span class="sc">${</span>hyposign<span class="sc">}</span><span class="vs"> </span><span class="sc">\m</span><span class="vs">u_0 = </span><span class="sc">${</span>mu0<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb28--1"><a href="#cb28--1" aria-hidden="true" tabindex="-1"></a>tobstext <span class="op">=</span> </span>
<span id="cb28-0"><a href="#cb28-0" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">extbf{Test statistic }</span><span class="sc">\\</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="vs">    t_{obs} = </span><span class="sc">\f</span><span class="vs">rac{</span><span class="sc">\b</span><span class="vs">ar x -</span><span class="sc">\m</span><span class="vs">u_0}{</span><span class="sc">\f</span><span class="vs">rac{s}{</span><span class="sc">\s</span><span class="vs">qrt{n}}} = </span><span class="sc">\f</span><span class="vs">rac{</span><span class="sc">${</span>xbar<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> - </span><span class="sc">${</span>mu0<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs">}{</span><span class="sc">\f</span><span class="vs">rac{</span><span class="sc">${</span>s<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs">}{</span><span class="sc">\s</span><span class="vs">qrt{</span><span class="sc">${</span>n<span class="sc">}</span><span class="vs">}}} = </span><span class="sc">${</span>tobs<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb29--1"><a href="#cb29--1" aria-hidden="true" tabindex="-1"></a>tcrittext <span class="op">=</span> </span>
<span id="cb29-0"><a href="#cb29-0" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">extbf{Critical value }</span><span class="sc">\\</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="vs">t_{crit} = t_{</span><span class="sc">${</span>alphaside<span class="sc">}</span><span class="vs">, </span><span class="sc">\,${</span>n<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="vs">} = </span><span class="sc">${</span>tcrit<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb30--1"><a href="#cb30--1" aria-hidden="true" tabindex="-1"></a>pvaluetext <span class="op">=</span> {</span>
<span id="cb30-0"><a href="#cb30-0" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> rejecttext<span class="op">;</span></span>
<span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sign<span class="op">;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pvaluestudentt <span class="op">&lt;</span> alpha){</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    rejecttext <span class="op">=</span> <span class="st">" </span><span class="sc">\\</span><span class="st">textbf{we reject} "</span><span class="op">;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    rejecttext <span class="op">=</span> <span class="st">"we </span><span class="sc">\\</span><span class="st">textbf{do not reject} "</span><span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="st">"</span><span class="sc">\\</span><span class="st">geq"</span><span class="op">;</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">extbf{p-value}</span><span class="sc">\\</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="vs">p</span><span class="sc">\t</span><span class="vs">ext{-value}=</span><span class="sc">${</span>pvaluestudentt<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb31--1"><a href="#cb31--1" aria-hidden="true" tabindex="-1"></a>pconclusion <span class="op">=</span> {</span>
<span id="cb31-0"><a href="#cb31-0" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> rejecttext<span class="op">;</span></span>
<span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sign<span class="op">;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pvaluestudentt <span class="op">&lt;</span> alpha){</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    rejecttext <span class="op">=</span> <span class="st">"We</span><span class="sc">\\</span><span class="st">textcolor{red}{ </span><span class="sc">\\</span><span class="st">textbf{reject}}</span><span class="sc">\ </span><span class="st">"</span><span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    rejecttext <span class="op">=</span> <span class="st">"We</span><span class="sc">\\</span><span class="st">textcolor{steelblue}{ </span><span class="sc">\\</span><span class="st">textbf{do not reject}} "</span><span class="op">;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    sign <span class="op">=</span> <span class="st">"</span><span class="sc">\\</span><span class="st">geq"</span><span class="op">;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>   <span class="cf">return</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{</span><span class="sc">${</span>rejecttext<span class="sc">}</span><span class="vs">} H_0 </span><span class="sc">\t</span><span class="vs">ext{ at } </span><span class="sc">${</span>(alpha<span class="op">*</span><span class="dv">100</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="sc">}\%</span><span class="vs"> </span><span class="sc">\t</span><span class="vs">ext{ significance level.}  `</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb32--1"><a href="#cb32--1" aria-hidden="true" tabindex="-1"></a>viewof inputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb32-0"><a href="#cb32-0" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">1000</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{sample size }n`</span>})<span class="op">,</span> </span>
<span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">1.7</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{sample mean }</span><span class="sc">\b</span><span class="vs">ar x`</span>})<span class="op">,</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="bu">Number</span><span class="op">.</span><span class="cn">EPSILON</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{sample stdev }s`</span>})<span class="op">,</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.001</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{significance lvl }</span><span class="sc">\a</span><span class="vs">lpha`</span>})<span class="op">,</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{null value }</span><span class="sc">\m</span><span class="vs">u_0`</span>})<span class="op">,</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"equal to"</span><span class="op">,</span><span class="st">"greater than"</span><span class="op">,</span> <span class="st">"less than"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\t</span><span class="vs">ext{alternative}`</span>})</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb33--1"><a href="#cb33--1" aria-hidden="true" tabindex="-1"></a>viewof toggles <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb33-0"><a href="#cb33-0" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">value</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"show critical regions"</span>})<span class="op">,</span></span>
<span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">value</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"show p-values"</span>})</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb34--1"><a href="#cb34--1" aria-hidden="true" tabindex="-1"></a>plt <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb34-0"><a href="#cb34-0" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"t-statistic"</span><span class="op">,</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="op">-</span><span class="dv">10</span><span class="op">,</span><span class="dv">10</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span>max_y]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(pdfdata<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">dist</span> <span class="op">==</span> <span class="st">"student-t"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">stroke</span> <span class="op">:</span> <span class="st">"dist"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showpvalue <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"left"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> tobs <span class="op">&amp;&amp;</span> </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>          d<span class="op">.</span><span class="at">dist</span> <span class="op">==</span> <span class="st">"student-t"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showpvalue <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"right"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> tobs <span class="op">&amp;&amp;</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">dist</span> <span class="op">==</span> <span class="st">"student-t"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showpvalue <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tobs) <span class="op">&amp;&amp;</span> </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>          d<span class="op">.</span><span class="at">dist</span> <span class="op">==</span> <span class="st">"student-t"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showpvalue <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tobs) <span class="op">&amp;&amp;</span> </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">dist</span> <span class="op">==</span> <span class="st">"student-t"</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>([{<span class="dt">x</span><span class="op">:</span> tobs<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span>}]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> conclusioncolor<span class="op">,</span> <span class="dt">symbol</span><span class="op">:</span> <span class="st">"circle"</span><span class="op">,</span> <span class="dt">r</span><span class="op">:</span> <span class="dv">5</span>})<span class="op">,</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">arrow</span>([{<span class="dt">x1</span><span class="op">:</span> tobs<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">12</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span>tobs<span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="fl">0.01</span>}]<span class="op">,</span> {<span class="dt">x1</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"y2"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> conclusioncolor})<span class="op">,</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> tobs<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> bignudge<span class="op">*</span>max_y<span class="op">/</span><span class="dv">12</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"t(obs)"</span>}]<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([{<span class="dt">x</span><span class="op">:</span> tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"green"</span>})<span class="op">,</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([{<span class="dt">x</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"green"</span>})<span class="op">,</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> tcrit<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> nudge<span class="op">*</span>max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"t(crit)"</span>}]<span class="op">,</span> </span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span><span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> nudge<span class="op">*</span>max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"-t(crit)"</span>}]<span class="op">,</span> </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span><span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([{<span class="dt">x</span><span class="op">:</span> tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"right"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"green"</span>})<span class="op">,</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> tcrit<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> nudge<span class="op">*</span>max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"t(crit)"</span>}]<span class="op">,</span> </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"right"</span><span class="op">,</span><span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([{<span class="dt">x</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"left"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"green"</span>})<span class="op">,</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> nudge<span class="op">*</span>max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"-t(crit)"</span>}]<span class="op">,</span> </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"left"</span><span class="op">,</span><span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">arrow</span>([{<span class="dt">x1</span><span class="op">:</span> tcrit<span class="op">*</span>bignudge<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"right"</span><span class="op">,</span> </span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="dt">x1</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"y2"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})<span class="op">,</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">arrow</span>([{<span class="dt">x1</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">*</span>bignudge<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:-</span><span class="dv">10</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"left"</span><span class="op">,</span> </span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="dt">x1</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"y2"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})<span class="op">,</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">arrow</span>([{<span class="dt">x1</span><span class="op">:</span> tcrit<span class="op">*</span>bignudge<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> </span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="dt">x1</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"y2"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})<span class="op">,</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">arrow</span>([{<span class="dt">x1</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">*</span>bignudge<span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:-</span><span class="dv">10</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">6</span>}]<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> </span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>                                                                    <span class="dt">x1</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">x2</span><span class="op">:</span> <span class="st">"x2"</span><span class="op">,</span> <span class="dt">y2</span><span class="op">:</span> <span class="st">"y2"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"red"</span>})<span class="op">,</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> (<span class="op">-</span><span class="dv">10</span> <span class="op">-</span> tcrit<span class="op">*</span>bignudge)<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"Reject H‚ÇÄ"</span>}]<span class="op">,</span> </span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"left"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> (<span class="dv">10</span> <span class="op">+</span> tcrit<span class="op">*</span>bignudge)<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"Reject H‚ÇÄ"</span>}]<span class="op">,</span> </span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"right"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> (<span class="op">-</span><span class="dv">10</span> <span class="op">-</span> tcrit<span class="op">*</span>bignudge)<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"Reject H‚ÇÄ"</span>}]<span class="op">,</span> </span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})<span class="op">,</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">text</span>([{<span class="dt">x1</span><span class="op">:</span> (<span class="dv">10</span> <span class="op">+</span> tcrit<span class="op">*</span>bignudge)<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dt">y1</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">texter</span><span class="op">:</span> <span class="st">"Reject H‚ÇÄ"</span>}]<span class="op">,</span> </span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>                {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> showcrit <span class="op">&amp;&amp;</span> side <span class="op">==</span> <span class="st">"both"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x1"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"y1"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"texter"</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> textfontsize})</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb35--1"><a href="#cb35--1" aria-hidden="true" tabindex="-1"></a>jstat <span class="op">=</span> <span class="pp">require</span>(<span class="st">'jstat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb36" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb36--1"><a href="#cb36--1" aria-hidden="true" tabindex="-1"></a>textfontsize <span class="op">=</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb37--1"><a href="#cb37--1" aria-hidden="true" tabindex="-1"></a>showcrit <span class="op">=</span> toggles[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb38--1"><a href="#cb38--1" aria-hidden="true" tabindex="-1"></a>showpvalue <span class="op">=</span> toggles[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb39" data-startfrom="0" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb39-0"><a href="#cb39-0" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> inputs[<span class="dv">0</span>]</span>
<span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="op">=</span> inputs[<span class="dv">1</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> inputs[<span class="dv">2</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> inputs[<span class="dv">3</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> inputs[<span class="dv">4</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>alternative <span class="op">=</span> inputs[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-13-6" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb40" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb40--1"><a href="#cb40--1" aria-hidden="true" tabindex="-1"></a>alphaside <span class="op">=</span> {</span>
<span id="cb40-0"><a href="#cb40-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'equal to'</span>){</span>
<span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alpha<span class="op">/</span><span class="dv">2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> alpha</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb41--1"><a href="#cb41--1" aria-hidden="true" tabindex="-1"></a>tobs <span class="op">=</span> (xbar<span class="op">-</span>mu0)<span class="op">/</span>(s<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb42" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb42--1"><a href="#cb42--1" aria-hidden="true" tabindex="-1"></a>tcrit <span class="op">=</span> jstat<span class="op">.</span><span class="at">studentt</span><span class="op">.</span><span class="fu">inv</span>(<span class="dv">1</span><span class="op">-</span>alphaside<span class="op">,</span> n<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb43" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb43--1"><a href="#cb43--1" aria-hidden="true" tabindex="-1"></a>zcrit <span class="op">=</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">inv</span>(<span class="dv">1</span><span class="op">-</span>alphaside<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb44" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb44--1"><a href="#cb44--1" aria-hidden="true" tabindex="-1"></a>pvaluestudentt <span class="op">=</span> {</span>
<span id="cb44-0"><a href="#cb44-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'equal to'</span>){</span>
<span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>jstat<span class="op">.</span><span class="at">studentt</span><span class="op">.</span><span class="fu">cdf</span>(<span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tobs)<span class="op">,</span> n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="op">==</span> <span class="st">'less than'</span>){</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> jstat<span class="op">.</span><span class="at">studentt</span><span class="op">.</span><span class="fu">cdf</span>(tobs<span class="op">,</span> n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">-</span>jstat<span class="op">.</span><span class="at">studentt</span><span class="op">.</span><span class="fu">cdf</span>(tobs<span class="op">,</span> n<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb45" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb45--1"><a href="#cb45--1" aria-hidden="true" tabindex="-1"></a>pdfdata <span class="op">=</span> {</span>
<span id="cb45-0"><a href="#cb45-0" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="fl">0.01</span>)<span class="op">;</span></span>
<span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"normal"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"pdf"</span>}))<span class="op">;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> studentpdf <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">studentt</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> n<span class="op">-</span><span class="dv">1</span>)<span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"pdf"</span>}))<span class="op">;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> data<span class="op">.</span><span class="fu">concat</span>(studentpdf)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> data<span class="op">.</span><span class="fu">concat</span>(tcritdata)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>   data <span class="op">=</span> data<span class="op">.</span><span class="fu">concat</span>(tobsdata)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb46" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb46--1"><a href="#cb46--1" aria-hidden="true" tabindex="-1"></a>max_y <span class="op">=</span> <span class="fl">1.05</span><span class="op">*</span>jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb47" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb47--1"><a href="#cb47--1" aria-hidden="true" tabindex="-1"></a>twosided <span class="op">=</span> alternative <span class="op">==</span> <span class="st">'equal to'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb48" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb48--1"><a href="#cb48--1" aria-hidden="true" tabindex="-1"></a>side <span class="op">=</span> {</span>
<span id="cb48-0"><a href="#cb48-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'less than'</span>){</span>
<span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"left"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="op">==</span> <span class="st">'greater than'</span>){</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"right"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"both"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb49" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb49--1"><a href="#cb49--1" aria-hidden="true" tabindex="-1"></a>tcritdata <span class="op">=</span> {</span>
<span id="cb49-0"><a href="#cb49-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (twosided){</span>
<span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"crit"</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="op">-</span>tcrit<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"crit"</span>}]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'less than'</span>){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tcrit)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"crit"</span>}]</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tcrit)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> max_y<span class="op">/</span><span class="dv">4</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"crit"</span>}]</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb50" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb50--1"><a href="#cb50--1" aria-hidden="true" tabindex="-1"></a>tobsdata <span class="op">=</span> {</span>
<span id="cb50-0"><a href="#cb50-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (twosided){</span>
<span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> tobs<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"obs"</span>}<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="op">-</span>tobs<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"obs"</span>}]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (alternative <span class="op">==</span> <span class="st">'less than'</span>){</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tobs)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"obs"</span>}]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [{<span class="dt">x</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(tobs)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">dist</span><span class="op">:</span> <span class="st">"student-t"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"obs"</span>}]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb51" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb51--1"><a href="#cb51--1" aria-hidden="true" tabindex="-1"></a>conclusioncolor <span class="op">=</span> {</span>
<span id="cb51-0"><a href="#cb51-0" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(pvaluestudentt <span class="op">&lt;</span> alpha){</span>
<span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"red"</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"steelblue"</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb52" data-startfrom="0" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb52-0"><a href="#cb52-0" aria-hidden="true" tabindex="-1"></a>nudge <span class="op">=</span> <span class="fl">1.1</span></span>
<span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bignudge <span class="op">=</span> <span class="fl">1.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-26-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-26-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section><section id="testing-summary" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="testing-summary">
<span class="header-section-number">16.4</span> Testing Summary</h2>
<p>Below is a table that summarizes what we have learned about hypothesis testing in this chapter.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 39%">
<col style="width: 29%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Numerical Data, <span class="math inline">\(\sigma\)</span> known</th>
<th style="text-align: center;">Numerical Data, <span class="math inline">\(\sigma\)</span> <span style="color:blue"> unknown </span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Parameter of Interest</strong></td>
<td style="text-align: center;">Population Mean <span class="math inline">\(\mu\)</span>
</td>
<td style="text-align: center;">Population Mean <span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Test Type</strong></td>
<td style="text-align: center;">One sample <span class="math inline">\(\color{blue}{z}\)</span> test <span class="math inline">\(H_0: \mu = \mu_0\)</span>
</td>
<td style="text-align: center;">One sample <span class="math inline">\(\color{blue}{t}\)</span> test <span class="math inline">\(H_0: \mu = \mu_0\)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Confidence Interval</strong></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x} \pm z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\bar{x} \pm t_{\alpha/2, n-1} \frac{\color{blue}{s}}{\sqrt{n}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Test Stat under <span class="math inline">\(H_0\)</span> </strong></td>
<td style="text-align: center;"><span class="math inline">\(z_{test} = \frac{\overline{x} - \mu_0}{\frac{\sigma}{\sqrt{n}}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_{test} = \frac{\overline{x} - \mu_0}{\frac{\color{blue}{s}}{\sqrt{n}}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong><span class="math inline">\(p\)</span>-value under <span class="math inline">\(H_0\)</span></strong></td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu &lt; \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=P(Z \le z_{test})\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu &lt; \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=P(T_{n-1} \le t_{test})\)</span>
</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=P(Z \ge z_{test})\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu &lt; \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=P(T_{n-1} \ge t_{test})\)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu \ne \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=2P(Z \ge \, \mid z_{test}\mid)\)</span>
</td>
<td style="text-align: center;">
<span class="math inline">\(H_1: \mu \ne \mu_0\)</span> <br><span class="math inline">\(p\)</span>-value <span class="math inline">\(=2P(T_{n-1} \ge  \, \mid t_{test} \mid)\)</span>
</td>
</tr>
</tbody>
</table></section><section id="type-i-and-type-ii-errors" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="type-i-and-type-ii-errors">
<span class="header-section-number">16.5</span> Type I and Type II Errors</h2>
<p>It is important to remember that hypothesis testing is not perfect, meaning that we may make a wrong decision or conclusion. After all, the collected evidence may not be able to present the full picture of what the true population distribution is. There are two types of errors we may commit when doing hypothesis testing: <strong>Type I error</strong> and <strong>Type II error</strong>.</p>
<p>If in fact <span class="math inline">\(H_0\)</span> is true, but we wrongly reject it, we commit the type I error. We shouldn‚Äôt reject it but we did. If <span class="math inline">\(H_0\)</span> is false, but we don‚Äôt reject it, we make the type II error. We should have figured out that <span class="math inline">\(H_0\)</span> does not make sense. The following table tells us when we make a correct decision and when we don‚Äôt. In practice, we will not know for certain if we made the correct decision or if we made one of these two errors because we never know the truth!</p>
<!-- - Because of this, Type I and Type II errors are important to understand. -->
<table class="caption-top table">
<thead><tr class="header">
<th>Decision</th>
<th>
<span class="math inline">\(H_0\)</span> is true</th>
<th>
<span class="math inline">\(H_0\)</span> is false</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Reject <span class="math inline">\(H_0\)</span>
</td>
<td><strong>Type I error</strong></td>
<td>Correct decision</td>
</tr>
<tr class="even">
<td>Do not reject <span class="math inline">\(H_0\)</span>
</td>
<td>Correct decision</td>
<td><strong>Type II error</strong></td>
</tr>
</tbody>
</table>
<p>Back to the crime example that <span class="math inline">\(H_0:\)</span> The person is <span style="color:blue"> not guilty </span> v.s. <span class="math inline">\(H_1:\)</span> The person is <span style="color:blue"> guilty </span>. We can have a decision table like</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 33%">
<col style="width: 35%">
</colgroup>
<thead><tr class="header">
<th>Decision</th>
<th>Truth is the person innocent</th>
<th>Truth is the person guilty</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Jury decides the person guilty</td>
<td><strong>Type I error</strong></td>
<td>Correct decision</td>
</tr>
<tr class="even">
<td>Jury decides the person not guilty</td>
<td>Correct decision</td>
<td><strong>Type II error</strong></td>
</tr>
</tbody>
</table>
<p>Is it worse to wrongly convict an innocent person (Type I error) or to let a perpetrator free (Type II error)? Both hugely negatively impact our society, and if possible, we should make the two errors as rarely as possible.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-errors" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/error_type.webp" class="img-fluid quarto-figure quarto-figure-center figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.9: Example of Type I and Type II errors (https://www.statisticssolutions.com/wp-content/uploads/2017/12/rachnovblog.jpg)
</figcaption></figure>
</div>
</div>
</div>
<p>It you still don‚Äôt get the idea of type I and type II errors, <a href="#fig-errors" class="quarto-xref">Figure&nbsp;<span>16.9</span></a> is a classical example of the two errors. Of course the null hypothesis is <em>‚Äúnot pregnant‚Äù</em>, and the alternative hypothesis is <em>‚Äúpregnant‚Äù</em>. Claiming that a old man is expecting a baby is a type I error, and saying a pregnant woman not having a baby is a type II error.</p>
<p>In statistics, the probability of committing the type I error is in fact the significance level <span class="math inline">\(\alpha\)</span>.</p>
<p><span class="math display">\[\alpha = P(\text{type I error}) = P(\text{rejecting } H_0 \text{ when } H_0 \text{ is true})\]</span></p>
<p>If the evidence occurring with probability lower than 5%, it will be considered sufficient evidence to reject <span class="math inline">\(H_0\)</span>, even though <span class="math inline">\(H_0\)</span> is actually the true mechanism giving rise to such evidence.</p>
<p>What is the probability of committing the type II error, the probability that we fail to reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is a false statement? We call the probability <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[\beta = P(\text{type II error}) = P(\text{failing to reject } H_0 \text{ when } H_0 \text{ is false})\]</span></p>
<p><span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and sample size <span class="math inline">\(n\)</span> are related. If we choose any two of them, the third is automatically determined. We would of course prefer <span class="math inline">\(\alpha\)</span> to be small since we would not like to conclude in favor of the research hypothesis falsely. But given the sample size, <em>small <span class="math inline">\(\alpha\)</span> leads to a large <span class="math inline">\(\beta\)</span></em>. On the other hand, too small <span class="math inline">\(\alpha\)</span> would most likely result in <em>no discovery</em> because we are gonna be conservative, set the threshold too high, and do not reject lots of <span class="math inline">\(H_0\)</span> that should be rejected. In practice, we specify <span class="math inline">\(\alpha\)</span> beforehand, and then select <span class="math inline">\(n\)</span> that is practical, so the <span class="math inline">\(\beta\)</span> is determined.</p>
<p>It would be great if we correctly reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is actually false. We hope the probability of having this to be large. The probability is actually <span class="math inline">\(1-\beta\)</span>, which is called the <strong>power</strong> of a test. The power depends on the same factors as <span class="math inline">\(\beta\)</span> does, including the size of <span class="math inline">\(\alpha\)</span>, the sample size, and the true value of parameter.</p>
<!-- - $1 - \beta =  P(\text{rejecting } H_0 \text{ when } H_0 \text{ is false})$ -->
<!-- - $1- \beta$ is called the **power** of a test. -->
<!-- - The power depends on the same factors as $\beta$ does, including the size of $\alpha$, the sample size, and the true value of parameter. -->
</section><section id="statistical-power-and-choosing-sample-size" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="statistical-power-and-choosing-sample-size">
<span class="header-section-number">16.6</span> Statistical Power and Choosing Sample Size*</h2>
<section id="power-of-a-hypothesis-test" class="level3" data-number="16.6.1"><h3 data-number="16.6.1" class="anchored" data-anchor-id="power-of-a-hypothesis-test">
<span class="header-section-number">16.6.1</span> Power of a Hypothesis Test</h3>
<p><span class="math inline">\(\beta = P(\text{type II error}) = P(\text{failing to reject } H_0 \text{ when } H_0 \text{ is false})\)</span>. In statistics, <span class="math inline">\(1 - \beta =  P(\text{rejecting } H_0 \text{ when } H_0 \text{ is false})\)</span> is called the (statistical) <strong>power</strong> of the test. We hope a test has high power because it means the test is able to correctly reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false, like we hope all criminals get arrested! The power depends on the same factors as <span class="math inline">\(\beta\)</span> does, including the size of <span class="math inline">\(\alpha\)</span>, the sample size, and the true value of parameter.</p>
<!-- ## Type I Error, Type II Error and Power Illustration -->
<p>Now let‚Äôs learn type I error, type II error, and power through distributions. Here a right-tailed example <span class="math inline">\(H_0: \mu = \mu_0\)</span> v.s. <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> is illustrated in <a href="#fig-power" class="quarto-xref">Figure&nbsp;<span>16.10</span></a>.</p>
<p>The distribution on the top is the distribution under <span class="math inline">\(H_0\)</span>, that is, the distribution has the mean <span class="math inline">\(\mu_0\)</span>. Since it is a right-tailed test, we reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if the test statistic is greater than the critical value on the right of the distribution that is indicated at the green vertical line. If we reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is actually true, we commit a type I error, and the probability of committing a type I error, which is <span class="math inline">\(\alpha\)</span>, is the green area on the right tail of the distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-power" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/img-infer/alpha_beta.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-power-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.10: Example of Power. Source
</figcaption></figure>
</div>
</div>
</div>
<!-- ![](./figures/alpha_beta.png){height=550px width=600px} -->
<p>Now, suppose the true population mean is <span class="math inline">\(\mu_a &gt; \mu_0\)</span>. That is, <span class="math inline">\(H_0\)</span> is false and <span class="math inline">\(H_1\)</span> is true, then the true distribution is the blue curve one centered at <span class="math inline">\(\mu_a\)</span> at the bottom. However, in reality most of the time we do not know the exact value of <span class="math inline">\(\mu_a\)</span>. Remember that we make our decision under the mechanism or assumption of <span class="math inline">\(H_0\)</span>. So we actually do our hypothesis testing under the distribution depicted by the purple-dashed curve. And we know this distribution because <span class="math inline">\(mu_0\)</span> is the hypothesized value of <span class="math inline">\(\mu\)</span> we specify when we do the testing. If we fail to reject the false <span class="math inline">\(H_0\)</span>, we commit the type II error. The yellow area is the probability of committing the type II error. This yellow area is the probability that we fail to reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false and <span class="math inline">\(H_1\)</span> is true <span class="math inline">\((\mu = \mu_a)\)</span>, which is <span class="math inline">\(\beta\)</span>. Although we don‚Äôt know the true value <span class="math inline">\(\mu_a\)</span>, for this right-tailed test, the left-tailed area whose value is smaller than the critical value is always the rejection region. The size of the yellow area, the chance of committing type II error, and the rejection region is smaller (larger) if <span class="math inline">\(\mu_a\)</span> is much (less) greater than <span class="math inline">\(\mu_0\)</span>.</p>
<p>Which part represents the power in the figure? The power is <span class="math inline">\(1 - \beta\)</span> which is the green area under the blue density curve at the bottom. Remember that the total area under a probability density curve is 1, and the power is the total area minus <span class="math inline">\(\beta\)</span>, the yellow area.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb53" data-startfrom="0" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb53-0"><a href="#cb53-0" aria-hidden="true" tabindex="-1"></a>viewof inputs_err <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">3</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u_0`</span>})<span class="op">,</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\m</span><span class="vs">u_A`</span>})<span class="op">,</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span> <span class="fl">2.5</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\s</span><span class="vs">igma`</span>})<span class="op">,</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">20</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"n"</span>})<span class="op">,</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">tex</span><span class="vs">`</span><span class="sc">\a</span><span class="vs">lpha`</span>})<span class="op">,</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb54" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb54--1"><a href="#cb54--1" aria-hidden="true" tabindex="-1"></a>probserrors <span class="op">=</span> <span class="fu">tex</span><span class="vs">`</span></span>
<span id="cb54-0"><a href="#cb54-0" aria-hidden="true" tabindex="-1"></a><span class="sc">\b</span><span class="vs">egin{aligned}</span></span>
<span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\t</span><span class="vs">ext{Type I error: }</span><span class="sc">\a</span><span class="vs">lpha = P(</span><span class="sc">\t</span><span class="vs">ext{rejecting } H_0 </span><span class="sc">\v</span><span class="vs">ert H_0 </span><span class="sc">\t</span><span class="vs">ext{ true}) =</span><span class="sc">${</span>alpha<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.2em]</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\t</span><span class="vs">ext{Type II error: }</span><span class="sc">\b</span><span class="vs">eta = P(</span><span class="sc">\t</span><span class="vs">ext{not rejecting } H_0 </span><span class="sc">\v</span><span class="vs">ert H_0 </span><span class="sc">\t</span><span class="vs">ext{ not true}) =</span><span class="sc">${</span>beta<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">\\</span><span class="vs">[0.2em]</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="vs">&amp;</span><span class="sc">\t</span><span class="vs">ext{Power: }1-</span><span class="sc">\b</span><span class="vs">eta = P(</span><span class="sc">\t</span><span class="vs">ext{reject } H_0 </span><span class="sc">\v</span><span class="vs">ert H_0 </span><span class="sc">\t</span><span class="vs">ext{ not true}) =</span><span class="sc">${</span>(<span class="dv">1</span><span class="op">-</span>beta)<span class="op">.</span><span class="fu">toPrecision</span>(<span class="dv">3</span>)<span class="sc">}</span><span class="vs"> </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="sc">\e</span><span class="vs">nd{aligned}</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb55" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb55--1"><a href="#cb55--1" aria-hidden="true" tabindex="-1"></a>plt_pdf_err <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb55-0"><a href="#cb55-0" aria-hidden="true" tabindex="-1"></a>  <span class="dt">caption</span><span class="op">:</span><span class="fu">html</span><span class="vs">` </span></span>
<span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;span style="color:steelblue"&gt;probability of type I error: &amp;alpha; = Pr(reject H0 | H0 true)&lt;/span&gt;&lt;br&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;span style="color:#A9A9A9"&gt;probability of type II error: &amp;beta; = Pr(not rejecting H0 | H0 not true)&lt;/span&gt; &lt;br&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;span style="color:#FFAC1C"&gt;test power: 1-&amp;beta; = Pr(reject H0 | H0 not true)&lt;/span&gt; </span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">,</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="st">"xBar"</span><span class="op">,</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span><span class="fl">1.02</span><span class="op">*</span>maxpdf]</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata_err<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&lt;=</span> zcrit_right <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&gt;=</span> zcrit_left <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"HA"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"#C0C0C0"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.3</span>})<span class="op">,</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata_err<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&gt;</span> zcrit_right <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"HA"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata_err<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&lt;</span> zcrit_left <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"HA"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"orange"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata_err<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&gt;=</span> zcrit_right <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"H0"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"steelblue"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.7</span>})<span class="op">,</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">areaY</span>(pdfdata_err<span class="op">,</span> {<span class="dt">filter</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>  <span class="op">&lt;=</span> zcrit_left <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"H0"</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"steelblue"</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.7</span>})<span class="op">,</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(pdfdata_err<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"pdf"</span><span class="op">,</span> <span class="dt">stroke</span> <span class="op">:</span> <span class="st">"type"</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">2</span>})</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb56" data-startfrom="0" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb56-0"><a href="#cb56-0" aria-hidden="true" tabindex="-1"></a>mu0_err <span class="op">=</span> inputs_err[<span class="dv">0</span>]</span>
<span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>muA_err <span class="op">=</span> inputs_err[<span class="dv">1</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>sigma_err <span class="op">=</span> inputs_err[<span class="dv">2</span>]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>n_err <span class="op">=</span> inputs_err[<span class="dv">3</span>]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>alpha_err <span class="op">=</span> inputs_err[<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-30-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-30-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-30-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-30-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-30-5" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb57" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb57--1"><a href="#cb57--1" aria-hidden="true" tabindex="-1"></a>pdfdata_err <span class="op">=</span> {</span>
<span id="cb57-0"><a href="#cb57-0" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="fl">0.01</span>)<span class="op">;</span></span>
<span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> normpdfH0 <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> mu0_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"H0"</span>}))<span class="op">;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> normpdfHA <span class="op">=</span> x<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> ({<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">pdf</span><span class="op">:</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(x<span class="op">,</span> muA_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"HA"</span>}))<span class="op">;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> normpdfH0<span class="op">.</span><span class="fu">concat</span>(normpdfHA)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb58" data-startfrom="0" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -1;"><span id="cb58-0"><a href="#cb58-0" aria-hidden="true" tabindex="-1"></a>zcrit_right <span class="op">=</span> mu0_err <span class="op">+</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">inv</span>(<span class="dv">1</span><span class="op">-</span>alpha_err<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">*</span>(sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))</span>
<span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>zcrit_left <span class="op">=</span> mu0_err <span class="op">-</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">inv</span>(<span class="dv">1</span><span class="op">-</span>alpha_err<span class="op">/</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">*</span>(sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-32-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-32-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb59" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb59--1"><a href="#cb59--1" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">cdf</span>(zcrit_right<span class="op">,</span> muA_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err)) <span class="op">-</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">cdf</span>(zcrit_left<span class="op">,</span> muA_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-33" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb60" data-startfrom="-1" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line -2;"><span id="cb60--1"><a href="#cb60--1" aria-hidden="true" tabindex="-1"></a>maxpdf <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(mu0_err<span class="op">,</span> mu0_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err))<span class="op">,</span> jstat<span class="op">.</span><span class="at">normal</span><span class="op">.</span><span class="fu">pdf</span>(muA_err<span class="op">,</span> muA_err<span class="op">,</span> sigma_err<span class="op">/</span><span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(n_err)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-34" data-nodetype="declaration">

</div>
</div>
</div>
</section><section id="power-calculation" class="level3" data-number="16.6.2"><h3 data-number="16.6.2" class="anchored" data-anchor-id="power-calculation">
<span class="header-section-number">16.6.2</span> Power Calculation</h3>
<p>In this section we illustrate how to calculate the type II error rate and power. Suppose we randomly sampled 36 values from a normally distributed population with <span class="math inline">\(\sigma = 18\)</span> and unknown <span class="math inline">\(\mu\)</span>. At <span class="math inline">\(\alpha = 0.05\)</span>, we are going to test a right-tailed test <span style="color:blue"> <span class="math inline">\(\begin{align}
  &amp;H_0: \mu = \mu_0 = 50 \\
  &amp;H_1: \mu &gt; 50
  \end{align}\)</span> </span></p>
<p>Suppose we are sampling from a normal distribution and <span class="math inline">\(\sigma\)</span> is known. Then the test statistic is <span class="math inline">\(Z_{test} = \frac{\overline{X} - \mu_0}{\sigma/\sqrt{n}} \sim N(0, 1)\)</span> under <span class="math inline">\(H_0\)</span>. Since it is a right-tailed test, we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(z_{test} &gt; z_{\alpha} = z_{0.05} = 1.645\)</span>.</p>
<p>Now we are going to re-express the rejection region in terms of <span class="math inline">\(\overline{X}\)</span> because it is going to help us calculate <span class="math inline">\(\beta\)</span>. The question is, for what values of <span class="math inline">\(\overline{X}\)</span> will we reject <span class="math inline">\(H_0\)</span>? Remember, we reject <span class="math inline">\(H_0\)</span> if the observed test statistic <span class="math inline">\(z_{test} = \frac{\overline{x} - \mu_0}{\sigma/\sqrt{n}} &gt; 1.645\)</span>. We can isolate <span class="math inline">\(\overline{x}\)</span> in the expression by multiplying <span class="math inline">\(\sigma/\sqrt{n}\)</span> and adding <span class="math inline">\(\mu_0\)</span> on both sides. Then we have <span class="math inline">\(\overline{x} &gt; \mu_0 + 1.645\frac{\sigma}{\sqrt{n}} = 50 + 1.645\frac{18}{\sqrt{36}} = 54.94\)</span>.</p>
<p>Therefore, having evidence <span class="math inline">\(z_{test} &gt; 1.645\)</span> is equivalent to having evidence <span class="math inline">\(\overline{x} &gt; 54.94\)</span>. Both represent the same rejection region. One represents the evidence using standard normal distribution as the benchmark, and the other uses the original hypothesized distribution <span class="math inline">\(N(50, 18^2)\)</span> as the benchmark. The figure below illustrates this idea. We use different scales to measure the same thing.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/beta_plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<!-- ## Beta Calculation Example  Cont'd {.smaller} -->
<p>We are not able to calculate <span class="math inline">\(\beta\)</span> or power without knowing or assuming the true value of <span class="math inline">\(\mu\)</span> which is not <span class="math inline">\(\mu_0 = 50\)</span> because <span class="math inline">\(\beta\)</span> is based on the fact that <span class="math inline">\(H_0\)</span> is false. Suppose the true mean is <span class="math inline">\(\mu = 56\)</span>. Let‚Äôs calculate <span class="math inline">\(P(\text{Type II error}) = \beta\)</span>.</p>
<!-- $H_0: \mu = 50$, $H_1: \mu > 50$ -->
<p>Now <span class="math inline">\(\beta = P(\text{Do not reject } H_0 \mid \mu = 56)\)</span>.</p>
<p>Because we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\overline{X} &gt; 54.94\)</span>, it means that we do not reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\overline{X} &lt; 54.94\)</span>. Plug into information into the probability, we have</p>
<p><span class="math inline">\(\begin{align*}
\beta = P(\text{Do not reject } H_0 \mid \mu = 56) &amp;= P(\overline{X} &lt; 54.94 \mid \mu = 56)\\
&amp;=P\left(\frac{\overline{X} - 56}{18/\sqrt{36}} &lt; \frac{54.94 - 56}{18/\sqrt{36}} \, \middle| \, \mu = 56 \right)\\
&amp;= P(Z &lt; -0.355) = 0.361
\end{align*}\)</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.355</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3612948</code></pre>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">54.94</span>, mean <span class="op">=</span> <span class="fl">56</span>, sd <span class="op">=</span> <span class="fl">18</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3619193</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="op">-</span><span class="fl">0.355</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.36129479561631284</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="fl">54.94</span>, loc<span class="op">=</span><span class="dv">56</span>, scale<span class="op">=</span><span class="dv">18</span><span class="op">/</span>np.sqrt(<span class="dv">36</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3619192793326037</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Therefore, Power <span class="math inline">\(= P(\text{Reject } H_0 \mid \mu = 56) = 1 - P(\text{Do not reject } H_0 \mid \mu = 56) = 1 - \beta = 0.639\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/beta_plot_2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<!-- ## Formula of $\beta$ (Textbook page 251) -->
<!-- The probability of Type II error $\beta = P(\text{type II error}) = P(\text{failing to reject } H_0 \text{ when } H_0 \text{ is false})$  -->
<!-- Suppose $\mu_0$ is the mean value under $H_0$ and $\mu_1$ is the mean value under $H_1$. -->
<p>In general, if the hypothesized mean value is <span class="math inline">\(\mu_0\)</span>, and the true mean value is <span class="math inline">\(\mu_1\)</span>, for one sample <span class="math inline">\(z\)</span> test, we have the formula for calculating <span class="math inline">\(\beta\)</span> as follows. The derivation is left as an exercise.</p>
<ul>
<li>For one-tailed tests (either left-tailed or right-tailed),</li>
</ul>
<p><span class="math display">\[ \beta(\mu_1) = P\left( Z \le \color{blue}{z_{\alpha}} - \frac{|\mu_0 - \mu_1|}{\sigma/\sqrt{n}}\right) \]</span></p>
<ul>
<li>For two-tailed tests,</li>
</ul>
<p><span class="math display">\[ \beta(\mu_1) = P\left( Z \le \color{blue}{z_{\alpha/2}} - \frac{|\mu_0 - \mu_1|}{\sigma/\sqrt{n}}\right) \]</span></p>
<p>Note that again to compute <span class="math inline">\(\beta\)</span>, we need the value <span class="math inline">\(\mu_1\)</span> of the true <span class="math inline">\(H_1\)</span>, which in reality is usually unknown. But we could definitely check how the value of <span class="math inline">\(\mu_1\)</span> affects <span class="math inline">\(\beta\)</span> through this formula.</p>
</section><section id="power-analysis" class="level3" data-number="16.6.3"><h3 data-number="16.6.3" class="anchored" data-anchor-id="power-analysis">
<span class="header-section-number">16.6.3</span> Power Analysis</h3>
<p>Back to the milk price example in <a href="#sec-ex-two-tailed" class="quarto-xref"><span>Section 16.3</span></a>. we have the test</p>
<p><span style="color:blue"> <span class="math inline">\(\begin{align}
  &amp;H_0: \mu = 2.78 \\
  &amp;H_1: \mu \ne 2.78
  \end{align}\)</span> </span> and we do not reject <span class="math inline">\(H_0\)</span>.</p>
<p>The question here is</p>
<ul>
<li>If <span class="math inline">\(|\mu_0 - \mu_1| = |2.78 - \mu_1| \ge 0.05\)</span>, is the conclusion that price has not changed reasonable or acceptable? Let‚Äôs see the chance of making the wrong decision.</li>
</ul>
<p>We check the probability that we do not reject <span class="math inline">\(H_0\)</span> when <span class="math inline">\(H_0\)</span> is false, i.e., the probability that <strong>we conclude that the mean milk price has not changed, but it actually did</strong>.</p>
<!-- ## Back to Example 3: Power Analysis Cont'd -->
<p>Since it is a two-tailed test, and <span class="math inline">\(|\mu_0 - \mu_1| \ge 0.05\)</span>, the type II error rate can be as high as <span class="math display">\[
\begin{align}
\beta &amp;= P\left( Z \le \color{blue}{z_{\alpha/2}} - \frac{|\mu_0 - \mu_1|}{\sigma/\sqrt{n}}\right) \\
&amp;\le P\left( Z \le 1.96 - \frac{0.05}{0.1/\sqrt{25}}\right) = P\left(Z &lt; -0.54 \right) = 0.2946.
\end{align}
\]</span> If the actual mean milk price this week is <span class="math inline">\(\mu_1 = 2.83\)</span> or <span class="math inline">\(\mu_1 = 2.73\)</span>, (since <span class="math inline">\(|\mu_0 - \mu_1| = 0.05\)</span>), there is about 3 in 10 chance of making a wrong conclusion. If we think the risk is too high, we need to collect more than 25 samples. With a fixed <span class="math inline">\(\alpha\)</span>, we can increase the testing power or decrease type II error rate by increasing the sample size. This leaves a question: <em>How do we choose a sample size that keeps <span class="math inline">\(\beta\)</span> at some low level?</em></p>
<!-- ### Factors Affect $\beta$ or the Power -->
<p>Let‚Äôs go back to the formula of <span class="math inline">\(\beta\)</span>.</p>
<p><span class="math display">\[ \beta(\mu_1) = P\left( Z \le \color{blue}{z_{\alpha}} - \frac{|\mu_0 - \mu_1|}{\sigma/\sqrt{n}}\right) \]</span></p>
<p>What will increase the power (decrease <span class="math inline">\(\beta\)</span>)?</p>
<ul>
<li>
<strong><span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\mu_1\)</span> are further away</strong>: When <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\mu_1\)</span> are far apart, the evidence that <span class="math inline">\(\mu\)</span> is not <span class="math inline">\(\mu_0\)</span> is stronger, and it‚Äôs more likely to reject <span class="math inline">\(H_0\)</span> when it is false. The chance of making type II error decreases. Look how <span class="math inline">\(\beta\)</span> decreases from the blue area to the red area when the true mean value increases from 56 to 60.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/beta_mu1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Larger <span class="math inline">\(\alpha\)</span></strong>: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are trading off. Everything held constant, if you increases <span class="math inline">\(\alpha\)</span>, it means you use smaller critical values, and allows more type I errors or false discoveries. But at the same time, more rejecting <span class="math inline">\(H_0\)</span> decreases the cases that we don‚Äôt reject <span class="math inline">\(H_0\)</span> when it is false. In other words, type II error rate goes down. The figure below shows how <span class="math inline">\(\beta\)</span> changes when <span class="math inline">\(\alpha\)</span> is increased from 0.05 to 0.2.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/beta_alpha-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Smaller <span class="math inline">\(\sigma\)</span></strong>: When <span class="math inline">\(\sigma\)</span> is small, given the same location of the distributions of <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>, or the same <span class="math inline">\(| \mu_1 - \mu_0|\)</span>, the two distributions are more separated apart, and have smaller overlapped regions. The figure below shows how <span class="math inline">\(\beta\)</span> shrinks from the blue area to the red area when <span class="math inline">\(\sigma\)</span> becomes smaller due to the fact that the two distributions become peaky and thin-tailed.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-ht_files/figure-html/beta_n-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<strong>Larger sample size <span class="math inline">\(n\)</span></strong>: When sample size gets large, more information is collected, and therefore the sampling distribution of the sample mean becomes more certain about its possible values. This results in the same effect of having a smaller <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<!-- ## Factors Affect $\beta$ or the Power {.smaller} --><!-- - For a right-tailed test $H_0: \mu = \mu_0 = 50$, $H_1: \mu > \mu_0$, we do not reject $H_0$ if $\overline{x} < 54.94$. --><!-- ```{r} --><!-- #| label: beta_size --><!-- #| echo: false --><!-- #| fig-height: 5.6 --><!-- #| fig-width: 6 --><!-- x <- seq(-3, 7, length=1000) --><!-- hx <- dnorm(x) --><!-- hx_1 <- dnorm(x, 2.5, 1) --><!-- hx_2 <- dnorm(x, 4, 1) --><!-- sd <- 0.7 --><!-- hx_small_sig <- dnorm(x, 0, sd) --><!-- hx_1_small_sig <- dnorm(x, 2.5, sd) --><!-- # hx_2_small_sig <- dnorm(x, 4, 0.5) --><!-- alpha <- 0.05 --><!-- cri_val <- qnorm(alpha, 0, 1, lower.tail = FALSE) --><!-- alpha_large <- 0.2 --><!-- cri_val_large <- qnorm(alpha_large, 0, 1, lower.tail = FALSE) --><!-- par(mar = c(1, 1, 1, 1)) --><!-- par(mfrow = c(3, 1)) --><!-- ## |mu_0 - mu_1| further --><!-- plot(x, hx, type="l", lty=1, xlab="x value", axes = FALSE,ylim= c(-0.02, 0.4), --><!--      ylab="Density", main = "mu_0 and mu_a further away", lwd = 2) --><!-- lines(x, hx_1, col = "blue", lwd = 2) --><!-- lines(x, hx_2, col = "red", lwd = 2) --><!-- # axis(1, labels = FALSE,  tck = -0.01) --><!-- # text(ub+0.4, 0.01, paste0(round(qnorm(0.95), 3)), cex = 1, col = "black") --><!-- # text(ub+0.4,-0.025, "54.94", cex = 1, col = "green4") --><!-- # text(1, 0.05, paste0("alpha=",alpha), cex = 1.3, col = "red") --><!-- segments(0, 0, 0, dnorm(0), lty = 2, lwd = 0.5) --><!-- segments(2.5, 0, 2.5, dnorm(2.5, 2.5, 1), lty = 2, lwd = 0.5, col = "blue") --><!-- segments(4, 0, 4, dnorm(4, 4, 1), lty = 2, lwd = 0.5, col = "red") --><!-- # text(0, 0.01, 0, col = "black", cex = 1) --><!-- text(0, -0.025, "50", col = "black", cex = 1) --><!-- text(2.5, -0.025, "56", col = "blue", cex = 1) --><!-- text(4, -0.025, "60", col = "red", cex = 1) --><!-- j <- x < cri_val --><!-- polygon(c(cri_val,x[j]), c(0,hx_1[j]), col="blue", border = "blue") --><!-- polygon(c(cri_val,x[j]), c(0,hx_2[j]), col="red", border = "red") --><!-- lines(x, hx, col = "black", lwd = 2) --><!-- text(ub+0.4,-0.025, "54.94", cex = 1, col = "green4") --><!-- ## large alpha --><!-- plot(x, hx, type="l", lty=1, xlab="x value", axes = FALSE,ylim= c(-0.02, 0.4), --><!--      ylab="Density", main = "Large alpha", lwd = 2) --><!-- lines(x, hx_1, col = "blue", lwd = 2) --><!-- j <- x < cri_val --><!-- polygon(c(cri_val,x[j]), c(0,hx_1[j]), col="yellow", border = "blue") --><!-- k <- x < cri_val_large --><!-- polygon(c(cri_val_large,x[k]), c(0,hx_1[k]), col="lightgray", border = "blue") --><!-- text(0, -0.025, "50", col = "black", cex = 1) --><!-- text(2.5, -0.025, "56", col = "blue", cex = 1) --><!-- text(0.45, 0.03, "beta at alpha .2", col = "black", cex = 1.2) --><!-- text(1.3, 0.09, "beta at alpha .05", col = "black", cex = 1.2) --><!-- segments(0, 0, 0, dnorm(0), lty = 2, lwd = 0.5) --><!-- segments(2.5, 0, 2.5, dnorm(2.5, 2.5, 1), lty = 2, lwd = 0.5, col = "blue") --><!-- lines(x, hx, col = "black", lwd = 2) --><!-- ## smaller sigma --><!-- plot(x, hx, type="l", lty=1, xlab="x value", axes = FALSE,ylim= c(-0.02, 0.7), --><!--      ylab="Density", main = "Smaller sigma (Larger n)", lwd = 0.5) --><!-- lines(x, hx_1, col = "blue", lwd = 0.5) --><!-- lines(x, hx_small_sig, col = "black", lwd = 3) --><!-- lines(x, hx_1_small_sig, col = "red", lwd = 3) --><!-- cri_val_small <- qnorm(alpha, 0, sd, lower.tail = FALSE) --><!-- j_small <- x < cri_val_small --><!-- segments(0, 0, 0, dnorm(0, 0, sd), lty = 2, lwd = 0.5) --><!-- segments(2.5, 0, 2.5, dnorm(2.5, 2.5, sd), lty = 2, lwd = 0.5, col = "blue") --><!-- polygon(c(cri_val,x[j]), c(0,hx_1[j]), col="blue", border = "blue") --><!-- polygon(c(cri_val_small,x[j_small]), c(0,hx_1_small_sig[j_small]), col="red", border = "red") --><!-- lines(x, hx, col = "black") --><!-- lines(x, hx_small_sig, col = "black", lwd = 3) --><!-- lines(x, hx_1_small_sig, col = "red", lwd = 3) --><!-- text(0, -0.03, "50", col = "black", cex = 1) --><!-- text(2.5, -0.03, "56", col = "blue", cex = 1) --><!-- ``` --><!-- - We first choose a $\mu_1$ in $H_1$. Then decide how small $\beta$ or how large the power we want. --><!-- add power curve slides  --><!-- ### Sample Size Formula --><p>To keep <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> at a specified level, the only way is to increase the sample size. With <span class="math inline">\(\Delta = |\mu_0-\mu_1|\)</span>, the formula for required sample size is shown as below. The derivation is left as an exercise.</p>
<ul>
<li><p>One-tailed test (either left-tailed or right-tailed): <span class="math display">\[n \ge \sigma^2 \frac{(\color{blue}{z_{\alpha}} + z_{\beta})^2}{\Delta^2}\]</span></p></li>
<li><p>Two-tailed test: <span class="math display">\[n \ge \sigma^2 \frac{( \color{blue}{z_{\alpha/2}} + z_{\beta})^2}{\Delta^2}\]</span></p></li>
</ul>
<!-- -------------------------------------------------------------- --><p><span style="color:blue"> <strong>Example: Sample size</strong> </span></p>
<!-- ## Example 5.11 -->
<p>A cereal company sell boxes of cereal with the labeled weight of 16 oz. The production is based on the mean weight of 16.37 oz. So that only small portion of boxes have weight less than 16 oz. The box weight is normally distributed with <span class="math inline">\(\sigma = 0.225\)</span>. The percentage of boxes weighting less than 16 oz. is 5%. They suspect that due to some production defect the weight filled in the boxes have mean less than 16.37, and like to conduct a test under <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>This is a <span class="math inline">\(H_1\)</span> claim and the test is<span style="color:blue"> <span class="math inline">\(\begin{align}
  &amp;H_0: \mu = 16.37 \\
  &amp;H_1: \mu &lt; 16.37
  \end{align}\)</span> </span></p>
<!-- ## Example 5.11 Cont'd  -->
<p><em>Question:</em> How many boxes should be sampled in order to correctly discover that mean is less than 16.37 with the power of 0.99 if in fact the true mean weight is 16.27 or less?</p>
<ul>
<li><p><span class="math inline">\(\alpha = 0.05\)</span>. <span class="math inline">\(\sigma = 0.225\)</span>. We have <span class="math inline">\(\beta = 1 - \text{power} = 0.01\)</span>, <span class="math inline">\(\Delta = |\mu_0 - \mu_1| = 16.37-16.27 = 0.1\)</span>.</p></li>
<li><p>The formula is <span class="math inline">\(n = \sigma^2 \frac{(\color{blue}{z_{\alpha}} + z_{\beta})^2}{\Delta^2}\)</span></p></li>
<li><p><span class="math inline">\(z_{\alpha} = z_{0.05} = 1.645\)</span>, <span class="math inline">\(z_{\beta} = z_{0.01} = 2.33\)</span>.</p></li>
<li><p>Thus, <span class="math display">\[ n \ge
\left(0.225^2\right) \frac{(1.645 + 2.33)^2}{\left(0.1^2\right)} = 79.99 \]</span></p></li>
<li><p>They need at least 80 samples to conduct the test under the specified conditions (<span class="math inline">\(\alpha = 0.05\)</span>, <span class="math inline">\(\beta=0.01\)</span>).</p></li>
</ul></section></section><section id="exercises" class="level2" data-number="16.7"><h2 data-number="16.7" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">16.7</span> Exercises</h2>
<ol type="1">
<li>
<p>Here are summary statistics for randomly selected weights of newborn boys: <span class="math inline">\(n =207\)</span>, <span class="math inline">\(\bar{x} = 30.2\)</span>hg (1hg = 100 grams), <span class="math inline">\(s = 7.3\)</span>hg.</p>
<ol type="a">
<li>With significance level 0.01, use the critical value method to test the claim that the population mean of birth weights of females is greater than 30hg.</li>
<li>Do the test in (c) by using the p-value method.</li>
</ol>
</li>
<li><p>You are given the following hypotheses: <span class="math display">\[\begin{align*}
H_0&amp;: \mu = 45 \\
H_A&amp;: \mu \neq 45
\end{align*}\]</span> We know that the sample standard deviation is 5 and the sample size is 24. For what sample mean would the p-value be equal to 0.05? Assume that all conditions necessary for inference are satisfied.</p></li>
<li>
<p>Our one sample <span class="math inline">\(z\)</span> test is <span class="math inline">\(H_0: \mu = \mu_0 \quad H_1: \mu &lt; \mu_0\)</span> with a significance level <span class="math inline">\(\alpha\)</span>.</p>
<ol type="a">
<li>Describe how we reject <span class="math inline">\(H_0\)</span> using the critical-value method and the <span class="math inline">\(p\)</span>-value method.</li>
<li>Why do the two methods lead to the same conclusion?</li>
</ol>
</li>
</ol>


</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Hypothesis testing is also called Null Hypothesis Statistical Testing (NHST), <strong>statistical testing</strong> or <strong>test of significance</strong>.<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol></section></main><!-- /main --><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh5cG90ZXh0ID0gXG57XG4gIHZhciBoeXBvc2lnbjtcbiAgaWYgKGFsdGVybmF0aXZlID09ICdlcXVhbCB0bycpe1xuICAgIGh5cG9zaWduID0gXCJcXFxcbmVxXCJcbiAgfWVsc2UgaWYgKGFsdGVybmF0aXZlID09ICdsZXNzIHRoYW4nKXtcbiAgICBoeXBvc2lnbiA9IFwiPFwiXG4gIH1lbHNle1xuICAgIGh5cG9zaWduID0gXCI+XCJcbiAgfVxuICAgcmV0dXJuIHRleGBcXHRleHRiZntIeXBvdGhlc2VzIH1cXFxcXG4gICAgICAgICAgICAgIEhfMDogXFxtdSA9IFxcbXVfMCA9ICR7bXUwfVxcXFxcbiAgICAgICAgICAgICAgSF9BOiBcXG11ICR7aHlwb3NpZ259IFxcbXVfMCA9ICR7bXUwfWBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRvYnN0ZXh0ID0gXG57XG4gICByZXR1cm4gdGV4YFxcdGV4dGJme1Rlc3Qgc3RhdGlzdGljIH1cXFxcXG4gICAgdF97b2JzfSA9IFxcZnJhY3tcXGJhciB4IC1cXG11XzB9e1xcZnJhY3tzfXtcXHNxcnR7bn19fSA9IFxcZnJhY3ske3hiYXIudG9GaXhlZCgzKX0gLSAke211MC50b0ZpeGVkKDMpfX17XFxmcmFjeyR7cy50b0ZpeGVkKDMpfX17XFxzcXJ0eyR7bn19fX0gPSAke3RvYnMudG9GaXhlZCgzKX1gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0Y3JpdHRleHQgPSBcbntcbiAgIHJldHVybiB0ZXhgXFx0ZXh0YmZ7Q3JpdGljYWwgdmFsdWUgfVxcXFxcbnRfe2NyaXR9ID0gdF97JHthbHBoYXNpZGV9LCBcXCwke24tMX19ID0gJHt0Y3JpdC50b1ByZWNpc2lvbig0KX1gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwdmFsdWV0ZXh0ID0ge1xuICB2YXIgcmVqZWN0dGV4dDtcbiAgdmFyIHNpZ247XG4gIGlmIChwdmFsdWVzdHVkZW50dCA8IGFscGhhKXtcbiAgICByZWplY3R0ZXh0ID0gXCIgXFxcXHRleHRiZnt3ZSByZWplY3R9IFwiO1xuICAgIHNpZ24gPSBcIjxcIjtcbiAgfWVsc2V7XG4gICAgcmVqZWN0dGV4dCA9IFwid2UgXFxcXHRleHRiZntkbyBub3QgcmVqZWN0fSBcIjtcbiAgICBzaWduID0gXCJcXFxcZ2VxXCI7XG4gIH1cbiAgIHJldHVybiB0ZXhgXFx0ZXh0YmZ7cC12YWx1ZX1cXFxcXG5wXFx0ZXh0ey12YWx1ZX09JHtwdmFsdWVzdHVkZW50dC50b1ByZWNpc2lvbig0KX1gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwY29uY2x1c2lvbiA9IHtcbiAgdmFyIHJlamVjdHRleHQ7XG4gIHZhciBzaWduO1xuICBpZiAocHZhbHVlc3R1ZGVudHQgPCBhbHBoYSl7XG4gICAgcmVqZWN0dGV4dCA9IFwiV2VcXFxcdGV4dGNvbG9ye3JlZH17IFxcXFx0ZXh0YmZ7cmVqZWN0fX1cXCBcIjtcbiAgICBzaWduID0gXCI8XCI7XG4gIH1lbHNle1xuICAgIHJlamVjdHRleHQgPSBcIldlXFxcXHRleHRjb2xvcntzdGVlbGJsdWV9eyBcXFxcdGV4dGJme2RvIG5vdCByZWplY3R9fSBcIjtcbiAgICBzaWduID0gXCJcXFxcZ2VxXCI7XG4gIH1cbiAgIHJldHVybiB0ZXhgXFx0ZXh0eyR7cmVqZWN0dGV4dH19IEhfMCBcXHRleHR7IGF0IH0gJHsoYWxwaGEqMTAwKS50b0ZpeGVkKDEpfVxcJSBcXHRleHR7IHNpZ25pZmljYW5jZSBsZXZlbC59ICBgXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgaW5wdXRzID0gSW5wdXRzLmZvcm0oW1xuICAgICAgSW5wdXRzLnJhbmdlKFsyLCAxMDAwXSwge3ZhbHVlOiA1LCBzdGVwOiAxLCBsYWJlbDogdGV4YFxcdGV4dHtzYW1wbGUgc2l6ZSB9bmB9KSwgXG4gICAgICBJbnB1dHMucmFuZ2UoWy0xMCwgMTBdLCB7dmFsdWU6IDEuNywgc3RlcDogMC4wMSwgbGFiZWw6IHRleGBcXHRleHR7c2FtcGxlIG1lYW4gfVxcYmFyIHhgfSksXG4gICAgICBJbnB1dHMucmFuZ2UoW051bWJlci5FUFNJTE9OLCAxMF0sIHt2YWx1ZTogMC41LCBzdGVwOiAwLjEsIGxhYmVsOiB0ZXhgXFx0ZXh0e3NhbXBsZSBzdGRldiB9c2B9KSxcbiAgICAgIElucHV0cy5yYW5nZShbMC4wMDEsIDFdLCB7dmFsdWU6IDAuMDUsIHN0ZXA6IDAuMDAxLCBsYWJlbDogdGV4YFxcdGV4dHtzaWduaWZpY2FuY2UgbHZsIH1cXGFscGhhYH0pLFxuICAgICAgSW5wdXRzLnJhbmdlKFstMTAsIDEwXSwge3ZhbHVlOiAxLCBzdGVwOiAwLjEsIGxhYmVsOiB0ZXhgXFx0ZXh0e251bGwgdmFsdWUgfVxcbXVfMGB9KSxcbiAgICAgIElucHV0cy5zZWxlY3QoW1wiZXF1YWwgdG9cIixcImdyZWF0ZXIgdGhhblwiLCBcImxlc3MgdGhhblwiXSwge2xhYmVsOiB0ZXhgXFx0ZXh0e2FsdGVybmF0aXZlfWB9KVxuICAgIF0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgdG9nZ2xlcyA9IElucHV0cy5mb3JtKFtcbiAgSW5wdXRzLnRvZ2dsZSh7dmFsdWU6IHRydWUsIGxhYmVsOiBcInNob3cgY3JpdGljYWwgcmVnaW9uc1wifSksXG4gIElucHV0cy50b2dnbGUoe3ZhbHVlOiBmYWxzZSwgbGFiZWw6IFwic2hvdyBwLXZhbHVlc1wifSlcbiAgXSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBsdCA9IFBsb3QucGxvdCh7XG4gICAgY29sb3I6IHtcbiAgICAgIGxlZ2VuZDogZmFsc2VcbiAgICB9LFxuICAgIHg6IHtcbiAgICAgIGxhYmVsOiBcInQtc3RhdGlzdGljXCIsXG4gICAgICBheGlzOiB0cnVlLFxuICAgICAgZG9tYWluOiBbLTEwLDEwXVxuICAgIH0sXG4gICAgeToge1xuICAgICAgYXhpczogZmFsc2UsXG4gICAgICBkb21haW46IFswLG1heF95XVxuICAgIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIFBsb3QucnVsZVkoWzBdKSxcbiAgICAgIFBsb3QubGluZShwZGZkYXRhLCB7ZmlsdGVyOiBkID0+IGQuZGlzdCA9PSBcInN0dWRlbnQtdFwiICYmIGQudHlwZSA9PSBcInBkZlwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgc3Ryb2tlIDogXCJkaXN0XCIsIHN0cm9rZVdpZHRoOiAyfSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGEsIHtmaWx0ZXI6IGQgPT4gc2hvd3B2YWx1ZSAmJiBzaWRlID09IFwibGVmdFwiICYmIGQueCA8PSB0b2JzICYmIFxuICAgICAgICAgIGQuZGlzdCA9PSBcInN0dWRlbnQtdFwiICYmIGQudHlwZSA9PSBcInBkZlwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCJvcmFuZ2VcIiwgb3BhY2l0eTogMC41fSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGEsIHtmaWx0ZXI6IGQgPT4gc2hvd3B2YWx1ZSAmJiBzaWRlID09IFwicmlnaHRcIiAmJiBkLnggPj0gdG9icyAmJiBcbiAgICAgICAgZC5kaXN0ID09IFwic3R1ZGVudC10XCIgJiYgZC50eXBlID09IFwicGRmXCIsIHg6IFwieFwiLCB5OiBcInBkZlwiLCBmaWxsOiBcIm9yYW5nZVwiLCBvcGFjaXR5OiAwLjV9KSxcbiAgICAgIFBsb3QuYXJlYVkocGRmZGF0YSwge2ZpbHRlcjogZCA9PiBzaG93cHZhbHVlICYmIHNpZGUgPT0gXCJib3RoXCIgJiYgZC54IDw9IC1NYXRoLmFicyh0b2JzKSAmJiBcbiAgICAgICAgICBkLmRpc3QgPT0gXCJzdHVkZW50LXRcIiAmJiBkLnR5cGUgPT0gXCJwZGZcIiwgeDogXCJ4XCIsIHk6IFwicGRmXCIsIGZpbGw6IFwib3JhbmdlXCIsIG9wYWNpdHk6IDAuNX0pLFxuICAgICAgUGxvdC5hcmVhWShwZGZkYXRhLCB7ZmlsdGVyOiBkID0+IHNob3dwdmFsdWUgJiYgc2lkZSA9PSBcImJvdGhcIiAmJiBkLnggPj0gTWF0aC5hYnModG9icykgJiYgXG4gICAgICAgIGQuZGlzdCA9PSBcInN0dWRlbnQtdFwiICYmIGQudHlwZSA9PSBcInBkZlwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCJvcmFuZ2VcIiwgb3BhY2l0eTogMC41fSksXG4gICAgICBcbiAgICAgIFBsb3QuZG90KFt7eDogdG9icywgeTogMH1dLCB7eDogXCJ4XCIsIHk6IFwieVwiLCBmaWxsOiBjb25jbHVzaW9uY29sb3IsIHN5bWJvbDogXCJjaXJjbGVcIiwgcjogNX0pLFxuICAgICAgUGxvdC5hcnJvdyhbe3gxOiB0b2JzLCB5MTogbWF4X3kvMTIsIHgyOnRvYnMsIHkyOiAwLjAxfV0sIHt4MTogXCJ4MVwiLCB5MTogXCJ5MVwiLCB4MjogXCJ4MlwiLCB5MjogXCJ5MlwiLCBzdHJva2U6IGNvbmNsdXNpb25jb2xvcn0pLFxuICAgICAgUGxvdC50ZXh0KFt7eDE6IHRvYnMsIHkxOiBiaWdudWRnZSptYXhfeS8xMiwgdGV4dGVyOiBcInQob2JzKVwifV0sIHt4OiBcIngxXCIsIHk6IFwieTFcIiwgdGV4dDogXCJ0ZXh0ZXJcIiwgZm9udFNpemU6IHRleHRmb250c2l6ZX0pLFxuICAgICAgXG4gICAgICBQbG90LnJ1bGVYKFt7eDogdGNyaXQsIHk6IG1heF95LzR9XSwge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwiYm90aFwiLCB4OiBcInhcIiwgeTogXCJ5XCIsIGZpbGw6IFwiZ3JlZW5cIn0pLFxuICAgICAgUGxvdC5ydWxlWChbe3g6IC10Y3JpdCwgeTogbWF4X3kvNH1dLCB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJib3RoXCIsIHg6IFwieFwiLCB5OiBcInlcIiwgZmlsbDogXCJncmVlblwifSksXG4gICAgICBQbG90LnRleHQoW3t4MTogdGNyaXQsIHkxOiBudWRnZSptYXhfeS80LCB0ZXh0ZXI6IFwidChjcml0KVwifV0sIFxuICAgICAgICAgICAgICAgIHtmaWx0ZXI6IGQgPT4gc2hvd2NyaXQgJiYgc2lkZSA9PSBcImJvdGhcIix4OiBcIngxXCIsIHk6IFwieTFcIiwgdGV4dDogXCJ0ZXh0ZXJcIiwgZm9udFNpemU6IHRleHRmb250c2l6ZX0pLFxuICAgICAgUGxvdC50ZXh0KFt7eDE6IC10Y3JpdCwgeTE6IG51ZGdlKm1heF95LzQsIHRleHRlcjogXCItdChjcml0KVwifV0sIFxuICAgICAgICAgICAgICAgIHtmaWx0ZXI6IGQgPT4gc2hvd2NyaXQgJiYgc2lkZSA9PSBcImJvdGhcIix4OiBcIngxXCIsIHk6IFwieTFcIiwgdGV4dDogXCJ0ZXh0ZXJcIiwgZm9udFNpemU6IHRleHRmb250c2l6ZX0pLFxuXG4gICAgICBQbG90LnJ1bGVYKFt7eDogdGNyaXQsIHk6IG1heF95LzR9XSwge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwicmlnaHRcIiwgeDogXCJ4XCIsIHk6IFwieVwiLCBmaWxsOiBcImdyZWVuXCJ9KSxcbiAgICAgIFBsb3QudGV4dChbe3gxOiB0Y3JpdCwgeTE6IG51ZGdlKm1heF95LzQsIHRleHRlcjogXCJ0KGNyaXQpXCJ9XSwgXG4gICAgICAgICAgICAgICAge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwicmlnaHRcIix4OiBcIngxXCIsIHk6IFwieTFcIiwgdGV4dDogXCJ0ZXh0ZXJcIiwgZm9udFNpemU6IHRleHRmb250c2l6ZX0pLFxuICAgICAgXG4gICAgICBQbG90LnJ1bGVYKFt7eDogLXRjcml0LCB5OiBtYXhfeS80fV0sIHtmaWx0ZXI6IGQgPT4gc2hvd2NyaXQgJiYgc2lkZSA9PSBcImxlZnRcIiwgeDogXCJ4XCIsIHk6IFwieVwiLCBmaWxsOiBcImdyZWVuXCJ9KSxcbiAgICAgIFBsb3QudGV4dChbe3gxOiAtdGNyaXQsIHkxOiBudWRnZSptYXhfeS80LCB0ZXh0ZXI6IFwiLXQoY3JpdClcIn1dLCBcbiAgICAgICAgICAgICAgICB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJsZWZ0XCIseDogXCJ4MVwiLCB5OiBcInkxXCIsIHRleHQ6IFwidGV4dGVyXCIsIGZvbnRTaXplOiB0ZXh0Zm9udHNpemV9KSxcblxuICAgICAgUGxvdC5hcnJvdyhbe3gxOiB0Y3JpdCpiaWdudWRnZSwgeTE6IG1heF95LzYsIHgyOjEwLCB5MjogbWF4X3kvNn1dLCB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJyaWdodFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgxOiBcIngxXCIsIHkxOiBcInkxXCIsIHgyOiBcIngyXCIsIHkyOiBcInkyXCIsIHN0cm9rZTogXCJyZWRcIn0pLFxuICAgICAgUGxvdC5hcnJvdyhbe3gxOiAtdGNyaXQqYmlnbnVkZ2UsIHkxOiBtYXhfeS82LCB4MjotMTAsIHkyOiBtYXhfeS82fV0sIHtmaWx0ZXI6IGQgPT4gc2hvd2NyaXQgJiYgc2lkZSA9PSBcImxlZnRcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgxOiBcIngxXCIsIHkxOiBcInkxXCIsIHgyOiBcIngyXCIsIHkyOiBcInkyXCIsIHN0cm9rZTogXCJyZWRcIn0pLFxuICAgICAgUGxvdC5hcnJvdyhbe3gxOiB0Y3JpdCpiaWdudWRnZSwgeTE6IG1heF95LzYsIHgyOjEwLCB5MjogbWF4X3kvNn1dLCB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJib3RoXCIsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDE6IFwieDFcIiwgeTE6IFwieTFcIiwgeDI6IFwieDJcIiwgeTI6IFwieTJcIiwgc3Ryb2tlOiBcInJlZFwifSksXG4gICAgICBQbG90LmFycm93KFt7eDE6IC10Y3JpdCpiaWdudWRnZSwgeTE6IG1heF95LzYsIHgyOi0xMCwgeTI6IG1heF95LzZ9XSwge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwiYm90aFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDE6IFwieDFcIiwgeTE6IFwieTFcIiwgeDI6IFwieDJcIiwgeTI6IFwieTJcIiwgc3Ryb2tlOiBcInJlZFwifSksXG4gICAgICBQbG90LnRleHQoW3t4MTogKC0xMCAtIHRjcml0KmJpZ251ZGdlKS8yLCB5MTogbWF4X3kvNCwgdGV4dGVyOiBcIlJlamVjdCBI4oKAXCJ9XSwgXG4gICAgICAgICAgICAgICAge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwibGVmdFwiLCB4OiBcIngxXCIsIHk6IFwieTFcIiwgdGV4dDogXCJ0ZXh0ZXJcIiwgZm9udFNpemU6IHRleHRmb250c2l6ZX0pLFxuICAgICAgUGxvdC50ZXh0KFt7eDE6ICgxMCArIHRjcml0KmJpZ251ZGdlKS8yLCB5MTogbWF4X3kvNCwgdGV4dGVyOiBcIlJlamVjdCBI4oKAXCJ9XSwgXG4gICAgICAgICAgICAgICAge2ZpbHRlcjogZCA9PiBzaG93Y3JpdCAmJiBzaWRlID09IFwicmlnaHRcIiwgeDogXCJ4MVwiLCB5OiBcInkxXCIsIHRleHQ6IFwidGV4dGVyXCIsIGZvbnRTaXplOiB0ZXh0Zm9udHNpemV9KSxcbiAgICAgIFBsb3QudGV4dChbe3gxOiAoLTEwIC0gdGNyaXQqYmlnbnVkZ2UpLzIsIHkxOiBtYXhfeS80LCB0ZXh0ZXI6IFwiUmVqZWN0IEjigoBcIn1dLCBcbiAgICAgICAgICAgICAgICB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJib3RoXCIsIHg6IFwieDFcIiwgeTogXCJ5MVwiLCB0ZXh0OiBcInRleHRlclwiLCBmb250U2l6ZTogdGV4dGZvbnRzaXplfSksXG4gICAgICBQbG90LnRleHQoW3t4MTogKDEwICsgdGNyaXQqYmlnbnVkZ2UpLzIsIHkxOiBtYXhfeS80LCB0ZXh0ZXI6IFwiUmVqZWN0IEjigoBcIn1dLCBcbiAgICAgICAgICAgICAgICB7ZmlsdGVyOiBkID0+IHNob3djcml0ICYmIHNpZGUgPT0gXCJib3RoXCIsIHg6IFwieDFcIiwgeTogXCJ5MVwiLCB0ZXh0OiBcInRleHRlclwiLCBmb250U2l6ZTogdGV4dGZvbnRzaXplfSlcbiAgICBdXG4gIH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJqc3RhdCA9IHJlcXVpcmUoJ2pzdGF0JylcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0ZXh0Zm9udHNpemUgPSAxMlxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNob3djcml0ID0gdG9nZ2xlc1swXVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNob3dwdmFsdWUgPSB0b2dnbGVzWzFdXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibiA9IGlucHV0c1swXVxueGJhciA9IGlucHV0c1sxXVxucyA9IGlucHV0c1syXVxuYWxwaGEgPSBpbnB1dHNbM11cbm11MCA9IGlucHV0c1s0XVxuYWx0ZXJuYXRpdmUgPSBpbnB1dHNbNV1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhbHBoYXNpZGUgPSB7XG4gIGlmIChhbHRlcm5hdGl2ZSA9PSAnZXF1YWwgdG8nKXtcbiAgICByZXR1cm4gYWxwaGEvMlxuICB9ZWxzZXtcbiAgICByZXR1cm4gYWxwaGFcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRvYnMgPSAoeGJhci1tdTApLyhzL01hdGguc3FydChuKSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0Y3JpdCA9IGpzdGF0LnN0dWRlbnR0LmludigxLWFscGhhc2lkZSwgbi0xKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Inpjcml0ID0ganN0YXQubm9ybWFsLmludigxLWFscGhhc2lkZSwgMCwgMSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwdmFsdWVzdHVkZW50dCA9IHtcbiAgaWYgKGFsdGVybmF0aXZlID09ICdlcXVhbCB0bycpe1xuICAgICAgcmV0dXJuIDIqanN0YXQuc3R1ZGVudHQuY2RmKC1NYXRoLmFicyh0b2JzKSwgbi0xKVxuICB9ZWxzZSBpZihhbHRlcm5hdGl2ZSA9PSAnbGVzcyB0aGFuJyl7XG4gICAgcmV0dXJuIGpzdGF0LnN0dWRlbnR0LmNkZih0b2JzLCBuLTEpXG4gIH1lbHNle1xuICAgIHJldHVybiAxLWpzdGF0LnN0dWRlbnR0LmNkZih0b2JzLCBuLTEpXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwZGZkYXRhID0ge1xuICBjb25zdCB4ID0gZDMucmFuZ2UoLTEwLCAxMCwgMC4wMSk7XG4gIHZhciBkYXRhID0geC5tYXAoeCA9PiAoe3g6IHgsIHBkZjoganN0YXQubm9ybWFsLnBkZih4LCAwLCAxKSwgZGlzdDogXCJub3JtYWxcIiwgdHlwZTogXCJwZGZcIn0pKTtcbiAgY29uc3Qgc3R1ZGVudHBkZiA9IHgubWFwKHggPT4gKHt4OiB4LCBwZGY6IGpzdGF0LnN0dWRlbnR0LnBkZih4LCBuLTEpLCBkaXN0OiBcInN0dWRlbnQtdFwiLCB0eXBlOiBcInBkZlwifSkpO1xuICBkYXRhID0gZGF0YS5jb25jYXQoc3R1ZGVudHBkZilcbiAgZGF0YSA9IGRhdGEuY29uY2F0KHRjcml0ZGF0YSlcbiAgIGRhdGEgPSBkYXRhLmNvbmNhdCh0b2JzZGF0YSlcbiAgcmV0dXJuIGRhdGFcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtYXhfeSA9IDEuMDUqanN0YXQubm9ybWFsLnBkZigwLCAwLCAxKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InR3b3NpZGVkID0gYWx0ZXJuYXRpdmUgPT0gJ2VxdWFsIHRvJ1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNpZGUgPSB7XG4gIGlmIChhbHRlcm5hdGl2ZSA9PSAnbGVzcyB0aGFuJyl7XG4gICAgcmV0dXJuIFwibGVmdFwiXG4gIH1lbHNlIGlmKGFsdGVybmF0aXZlID09ICdncmVhdGVyIHRoYW4nKXtcbiAgICByZXR1cm4gXCJyaWdodFwiXG4gIH1lbHNle1xuICAgIHJldHVybiBcImJvdGhcIlxuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGNyaXRkYXRhID0ge1xuICBpZiAodHdvc2lkZWQpe1xuICAgIHJldHVybiBbe3g6IHRjcml0LCB5OiBtYXhfeS80LCBkaXN0OiBcInN0dWRlbnQtdFwiLCB0eXBlOiBcImNyaXRcIn0sIHt4OiAtdGNyaXQsIHk6IG1heF95LzQsIGRpc3Q6IFwic3R1ZGVudC10XCIsIHR5cGU6IFwiY3JpdFwifV1cbiAgfWVsc2UgaWYgKGFsdGVybmF0aXZlID09ICdsZXNzIHRoYW4nKXtcbiAgICByZXR1cm4gW3t4OiAtTWF0aC5hYnModGNyaXQpLCB5OiBtYXhfeS80LCBkaXN0OiBcInN0dWRlbnQtdFwiLCB0eXBlOiBcImNyaXRcIn1dXG4gIH1lbHNlXG4gIHtcbiAgICByZXR1cm4gW3t4OiBNYXRoLmFicyh0Y3JpdCksIHk6IG1heF95LzQsIGRpc3Q6IFwic3R1ZGVudC10XCIsIHR5cGU6IFwiY3JpdFwifV1cbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRvYnNkYXRhID0ge1xuICBpZiAodHdvc2lkZWQpe1xuICAgIHJldHVybiBbe3g6IHRvYnMsIHk6IDAsIGRpc3Q6IFwic3R1ZGVudC10XCIsIHR5cGU6IFwib2JzXCJ9LCB7eDogLXRvYnMsIHk6IDAsIGRpc3Q6IFwic3R1ZGVudC10XCIsIHR5cGU6IFwib2JzXCJ9XVxuICB9ZWxzZSBpZiAoYWx0ZXJuYXRpdmUgPT0gJ2xlc3MgdGhhbicpe1xuICAgIHJldHVybiBbe3g6IC1NYXRoLmFicyh0b2JzKSwgeTogMCwgZGlzdDogXCJzdHVkZW50LXRcIiwgdHlwZTogXCJvYnNcIn1dXG4gIH1lbHNlXG4gIHtcbiAgICByZXR1cm4gW3t4OiBNYXRoLmFicyh0b2JzKSwgeTogMCwgZGlzdDogXCJzdHVkZW50LXRcIiwgdHlwZTogXCJvYnNcIn1dXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjb25jbHVzaW9uY29sb3IgPSB7XG4gIGlmKHB2YWx1ZXN0dWRlbnR0IDwgYWxwaGEpe1xuICAgIHJldHVybiBcInJlZFwiXG4gIH1lbHNle1xuICAgIHJldHVybiBcInN0ZWVsYmx1ZVwiXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJudWRnZSA9IDEuMVxuYmlnbnVkZ2UgPSAxLjNcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgaW5wdXRzX2VyciA9IElucHV0cy5mb3JtKFtcbiAgICAgIElucHV0cy5yYW5nZShbLTMsIDNdLCB7dmFsdWU6IDAsIHN0ZXA6IDAuMSwgbGFiZWw6IHRleGBcXG11XzBgfSksXG4gICAgICBJbnB1dHMucmFuZ2UoWy01LCA1XSwge3ZhbHVlOiAyLCBzdGVwOiAwLjEsIGxhYmVsOiB0ZXhgXFxtdV9BYH0pLFxuICAgICAgSW5wdXRzLnJhbmdlKFswLjEsIDIuNV0sIHt2YWx1ZTogMSwgc3RlcDogMC4wMSwgbGFiZWw6IHRleGBcXHNpZ21hYH0pLFxuICAgICAgSW5wdXRzLnJhbmdlKFsxLCAyMF0sIHt2YWx1ZTogMTAsIHN0ZXA6IDEsIGxhYmVsOiBcIm5cIn0pLFxuICAgICAgSW5wdXRzLnJhbmdlKFswLCAxXSwge3ZhbHVlOiAwLjA1LCBzdGVwOiAwLjAwMSwgbGFiZWw6IHRleGBcXGFscGhhYH0pLFxuICAgIF0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicHJvYnNlcnJvcnMgPSB0ZXhgXG5cXGJlZ2lue2FsaWduZWR9XG4mXFx0ZXh0e1R5cGUgSSBlcnJvcjogfVxcYWxwaGEgPSBQKFxcdGV4dHtyZWplY3RpbmcgfSBIXzAgXFx2ZXJ0IEhfMCBcXHRleHR7IHRydWV9KSA9JHthbHBoYS50b1ByZWNpc2lvbigzKX0gXFxcXFswLjJlbV1cbiZcXHRleHR7VHlwZSBJSSBlcnJvcjogfVxcYmV0YSA9IFAoXFx0ZXh0e25vdCByZWplY3RpbmcgfSBIXzAgXFx2ZXJ0IEhfMCBcXHRleHR7IG5vdCB0cnVlfSkgPSR7YmV0YS50b1ByZWNpc2lvbigzKX0gXFxcXFswLjJlbV1cbiZcXHRleHR7UG93ZXI6IH0xLVxcYmV0YSA9IFAoXFx0ZXh0e3JlamVjdCB9IEhfMCBcXHZlcnQgSF8wIFxcdGV4dHsgbm90IHRydWV9KSA9JHsoMS1iZXRhKS50b1ByZWNpc2lvbigzKX0gXG5cXGVuZHthbGlnbmVkfVxuYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBsdF9wZGZfZXJyID0gUGxvdC5wbG90KHtcbiAgY2FwdGlvbjpodG1sYCBcbiAgPHNwYW4gc3R5bGU9XCJjb2xvcjpzdGVlbGJsdWVcIj5wcm9iYWJpbGl0eSBvZiB0eXBlIEkgZXJyb3I6ICZhbHBoYTsgPSBQcihyZWplY3QgSDAgfCBIMCB0cnVlKTwvc3Bhbj48YnI+XG4gIDxzcGFuIHN0eWxlPVwiY29sb3I6I0E5QTlBOVwiPnByb2JhYmlsaXR5IG9mIHR5cGUgSUkgZXJyb3I6ICZiZXRhOyA9IFByKG5vdCByZWplY3RpbmcgSDAgfCBIMCBub3QgdHJ1ZSk8L3NwYW4+IDxicj5cbiAgPHNwYW4gc3R5bGU9XCJjb2xvcjojRkZBQzFDXCI+dGVzdCBwb3dlcjogMS0mYmV0YTsgPSBQcihyZWplY3QgSDAgfCBIMCBub3QgdHJ1ZSk8L3NwYW4+IFxuICBgLFxuICAgIGNvbG9yOiB7XG4gICAgICBsZWdlbmQ6IHRydWVcbiAgICB9LFxuICAgIHg6IHtcbiAgICAgIGxhYmVsOiBcInhCYXJcIixcbiAgICAgIGF4aXM6IHRydWVcbiAgICB9LFxuICAgIHk6IHtcbiAgICAgIGF4aXM6IGZhbHNlLFxuICAgICAgZG9tYWluOiBbMCwxLjAyKm1heHBkZl1cbiAgICB9LFxuICAgIG1hcmtzOiBbXG4gICAgICBQbG90LnJ1bGVZKFswXSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGFfZXJyLCB7ZmlsdGVyOiBkID0+IGQueCAgPD0gemNyaXRfcmlnaHQgJiYgZC54ICA+PSB6Y3JpdF9sZWZ0ICYmIGQudHlwZSA9PSBcIkhBXCIsIHg6IFwieFwiLCB5OiBcInBkZlwiLCBmaWxsOiBcIiNDMEMwQzBcIiwgb3BhY2l0eTogMC4zfSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGFfZXJyLCB7ZmlsdGVyOiBkID0+IGQueCAgPiB6Y3JpdF9yaWdodCAmJiBkLnR5cGUgPT0gXCJIQVwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCJvcmFuZ2VcIiwgb3BhY2l0eTogMC41fSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGFfZXJyLCB7ZmlsdGVyOiBkID0+IGQueCAgPCB6Y3JpdF9sZWZ0ICYmIGQudHlwZSA9PSBcIkhBXCIsIHg6IFwieFwiLCB5OiBcInBkZlwiLCBmaWxsOiBcIm9yYW5nZVwiLCBvcGFjaXR5OiAwLjV9KSxcbiAgICAgIFBsb3QuYXJlYVkocGRmZGF0YV9lcnIsIHtmaWx0ZXI6IGQgPT4gZC54ICA+PSB6Y3JpdF9yaWdodCAmJiBkLnR5cGUgPT0gXCJIMFwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCJzdGVlbGJsdWVcIiwgb3BhY2l0eTogMC43fSksXG4gICAgICBQbG90LmFyZWFZKHBkZmRhdGFfZXJyLCB7ZmlsdGVyOiBkID0+IGQueCAgPD0gemNyaXRfbGVmdCAmJiBkLnR5cGUgPT0gXCJIMFwiLCB4OiBcInhcIiwgeTogXCJwZGZcIiwgZmlsbDogXCJzdGVlbGJsdWVcIiwgb3BhY2l0eTogMC43fSksXG4gICAgICBQbG90LmxpbmUocGRmZGF0YV9lcnIsIHt4OiBcInhcIiwgeTogXCJwZGZcIiwgc3Ryb2tlIDogXCJ0eXBlXCIsIHN0cm9rZVdpZHRoOiAyfSlcbiAgICBdXG4gIH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibXUwX2VyciA9IGlucHV0c19lcnJbMF1cbm11QV9lcnIgPSBpbnB1dHNfZXJyWzFdXG5zaWdtYV9lcnIgPSBpbnB1dHNfZXJyWzJdXG5uX2VyciA9IGlucHV0c19lcnJbM11cbmFscGhhX2VyciA9IGlucHV0c19lcnJbNF1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwZGZkYXRhX2VyciA9IHtcbiAgY29uc3QgeCA9IGQzLnJhbmdlKC0xMCwgMTAsIDAuMDEpO1xuICBjb25zdCBub3JtcGRmSDAgPSB4Lm1hcCh4ID0+ICh7eDogeCwgcGRmOiBqc3RhdC5ub3JtYWwucGRmKHgsIG11MF9lcnIsIHNpZ21hX2Vyci9NYXRoLnNxcnQobl9lcnIpKSwgdHlwZTogXCJIMFwifSkpO1xuICBjb25zdCBub3JtcGRmSEEgPSB4Lm1hcCh4ID0+ICh7eDogeCwgcGRmOiBqc3RhdC5ub3JtYWwucGRmKHgsIG11QV9lcnIsIHNpZ21hX2Vyci9NYXRoLnNxcnQobl9lcnIpKSwgdHlwZTogXCJIQVwifSkpO1xuICByZXR1cm4gbm9ybXBkZkgwLmNvbmNhdChub3JtcGRmSEEpXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiemNyaXRfcmlnaHQgPSBtdTBfZXJyICsganN0YXQubm9ybWFsLmludigxLWFscGhhX2Vyci8yLCAwLCAxKSooc2lnbWFfZXJyL01hdGguc3FydChuX2VycikpXG56Y3JpdF9sZWZ0ID0gbXUwX2VyciAtIGpzdGF0Lm5vcm1hbC5pbnYoMS1hbHBoYV9lcnIvMiwgMCwgMSkqKHNpZ21hX2Vyci9NYXRoLnNxcnQobl9lcnIpKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJldGEgPSBqc3RhdC5ub3JtYWwuY2RmKHpjcml0X3JpZ2h0LCBtdUFfZXJyLCBzaWdtYV9lcnIvTWF0aC5zcXJ0KG5fZXJyKSkgLSBqc3RhdC5ub3JtYWwuY2RmKHpjcml0X2xlZnQsIG11QV9lcnIsIHNpZ21hX2Vyci9NYXRoLnNxcnQobl9lcnIpKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtYXhwZGYgPSBNYXRoLm1heChqc3RhdC5ub3JtYWwucGRmKG11MF9lcnIsIG11MF9lcnIsIHNpZ21hX2Vyci9NYXRoLnNxcnQobl9lcnIpKSwganN0YXQubm9ybWFsLnBkZihtdUFfZXJyLCBtdUFfZXJyLCBzaWdtYV9lcnIvTWF0aC5zcXJ0KG5fZXJyKSkpXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2lucHV0cycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd0b2dnbGVzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2lucHV0c19lcnInKSJ9XX0=
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./infer-bt.html" class="pagination-link" aria-label="Bootstrapping">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infer-twomean.html" class="pagination-link" aria-label="Comparing Two Population Means">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-ht.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/chenghanyustats/introstatsbook">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>