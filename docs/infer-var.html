<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An comprehensive introductory statistical data science book.">
<title>Introduction to Statistics - 17&nbsp; Inference About Variances</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infer-prop.html" rel="next">
<link href="./infer-twomean.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-var.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-samdist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Bayesian Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Nonparametric Methods</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#inference-for-one-population-variance" id="toc-inference-for-one-population-variance" class="nav-link active" data-scroll-target="#inference-for-one-population-variance"><span class="header-section-number">17.1</span> Inference for One Population Variance</a></li>
  <li><a href="#inference-for-comparing-two-population-variances" id="toc-inference-for-comparing-two-population-variances" class="nav-link" data-scroll-target="#inference-for-comparing-two-population-variances"><span class="header-section-number">17.2</span> Inference for Comparing Two Population Variances</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">17.3</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-var.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-var.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-infer-var" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><span style="color:blue"> <strong>Why Inference for Population Variances?</strong> </span></p>
<p>We’ve learned how to do inference about one and two population means in the previous chapters. But we care about not only the center but also the dispersion or variability of some population distribution. In this chapter we are going to learn some inference methods for population variances. If the target population follows normal distribution <span class="math inline">\(N(\mu, \sigma^2)\)</span>, our focus now is <span class="math inline">\(\sigma^2\)</span> or <span class="math inline">\(\sigma\)</span>, not the mean <span class="math inline">\(\mu\)</span>.</p>
<p>But why do we want to do inference about population variance? As population means, most of the time we do not know the true variance value, and in daily lives in some situations, we care about variation. For example, we would like to learn or control the variation in potency of some drug, say drug for lowering blood pressure. We hope the same amount or dose level of the drug provide the same effect on each individual. We don’t want some patients’ blood pressure is lowered a lot, but some other patient’s blood pressure is lowered just a little bit. In other words, we hope the drug effect is consistent or it has small variability. We want the new treatment can provide consistent potency and efficacy for all patients.</p>
<p>We also pay a lot of attention to the variance of stock prices because the higher the variance, the riskier the investment. We may want to monitor our financial portfolio, and the variability of our investment value so that we have long term financial stability.</p>
<p>Moreover, we may want to know if two population variances are equal, so that a correct or better method can be used. For example, in order to get higher statistical testing power, we use the two sample pooled <span class="math inline">\(t\)</span>-test if <span class="math inline">\(\sigma_1 = \sigma_2\)</span> or they are very close to each other.</p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- - <span style="color:blue"> The variation in potency of drugs</span>: *affects patients' health* -->
<!-- # ```{r, echo=FALSE, out.width="78%", fig.align='center'} -->
<!-- # knitr::include_graphics("./images/img-infer/drugs.jpeg") -->
<!-- # ``` -->
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<!-- - <span style="color:blue"> The variance of stock prices </span>: *the higher the variance, the riskier the investment* -->
<!-- # ```{r, echo=FALSE, out.width="78%", fig.align='center'} -->
<!-- # knitr::include_graphics("./images/img-infer/stock.jpeg") -->
<!-- # ``` -->
<!-- ::: -->
<!-- :::: -->
<!-- We want to know if $\sigma_1 = \sigma_2$, because the method we use depends on whether or not this is true.  -->
<!-- :::{.callout-note icon=false} -->
<!-- ## Which test did we learn that needs $\sigma_1 = \sigma_2$? -->
<!-- - Two-sample pooled test -->
<!-- ::: -->
<!-- <center> -->
<!-- **In some situations, we care about *variation*!** -->
<!-- </center> -->
<!-- <br> -->
<section id="inference-for-one-population-variance" class="level2" data-number="17.1"><h2 data-number="17.1" class="anchored" data-anchor-id="inference-for-one-population-variance">
<span class="header-section-number">17.1</span> Inference for One Population Variance</h2>
<!-- ------------------------------------------------------------------ -->
<p><span style="color:blue"> <strong>Inference for Population Variances</strong> </span></p>
<p>Let’s start with inference for one population variance. For point estimation, the most intuitive and straightforward point estimator for <span class="math inline">\(\sigma^2\)</span> is the sample variance <span class="math inline">\(S^2\)</span> defined as</p>
<p><span class="math display">\[S^2 = \frac{\sum_{i=1}^n(X_i - \overline{X})^2}{n-1}.\]</span></p>
<p>Note that the the denominator is <span class="math inline">\(n-1\)</span>, not the sample size <span class="math inline">\(n\)</span>. Note that <span class="math inline">\(S^2\)</span> is a random variable because each data point <span class="math inline">\(X_i\)</span> and <span class="math inline">\(\overline{X}\)</span> are assumed random variables. Dividing by <span class="math inline">\(n-1\)</span> instead of <span class="math inline">\(n\)</span> actually means something. <span class="math inline">\(S^2\)</span> is an <strong>unbiased estimator</strong> for <span class="math inline">\(\sigma^2\)</span>, i.e., <span class="math inline">\(E(S^2) = \sigma^2\)</span>, which is a good property of a point estimator. If we were able to repeatedly collect data sets of the same size <span class="math inline">\(n\)</span> lots of times, and for each data set we obtain its sample variance, then the average sample variance will be, if not exactly, very close to the true population variance.</p>
<p>The inference methods for <span class="math inline">\(\sigma^2\)</span> introduced in this chapter require the population to be <em>normally distributed</em>.</p>
<!-- - $S^2$ is an **unbiased estimator** for $\sigma^2$. -->
<!--   + This means $E(S^2) = \sigma^2$. -->
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 1.1em;">
<p>The inference methods can <em>work poorly if normality is violated, even if the sample is large</em>.</p>
</div>
</div>
</div>
<!-- # ```{r, echo=FALSE, out.width="40%", fig.align='center'} -->
<!-- # knitr::include_graphics("./images/img-infer/normal_dist.jpeg") -->
<!-- # ``` -->
<hr>
<p><span style="color:blue"> <strong>Chi-Square <span class="math inline">\(\chi^2\)</span> Distribution</strong> </span></p>
<p>Remember that when we do the inference for population means, we use either normal distribution or Student’s <span class="math inline">\(t\)</span> distribution. For the inference about the population variances, we use another distribution called <a href="http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/"><strong>chi-square <span class="math inline">\(\chi^2\)</span> distribution</strong></a> because the distribution is related to the sampling distribution of some variable involving <span class="math inline">\(S^2\)</span> and <span class="math inline">\(\sigma^2\)</span>. We’ll talk about that later. Let’s first learn a little about the chi-square <span class="math inline">\(\chi^2\)</span> distribution.</p>
<!-- - The inference for $\sigma^2$ involves the so called $\chi^2$ distribution. -->
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<!-- <br> -->
<p>As Student’s <span class="math inline">\(t\)</span> distribution, the chi-square <span class="math inline">\(\chi^2\)</span> distribution has one parameter, degrees of freedom <span class="math inline">\(df\)</span>. To denote a specific chi-square distribution, we write <span class="math inline">\(\chi^2_{df}\)</span> like <span class="math inline">\(\chi^2_{2}\)</span> for a chi-square distribution or variable with degrees of freedom two. <a href="#fig-chi-dist" class="quarto-xref">Figure&nbsp;<span>17.1</span></a> shows <span class="math inline">\(\chi^2\)</span> distributions with varying degrees of freedom. It is in general a <em>right-skewed</em> distribution, but it gets more and more symmetric as <span class="math inline">\(df\)</span> gets larger. Also, the <span class="math inline">\(\chi^2\)</span> distribution is defined over <em>positive</em> numbers, one hint why we use it for inferring variances because variance is non-negative, but normal or <span class="math inline">\(t\)</span> distribution is defined on the whole real line.</p>
<!-- - Parameter: degrees of freedom $df$ -->
<!-- - *Right-skewed* distribution -->
<!-- - Defined over *positive* numbers -->
<!-- - More symmetric as $df$ gets larger -->
<!-- - [Chi-Square Distribution](http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/) -->
<!-- ::: -->
<!-- :::{.column width="50%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chi-dist" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chi-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-var_files/figure-html/fig-chi-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chi-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.1: Illustration of <span class="math inline">\(\chi^2\)</span> distributions with varying degrees of freedom
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p><span style="color:red"> <strong><em>Upper Tail and Lower Tail of Chi-Square</em></strong> </span></p>
<p>Like standard normal and <span class="math inline">\(t\)</span> distribution, to do the inference for variances, we get to find or define critical values of a chi-square distribution. With some probability <span class="math inline">\(\alpha\)</span>, we define</p>
<ul>
<li><p><span class="math inline">\(\chi^2_{\frac{\alpha}{2},\, df}\)</span> is a <span class="math inline">\(\chi^2\)</span> value of a <span class="math inline">\(\chi^2\)</span> distribution with degrees of freedom <span class="math inline">\(df\)</span> such that it has area to the <strong>right</strong> of <span class="math inline">\(\alpha/2\)</span>.</p></li>
<li><p><span class="math inline">\(\chi^2_{1-\frac{\alpha}{2},\, df}\)</span> is a <span class="math inline">\(\chi^2\)</span> value of a <span class="math inline">\(\chi^2\)</span> distribution with degrees of freedom <span class="math inline">\(df\)</span> such that it has area to the <strong>left</strong> of <span class="math inline">\(\alpha/2\)</span>. In other words, it has area to the <strong>right</strong> of <span class="math inline">\(1 - \alpha/2\)</span>, and that’s why it has a subscript <span class="math inline">\(1-\frac{\alpha}{2}\)</span>.</p></li>
</ul>
<p><a href="#fig-chisq-alpha" class="quarto-xref">Figure&nbsp;<span>17.2</span></a> illustrates the <span class="math inline">\(\chi^2\)</span> critical values. Notice that in <span class="math inline">\(N(0, 1)\)</span>, <span class="math inline">\(z_{1-\frac{\alpha}{2}} = -z_{\frac{\alpha}{2}}\)</span>. Because of the symmetry of the distribution, the <span class="math inline">\(z\)</span>-value having area <span class="math inline">\(\alpha/2\)</span> on the right is the <span class="math inline">\(z\)</span>-value having area <span class="math inline">\(\alpha/2\)</span> on the left with a negative sign. However, the chi-square distribution is not symmetric, so <span class="math inline">\(\chi^2_{1-\frac{\alpha}{2},\,df} \ne -\chi^2_{\frac{\alpha}{2},\,df}\)</span>.</p>
<!-- but $\chi^2_{1-\frac{\alpha}{2},\,df} \ne -\chi^2_{\frac{\alpha}{2},\,df}$. -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chisq-alpha" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chisq-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-var_files/figure-html/fig-chisq-alpha-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chisq-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.2: Illustration of <span class="math inline">\(\alpha/2\)</span> significance levels for <span class="math inline">\(\chi^2_{df}\)</span> distribution
</figcaption></figure>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em>Sampling Distribution</em></strong> </span></p>
<p>When a random sample of size <span class="math inline">\(n\)</span> is from <span class="math inline">\(\color{red}{N(\mu, \sigma^2)}\)</span>, the following sample statistic has the <span class="math inline">\(\chi^2\)</span> sampling distribution with degrees of freedom <span class="math inline">\(n-1\)</span>: <span class="math display">\[ \frac{(n-1)S^2}{\sigma^2} \sim \chi^2_{n-1}. \]</span></p>
<p>I would like to stress again that the inference method for <span class="math inline">\(\sigma^2\)</span> introduced here can work poorly if the normality assumption is violated, even for large samples.</p>
<p>The sample statistic involves <span class="math inline">\(S^2\)</span> and <span class="math inline">\(\sigma^2\)</span>, so we have manipulate its sampling distribution to obtain the confidence interval for <span class="math inline">\(\sigma^2\)</span>, and use it as a test statistic in the hypothesis testing for <span class="math inline">\(\sigma^2\)</span>.</p>
<p><span style="color:red"> <strong><em><span class="math inline">\((1-\alpha)100\%\)</span> Confidence Interval for <span class="math inline">\(\sigma^2\)</span></em></strong> </span></p>
<p>The <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval for <span class="math inline">\(\sigma^2\)</span> is <span class="math display">\[\color{blue}{\boxed{\left( \frac{(n-1)S^2}{\chi^2_{\frac{\alpha}{2}, \, n-1}}, \frac{(n-1)S^2}{\chi^2_{1-\frac{\alpha}{2}, \, n-1}} \right)}}\]</span></p>
<p>How do we get this interval? We start with the sampling distribution of $ $.</p>
<ul>
<li>
<span class="math inline">\(P\left(\chi^2_{1-\frac{\alpha}{2}, \,n-1} &lt; \frac{(n-1)S^2}{\sigma^2} &lt; \chi^2_{\frac{\alpha}{2},\, n-1} \right) = 1 - \alpha\)</span> (Goal: isolate <span class="math inline">\(\sigma^2\)</span>)</li>
<li>
<span class="math inline">\(P\left(\frac{\chi^2_{1-\frac{\alpha}{2}, \,n-1}}{(n-1)S^2} &lt; \frac{1}{\sigma^2} &lt; \frac{\chi^2_{\frac{\alpha}{2},\, n-1}}{(n-1)S^2} \right) = 1 - \alpha\)</span> (divided by <span class="math inline">\((n-1)S^2\)</span>)</li>
<li>
<span class="math inline">\(P\left(\frac{(n-1)S^2}{\chi^2_{1-\frac{\alpha}{2}, \, n-1}} &gt; \sigma^2 &gt; \frac{(n-1)S^2}{\chi^2_{\frac{\alpha}{2}, \,n-1}} \right) = 1 - \alpha\)</span> (take reciprocal)</li>
<li>
<span class="math inline">\(P\left(\frac{(n-1)S^2}{\chi^2_{\frac{\alpha}{2}, \, n-1}} &lt; \sigma^2 &lt; \frac{(n-1)S^2}{\chi^2_{1-\frac{\alpha}{2}, \,n-1}} \right) = 1 - \alpha\)</span> (smaller value on the left)</li>
</ul>
<p>Be careful that the interval for <span class="math inline">\(\sigma^2\)</span> <em>cannot</em> be expressed as <span class="math inline">\((S^2 - m, S^2 + m)\)</span> for some margin of error <span class="math inline">\(m\)</span> anymore!</p>
<!-- :::{.callout-note} -->
<!-- - The CI for $\sigma^2$ **cannot** be expressed as $(S^2-m, S^2+m)$ anymore! -->
<!-- ::: -->
<hr>
<p><span style="color:blue"> <strong>Example: Supermodel Heights</strong> </span></p>
<div class="columns">
<div class="column" style="width:80%;">
<p>Listed below are heights (cm) for the simple random sample of 16 female supermodels.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">178</span>, <span class="fl">177</span>, <span class="fl">176</span>, <span class="fl">174</span>, <span class="fl">175</span>, <span class="fl">178</span>, <span class="fl">175</span>, <span class="fl">178</span>, </span>
<span>             <span class="fl">178</span>, <span class="fl">177</span>, <span class="fl">180</span>, <span class="fl">176</span>, <span class="fl">180</span>, <span class="fl">178</span>, <span class="fl">180</span>, <span class="fl">176</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The supermodels’ heights are normally distributed. Please construct a <span class="math inline">\(95\%\)</span> confidence interval for population standard deviation <span class="math inline">\(\sigma\)</span>.</p>
</div><div class="column" style="width:20%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/models.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1600"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>We just need to get what we need for constructing the interval from the sample data, sample size <span class="math inline">\(n\)</span>, sample variance <span class="math inline">\(s^2\)</span>, <span class="math inline">\(\alpha\)</span>, critical values <span class="math inline">\(\chi^2_{\alpha/2, n-1}\)</span> and <span class="math inline">\(\chi^2_{1-\alpha/2, n-1}\)</span>.</p>
<ul>
<li>
<span class="math inline">\(n = 16\)</span>, <span class="math inline">\(s^2 = 3.4\)</span>, <span class="math inline">\(\alpha = 0.05\)</span>.</li>
<li><span class="math inline">\(\chi^2_{\alpha/2, n-1} = \chi^2_{0.025, 15} = 27.49\)</span></li>
<li><span class="math inline">\(\chi^2_{1-\alpha/2, n-1} = \chi^2_{0.975, 15} = 6.26\)</span></li>
</ul>
<p>Note that we want the interval for <span class="math inline">\(\sigma\)</span>, not <span class="math inline">\(\sigma^2\)</span>, we take a square root of the lower and upper bound of the interval for <span class="math inline">\(\sigma^2\)</span>. The <span class="math inline">\(95\%\)</span> CI for <span class="math inline">\(\sigma\)</span> is <span class="math inline">\(\small \left( \sqrt{\frac{(n-1)s^2}{\chi^2_{\frac{\alpha}{2}, \, n-1}}}, \sqrt{\frac{(n-1)s^2}{\chi^2_{1-\frac{\alpha}{2}, \, n-1}}} \right) = \left( \sqrt{\frac{(16-1)(3.4)}{27.49}}, \sqrt{\frac{(16-1)(3.4)}{6.26}}\right) = (1.36, 2.85)\)</span></p>
<p>We are 95% confident that the height of supermodels has standard deviation between 1.36 and 2.85.</p>
<p><span style="color:red"> <strong><em>Confidence Interval Computation in R</em></strong> </span></p>
<p>We use <code><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq()</a></code> to get the <span class="math inline">\(\chi^2\)</span> critical values. The probability <span class="math inline">\(p\)</span> and the degrees of freedom <code>df</code> need to be specified. You should be able to understand the rest part of the code. Enjoy it.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## set values</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">16</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">heights</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co">## two chi-square critical values</span></span>
<span><span class="va">chi2_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">chi2_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## two bounds of CI for sigma2</span></span>
<span><span class="va">ci_sig2_lower</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">s2</span> <span class="op">/</span> <span class="va">chi2_right</span></span>
<span><span class="va">ci_sig2_upper</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">s2</span> <span class="op">/</span> <span class="va">chi2_left</span></span>
<span></span>
<span><span class="co">## two bounds of CI for sigma</span></span>
<span><span class="op">(</span><span class="va">ci_sig_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">ci_sig2_lower</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.362104</code></pre>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">ci_sig_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">ci_sig2_upper</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.853802</code></pre>
</div>
</div>
<p><span style="color:red"> <strong><em>Testing</em></strong> </span></p>
<p>Back to the example. Use <span class="math inline">\(\alpha = 0.05\)</span> to test the claim that “<em>supermodels have heights with a standard deviation that is less than the standard deviation, <span class="math inline">\(\sigma = 7.5\)</span> cm, for the population of women</em>”.</p>
<p><span style="color:red"> Step 1 </span></p>
<ul>
<li>We are comparing the <span class="math inline">\(\sigma\)</span> of heights of supermodels with the <span class="math inline">\(\sigma\)</span> of heights of women in general which is 7.5. So the hypothesize value <span class="math inline">\(\sigma_0\)</span> is 7.5. We wonder if supermodel height standard deviation is smaller than 7.5. Therefore, we have test <span class="math inline">\(H_0: \sigma = \sigma_0\)</span> vs.&nbsp;<span class="math inline">\(H_1: \sigma &lt; \sigma_0\)</span>, where <span class="math inline">\(\sigma_0 = 7.5\)</span> cm.</li>
</ul>
<p><span style="color:red"> Step 2 </span></p>
<ul>
<li><span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
<p><span style="color:red"> Step 3 </span></p>
<ul>
<li>The test statistic comes from the variable <span class="math inline">\(\chi_{test}^2 = \frac{(n-1)S^2}{\sigma^2}\)</span> that follows <span class="math inline">\(\chi^2_{n-1}\)</span> distribution. Under <span class="math inline">\(H_0\)</span>, we have <span class="math inline">\(\chi_{test}^2 = \frac{(n-1)s^2}{\sigma_0^2} = \frac{(16-1)(3.4)}{7.5^2} = 0.91\)</span>, drawn from <span class="math inline">\(\chi^2_{n-1}\)</span>.</li>
</ul>
<!-- ::::{.columns} --><!-- :::{.column width="50%"} --><p><span style="color:red"> Step 4-c </span></p>
<ul>
<li>This is a left-tailed test.</li>
<li>The critical value is <span class="math inline">\(\chi_{1-\alpha, df}^2 = \chi_{0.95, 15}^2 = 7.26\)</span>
</li>
</ul>
<p><span style="color:red"> Step 5-c </span></p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> if <span class="math inline">\(\chi_{test}^2 &lt; \chi_{1-\alpha, df}^2\)</span>.</li>
<li>Since <span class="math inline">\(0.91 &lt; 7.26\)</span>, we reject <span class="math inline">\(H_0\)</span>. <!-- ::: -->
</li>
</ul>
<!-- :::{.column width="50%"} --><!-- <br>  --><div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-var_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p><span style="color:red"> Step 6 </span></p>
<ul>
<li>There is sufficient evidence to support the claim that supermodels have heights with a standard deviation that is less than the standard deviation for the population of all women.</li>
</ul>
<p>We conclude that the <em>heights of supermodels vary less than heights of women in the general women population.</em></p>
<hr>
<p><span style="color:blue"> <strong>Back to Pooled t-Test</strong> </span></p>
<p>In a two sample pooled t-test, we assume</p>
<ul>
<li><span style="color:blue"> <span class="math inline">\(n_1 \ge 30\)</span> and <span class="math inline">\(n_2 \ge 30\)</span> or that both samples are drawn from normal populations. </span></li>
<li><span style="color:blue"> <span class="math inline">\(\sigma_1 = \sigma_2\)</span> </span></li>
</ul>
<p>We can use a QQ-plot (and normality tests, Anderson, Shapiro, etc.) to check the assumption of a normal distribution. We now learn how to check the assumption <span class="math inline">\(\sigma_1 = \sigma_2\)</span>.</p>
</section><section id="inference-for-comparing-two-population-variances" class="level2" data-number="17.2"><h2 data-number="17.2" class="anchored" data-anchor-id="inference-for-comparing-two-population-variances">
<span class="header-section-number">17.2</span> Inference for Comparing Two Population Variances</h2>
<p><span style="color:blue"> <strong>F Distribution</strong> </span></p>
<p>For comparing <em>two</em> population variances, we need another distribution called <a href="http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/"><strong><span class="math inline">\(F\)</span> distribution</strong></a>. The <span class="math inline">\(F\)</span> distribution has two parameters <span class="math inline">\(df_1\)</span> and <span class="math inline">\(df_2\)</span>, a hint why it is used for comparing <em>two</em> variances. We write a specific <span class="math inline">\(F\)</span> distribution <span class="math inline">\(F_{df_1, df_2}\)</span>. Second, the <span class="math inline">\(F\)</span> distribution is also right-skewed. Like <span class="math inline">\(\chi^2\)</span> distribution, the <span class="math inline">\(F\)</span> distribution is defined over <em>positive</em> numbers. <a href="#fig-f-dist" class="quarto-xref">Figure&nbsp;<span>17.3</span></a> illustrates <span class="math inline">\(F\)</span> distribution with different parameters. You can see that when <span class="math inline">\(df_1\)</span> and <span class="math inline">\(df_2\)</span> are both large, the <span class="math inline">\(F\)</span> distribution looks bell-shaped.</p>
<!-- - We use the **$F$ distribution** for inference about **two** population variances. -->
<!-- ::::{.columns} -->
<!-- :::{.column width="40%"} -->
<!-- <br> -->
<!-- - Two parameters: $df_1$, $df_2$ -->
<!-- - *Right-skewed* distribution -->
<!-- - Defined over *positive* numbers -->
<!-- - R Shiny app: [F Distribution](http://sctc.mscs.mu.edu:3838/sample-apps/Calculator/) -->
<!-- ::: -->
<!-- :::{.column width="60%"} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f-dist" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-f-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-var_files/figure-html/fig-f-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-f-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.3: F distributions with different parameters.
</figcaption></figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p><span style="color:red"> <strong><em>Upper and Lower Tail of F Distribution</em></strong> </span></p>
<p>We denote <span class="math inline">\(F_{\alpha, \, df_1, \, df_2}\)</span> as the <span class="math inline">\(F\)</span> quantile such that <span class="math inline">\(P(F_{df_1, df_2} &gt; F_{\alpha, \, df_1, \, df_2}) = \alpha\)</span>. With it, we can find the critical values <span class="math inline">\(F_{\frac{\alpha}{2}, \, df_1, \, df_2}\)</span> and <span class="math inline">\(F_{1-\frac{\alpha}{2}, \, df_1, \, df_2}\)</span> used in constructing the confidence interval for the ratio <span class="math inline">\(\sigma^2_1/\sigma^2_2\)</span> discussed next.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-f-sig-level" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-f-sig-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="infer-var_files/figure-html/fig-f-sig-level-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-f-sig-level-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.4: Illustration of <span class="math inline">\(\alpha/2\)</span> significance levels for <span class="math inline">\(F_{df_1, df_2}\)</span> distribution
</figcaption></figure>
</div>
</div>
</div>
<p><sample style="color:red"><strong><em>Sampling Distribution</em></strong> </sample></p>
<p>When random samples of sizes <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> have been <em>independently</em> drawn from two normally distributed populations, <span class="math inline">\(N(\mu_1, \sigma_1^2)\)</span> and <span class="math inline">\(N(\mu_2, \sigma_2^2)\)</span> respectively, the ratio <span class="math inline">\(\frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2}\)</span> has the <span class="math inline">\(F\)</span> sampling distribution <span class="math display">\[\frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2} \sim F_{n_1-1, \, n_2-1}.\]</span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 1.1em;">
<p>The order of degrees of freedom matters! <span class="math inline">\(F_{n_1-1, \, n_2-1} \ne F_{n_2-1, \, n_1-1}\)</span>. Please don’t mess around.</p>
</div>
</div>
</div>
<p><span style="color:red"> <strong><em><span class="math inline">\((1-\alpha)100\%\)</span> Confidence Interval for <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span></em></strong> </span></p>
<p>From the sampling distribution of the ratio, the <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval for <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span> is <span class="math display">\[\color{blue}{\boxed{\left( \frac{s_1^2/s_2^2}{F_{\alpha/2, \, n_1 - 1, \, n_2 - 1}}, \frac{s_1^2/s_2^2}{F_{1-\alpha/2, \, \, n_1 - 1, \, n_2 - 1}} \right)}}\]</span></p>
<p>How do we get the interval? Not surprising. We start with the sampling distribution of <span class="math inline">\(\frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2}\)</span>.</p>
<ul>
<li><p><span class="math inline">\(P\left(F_{1-\alpha/2, \, n_1 - 1, \, n_2 - 1} &lt; \frac{S_1^2/S_2^2}{\sigma_1^2/\sigma_2^2} &lt; F_{\alpha/2, \, n_1 - 1, \, n_2 - 1} \right) = 1 - \alpha\)</span> (Goal: isolate <span class="math inline">\(\sigma_1^2/\sigma_2^2\)</span>)</p></li>
<li><p><span class="math inline">\(P\left(\frac{1}{F_{\alpha/2, \, n_1 - 1, \, n_2 - 1}} &lt; \frac{\sigma_1^2/\sigma_2^2}{S_1^2/S_2^2} &lt; \frac{1}{F_{1-\alpha/2, \, n_1 - 1, \, n_2 - 1}} \right) = 1 - \alpha\)</span> (take reciprocal)</p></li>
<li><p><span class="math inline">\(P\left(\frac{S_1^2/S_2^2}{F_{\alpha/2, \, n_1 - 1, \, n_2 - 1}} &lt; \frac{\sigma_1^2}{\sigma_2^2} &lt; \frac{S_1^2/S_2^2}{F_{1-\alpha/2, \, n_1 - 1, \, n_2 - 1}} \right) = 1 - \alpha\)</span> (times <span class="math inline">\(S_1^2/S_2^2\)</span>)</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The confidence interval for <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span> <em>cannot</em> be expressed as <span class="math inline">\(\left(\frac{s_1^2}{s_2^2}-m, \frac{s_1^2}{s_2^2} + m\right)\)</span> anymore!</p>
</div>
</div>
<hr>
<p><span style="color:blue"> <strong>F test for comparing <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span></strong> </span></p>
<p><span style="color:red"> Step 1 </span></p>
<p>For comparing <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span>, the test can be either right-tailed or two-tailed. Left-tailed testing is not necessary because we can always define the population whose variance is hypothetically larger than the variance of another population as the first population.</p>
<ul>
<li>Right-tailed: <span style="color:blue"> <span class="math inline">\(\small \begin{align} &amp;H_0: \sigma_1 \le \sigma_2 \\ &amp;H_1: \sigma_1 &gt; \sigma_2 \end{align}\)</span> </span>
</li>
<li>Two-tailed: <span style="color:green"> <span class="math inline">\(\small \begin{align} &amp;H_0: \sigma_1 = \sigma_2 \\ &amp;H_1: \sigma_1 \ne \sigma_2 \end{align}\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 2 </span></p>
<ul>
<li><span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
<p><span style="color:red"> Step 3 </span></p>
<ul>
<li>Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\sigma_1 = \sigma_2\)</span>, and the test statistic is <span class="math display">\[\small F_{test} = \frac{s_1^2/s_2^2}{\sigma_1^2/\sigma_2^2} = \frac{s_1^2}{s_2^2} \sim F_{n_1-1, \, n_2-1}\]</span> The denominator is gone because the ratio is one.</li>
</ul>
<p><span style="color:red"> Step 4-c </span></p>
<ul>
<li>Right-tailed: <span style="color:blue"> <span class="math inline">\(F_{\alpha, \, n_1-1, \, n_2-1}\)</span> </span>.</li>
<li>Two-tailed: <span style="color:green"> <span class="math inline">\(F_{\alpha/2, \, n_1-1, \, n_2-1}\)</span> or <span class="math inline">\(F_{1-\alpha/2, \, n_1-1, \, n_2-1}\)</span> </span>
</li>
</ul>
<p><span style="color:red"> Step 5-c </span></p>
<ul>
<li>Right-tailed: reject <span class="math inline">\(H_0\)</span> if <span style="color:blue"> <span class="math inline">\(F_{test} \ge F_{\alpha, \, n_1-1, \, n_2-1}\)</span></span>.</li>
<li>Two-tailed: reject <span class="math inline">\(H_0\)</span> if <span style="color:green"> <span class="math inline">\(F_{test} \ge F_{\alpha/2, \, n_1-1, \, n_2-1}\)</span> or <span class="math inline">\(F_{test} \le F_{1-\alpha/2, \, n_1-1, \, n_2-1}\)</span></span>
</li>
</ul>
<hr>
<p><span style="color:blue"> <strong>Example: Weight Loss</strong> </span></p>
<p>This is our previous example.</p>
<div class="columns">
<div class="column" style="width:70%;">
<p><em>A study was conducted to see the effectiveness of a weight loss program. Two groups (Control and Experimental) of 10 subjects were selected. The two populations are normally distributed and have the same standard deviation.</em></p>
</div><div class="column" style="width:30%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/weight.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:89.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><em>The data on weight loss was collected at the end of six months.</em></p>
<ul>
<li>
<strong>Control</strong>: <span class="math inline">\(n_1 = 10\)</span>, <span class="math inline">\(\overline{x}_1 = 2.1\, lb\)</span>, <span class="math inline">\(s_1 = 0.5\, lb\)</span>
</li>
<li>
<strong>Experimental</strong>: <span class="math inline">\(n_2 = 10\)</span>, <span class="math inline">\(\overline{x}_2 = 4.2\, lb\)</span>, <span class="math inline">\(s_2 = 0.7\, lb\)</span>
</li>
</ul>
<!-- - Assumptions: --><!--   + <span style="color:blue"> $\sigma_1 = \sigma_2$ </span> --><!--   + The weight loss for both groups are normally distributed. --><p><span style="color:red"> <strong><em>Check if <span class="math inline">\(\sigma_1 = \sigma_2\)</span></em></strong> </span></p>
<ul>
<li>
<span class="math inline">\(n_1 = 10\)</span>, <span class="math inline">\(s_1 = 0.5 \, lb\)</span>
</li>
<li>
<span class="math inline">\(n_2 = 10\)</span>, <span class="math inline">\(s_2 = 0.7 \, lb\)</span>
</li>
</ul>
<p><span style="color:red"> Step 1 </span></p>
<ul>
<li><span class="math inline">\(\begin{align} &amp;H_0: \sigma_1 = \sigma_2 \\ &amp;H_1: \sigma_1 \ne \sigma_2 \end{align}\)</span></li>
</ul>
<p><span style="color:red"> Step 2 </span></p>
<ul>
<li><span class="math inline">\(\alpha = 0.05\)</span></li>
</ul>
<p><span style="color:red"> Step 3 </span></p>
<ul>
<li>The test statistic is <span class="math inline">\(F_{test} = \frac{s_1^2}{s_2^2} = \frac{0.5^2}{0.7^2} = 0.51\)</span>.</li>
</ul>
<p><span style="color:red"> Step 4-c </span></p>
<ul>
<li>This is a two-tailed test.</li>
<li>The critical value is <span class="math inline">\(F_{0.05/2, \, 10-1, \, 10-1} = 4.03\)</span> or <span class="math inline">\(F_{1-0.05/2, \, 10-1, \, 10-1} = 0.25\)</span>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-var_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span style="color:red"> Step 5-c </span></p>
<ul>
<li>Is <span class="math inline">\(F_{test} &gt; 4.03\)</span> or <span class="math inline">\(F_{test} &lt; 0.25\)</span>?
<ul>
<li>No.&nbsp;</li>
</ul>
</li>
</ul>
<p><span style="color:red"> Step 6 </span></p>
<ul>
<li>The evidence is not sufficient to reject the claim that <span class="math inline">\(\sigma_1 = \sigma_2\)</span>.</li>
</ul>
<p><span style="color:red"> <strong><em>95% CI for <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span></em></strong> </span></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="50%"} -->
<ul>
<li><span class="math inline">\(\small F_{\alpha/2, \, df_1, \, df_2} = F_{0.05/2, \, 10-1, \, 10-1} = 4.03\)</span></li>
<li><span class="math inline">\(\small F_{1-\alpha/2, \, df_1, \, df_2} = F_{1-0.05/2, \, 10-1, \, 10-1} = 0.25\)</span></li>
<li><span class="math inline">\(\small \frac{s_1^2}{s_2^2} = \frac{0.5^2}{0.7^2} = 0.51\)</span></li>
<li>The 95% CI for <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span> is <span class="math display">\[\small \begin{align} &amp;\left( \frac{s_1^2/s_2^2}{F_{\alpha/2, \, df_1, \, df_2}}, \frac{s_1^2/s_2^2}{F_{1-\alpha/2, \, df_1, \, df_2}} \right) \\ &amp;= \left( \frac{0.51}{4.03}, \frac{0.51}{0.25} \right) = \left(0.127, 2.05\right)\end{align}\]</span> <!-- ::: -->
</li>
</ul>
<!-- :::{.column width="50%"} --><div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="infer-var_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<p>We are 95% confident that the ratio <span class="math inline">\(\sigma_1^2 / \sigma_2^2\)</span> is between 0.127 and 2.04. Because one is included in this interval, meaning that <span class="math inline">\(\sigma^2_1 = \sigma^2_2\)</span>, it leads to the same conclusion as the F test.</p>
<p><span style="color:red"> <strong><em>Implementing F-test in R</em></strong> </span></p>
<p>We use <code><a href="https://rdrr.io/r/stats/Fdist.html">qf()</a></code> to find the <span class="math inline">\(F\)</span> critical values. <!-- - **`qf(p = alpha, df1 = n1 - 1, df2 = n2 - 1, lower.tail = FALSE)`** to find $F_{\alpha, \, n_1-1, \, n_2-1}$. --></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="49%"} -->
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## set values</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fl">10</span>; <span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>; <span class="va">s2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co">## 95% CI for sigma_1^2 / sigma_2^2</span></span>
<span><span class="va">f_small</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df1 <span class="op">=</span> <span class="va">n1</span> <span class="op">-</span> <span class="fl">1</span>, df2 <span class="op">=</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">1</span>,lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">f_big</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df1 <span class="op">=</span> <span class="va">n1</span> <span class="op">-</span> <span class="fl">1</span>, df2 <span class="op">=</span> <span class="va">n2</span> <span class="op">-</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## lower bound</span></span>
<span><span class="op">(</span><span class="va">s1</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">s2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">f_big</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1267275</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## upper bound</span></span>
<span><span class="op">(</span><span class="va">s1</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">s2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">f_small</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.054079</code></pre>
</div>
</div>
<!-- ::: -->
<!-- :::{.column width="2%"} -->
<!-- ::: -->
<!-- :::{.column width="49%"} -->
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Testing sigma_1 = sigma_2</span></span>
<span><span class="op">(</span><span class="va">test_stats</span> <span class="op">&lt;-</span> <span class="va">s1</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">s2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5102041</code></pre>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<div style="font-size: 1.1em;">
<p>If we have the entire two samples data, we can use the R built-in function <code>var.test(x, y, alternative = "two.sided")</code> to perform a <span class="math inline">\(F\)</span> test to compare the variances of two samples from normal populations. The arguments <code>x</code> and <code>y</code> are numeric vectors of data values. Argument <code>alternative</code> must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or <code>"less"</code>.</p>
</div>
</div>
</div>
</section><section id="exercises" class="level2" data-number="17.3"><h2 data-number="17.3" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">17.3</span> Exercises</h2>
<ol type="1">
<li>The data about male and female pulse rates are summarized below.
<ol type="a">
<li>Construct a 95% CI for <span class="math inline">\(\sigma_{male}\)</span> of pulse rates for males.</li>
<li>Construct a 95% CI for <span class="math inline">\(\sigma_{male}/\sigma_{female}\)</span>.</li>
<li>Does it appear that the population standard deviations for males and females are different? Why or why not?</li>
</ol>
</li>
</ol>
<center>
<table class="caption-top table">
<thead><tr class="header">
<th></th>
<th>Male</th>
<th>Female</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\overline{x}\)</span></td>
<td>71</td>
<td>75</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s\)</span></td>
<td>9</td>
<td>12</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n\)</span></td>
<td>14</td>
<td>12</td>
</tr>
</tbody>
</table>
</center>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./infer-twomean.html" class="pagination-link" aria-label="Comparing Two Population Means">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infer-prop.html" class="pagination-link" aria-label="Inference About Proportions">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-var.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>