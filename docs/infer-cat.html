<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="An introductory statistical data science book for STEM students.">
<title>Introduction to Statistics - 19&nbsp; Inference about Categorical Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infer-p.html" rel="next">
<link href="./infer-prop.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="custom.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-cat.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/chenghanyustats/introstatsbook" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introduction-to-Statistics.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics and Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Science of Data and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Collection and Data Type</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tool foR Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./datasummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Numerical Measures of Data</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-define.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Definition of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability Rules and Bayes Formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-disc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Random Sampling and Sampling Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-llnclt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Law of Large Numbers and Central Limit Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Point and Interval Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-ht.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-twomean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Comparing Two Population Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference About Variances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-cat.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-p.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Bayesian Thinking and Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infer-nonpar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-multicomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Multiple Comparison*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Two-Way ANOVA*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multiple Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Bayesian Linear Regression*</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">References</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-r_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a-py_prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Python Programming</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#test-of-goodness-of-fit" id="toc-test-of-goodness-of-fit" class="nav-link active" data-scroll-target="#test-of-goodness-of-fit"><span class="header-section-number">19.1</span> Test of Goodness of Fit</a></li>
  <li><a href="#test-of-independence" id="toc-test-of-independence" class="nav-link" data-scroll-target="#test-of-independence"><span class="header-section-number">19.2</span> Test of Independence</a></li>
  <li><a href="#test-of-homogeneity" id="toc-test-of-homogeneity" class="nav-link" data-scroll-target="#test-of-homogeneity"><span class="header-section-number">19.3</span> Test of Homogeneity</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">19.4</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-cat.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./infer.html">Statistical Inference</a></li><li class="breadcrumb-item"><a href="./infer-cat.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-infer-cat" class="quarto-section-identifier"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference about Categorical Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In the previous chapter, we talk about the one-sample and two-sample proportion tests, testing either the proportion of some category is equal to, greater than, or less than some value, or whether or not the two proportions of the same category from the two groups are equal, or which one is larger. The idea starts from the binomial distribution where the categorical variable being studied has only two possible categories.</p>
<p>In our daily lives, there are lots of categorical variables that have more than two categories, for example, car brands, eye colors, etc. In this chapter, we are going to learn two specific tests: <strong>test of goodness-of-fit</strong> and <strong>test of independence</strong> that generally consider more than two categories and the associated proportions.</p>
<p><span style="color:blue"> <strong>Categorical Variable with More Than 2 Categories</strong> </span></p>
<!-- ::::{.columns} -->
<!-- :::{.column width="49%"} -->
<p>Suppose a categorical variable has <span class="math inline">\(k\)</span> categories <span class="math inline">\(A_1, \dots, A_k\)</span>, <span class="math inline">\(k \ge 2\)</span>. For example, we may want to know the eye color distribution of Marquette students. We can have <span class="math inline">\(A_1 = black\)</span>, <span class="math inline">\(A_2 = brown\)</span>, <span class="math inline">\(A_3 = blue\)</span>, <span class="math inline">\(A_4 = green\)</span>, and our data set may be like</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;">Subject</th>
<th style="text-align: center;"><span class="math inline">\(A_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(A_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: center;"><span class="math inline">\(A_k\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\vdots\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>So the first guy has black eyes, and the second one has blown eyes, and so on. <!-- ::: --></p>
<!-- :::{.column width="2%"} -->
<!-- ::: -->
<!-- :::{.column width="49%"} -->
<p>With the size <span class="math inline">\(n\)</span>, for categories <span class="math inline">\(A_1, \dots , A_k\)</span>, their observed count is <span class="math inline">\(O_1, \dots, O_k\)</span>, and <span class="math inline">\(\sum_{i=1}^kO_i = n\)</span>. The count information can be summarized in the one-way count/frequency table:</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(A_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(A_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: center;"><span class="math inline">\(A_k\)</span></th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;"><span class="math inline">\(O_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_k\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
</tr></tbody>
</table>
<p>For example, if we have <span class="math inline">\(n = 100\)</span> students, and 30 have black eyes, 35 have brown eyes, 20 have blue eyes, and 15 have green eyes, then <span class="math inline">\(O_1 = 30\)</span>, <span class="math inline">\(O_2 = 35\)</span>, <span class="math inline">\(O_3 = 20\)</span>, and <span class="math inline">\(O_4 = 15\)</span>. This is the sample data, and we have the sample proportion for each category, <span class="math inline">\(\hat{\pi}_i =O_i/n\)</span>, <span class="math inline">\(i = 1, \dots, k.\)</span> In the example, <span class="math inline">\(\hat{\pi}_1 = 0.3\)</span>, <span class="math inline">\(\hat{\pi}_2 = 0.35\)</span>,<span class="math inline">\(\hat{\pi}_3 = 0.2\)</span>, and <span class="math inline">\(\hat{\pi}_4 = 0.15\)</span>.</p>
<p>Of course this is not the true proportion or distribution of eye colors, and our goal is to test whether or not the observed distribution follows some hypothesized distribution, for example the eye color distribution of all Americans. Also, we may be interested in whether or not the distributions from the two groups are more or less the same. For example, the eye color distribution of male and female students. <!-- (test of homogeneity) --></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The count of categories of a categorical variable having more than two categories is associated with the <a href="https://en.wikipedia.org/wiki/Multinomial_distribution"><strong>multinomial distribution</strong></a>. The binomial distribution is a special case of the multinomial distribution when <span class="math inline">\(k = 2\)</span>.</li>
<li>Here we use <span class="math inline">\(O_i\)</span> to represent the observed count of category <span class="math inline">\(A_i\)</span>. It works the same as the <span class="math inline">\(y\)</span> in the previous binomial case. We stick with <span class="math inline">\(O_i\)</span> notations in order to be consistent with most of other statistics books.</li>
</ul>
</div>
</div>
<!-- ::: -->
<!-- :::: -->
<section id="test-of-goodness-of-fit" class="level2" data-number="19.1"><h2 data-number="19.1" class="anchored" data-anchor-id="test-of-goodness-of-fit">
<span class="header-section-number">19.1</span> Test of Goodness of Fit</h2>
<!-- Let's look at the following example.  -->
<!-- <span style="color:red"> ***Example*** </span> -->
<p>A citizen in Wauwatosa, WI is curious about the question:</p>
<blockquote class="blockquote">
<p><em>Are the selected jurors racially representative of the population?</em></p>
</blockquote>
<div class="columns">
<div class="column" style="width:50%;">
<!-- - *Are the selected jurors racially representative of the population?* -->
<p>Well the idea is that if the jury is representative of the population, once we collect our sample of juries, the sample proportions should reflect the proportions of the population of eligible jurors (i.e.&nbsp;registered voters).</p>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/diversity.jpeg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Source: https://stock.adobe.com/images/diverse-group-of-business-people/116680830</figcaption></figure>
</div>
</div>
</div>
</div>
</div>
<p>Suppose from the government we learn the distribution of registered voters based on races. We then collect 275 jurors racial information, and see if the racial distribution of the sample is kind of consistent with the registered voter racial distribution. The count information is summarized in the table below.</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">White</th>
<th style="text-align: center;">Black</th>
<th style="text-align: center;">Hispanic</th>
<th style="text-align: center;">Asian</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Representation in juries</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">275</td>
</tr>
<tr class="even">
<td style="text-align: center;">Registered voters</td>
<td style="text-align: center;">0.72</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<p>The first thing we can do is convert the count into proportion or relative frequency, so that the sample proportion and the target proportion can be easily paired and compared.</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">White</th>
<th style="text-align: center;">Black</th>
<th style="text-align: center;">Hispanic</th>
<th style="text-align: center;">Asian</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Representation in juries</td>
<td style="text-align: center;">0.745</td>
<td style="text-align: center;">0.095</td>
<td style="text-align: center;">0.091</td>
<td style="text-align: center;">0.069</td>
<td style="text-align: center;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Registered voters</td>
<td style="text-align: center;">0.72</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<p>While the proportions in the juries do not precisely represent the population proportions, it is unclear whether these data provide convincing evidence that the sample is not representative. If the jurors really were randomly sampled from the registered voters, we might expect small differences due to chance. However, unusually large differences may provide convincing evidence that the juries were not representative. Specifically, we want a test to answer the question</p>
<blockquote class="blockquote">
<p>Are the proportions of juries <em>close enough</em> to the proportions of registered voters, so that we are confident saying that the jurors really were <em>randomly sampled</em> from the registered voters?</p>
</blockquote>
<!-- :::{.callout-note icon=false} -->
<!-- ## Are the proportions of juries *close enough* to the proportions of registered voters, so that we are confident saying that the jurors really were *randomly sampled* from the registered voters? -->
<!-- ::: -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>As the binomial case, the multi-class counts <span class="math inline">\(O_1, O_2 \dots O_k\)</span> and proportions <span class="math inline">\(O_1/n, O_2/n \dots O_k/n\)</span> are random variables before actual data are collected. Their value varies from sample to sample.</p>
</div>
</div>
<p>The test we need is the goodness-of-fit test.</p>
<hr>
<p><span style="color:blue"> <strong>Goodness-of-Fit Test</strong> </span></p>
<p>A <strong>goodness-of-fit test</strong> tests the hypothesis that the observed frequency distribution fits or conforms to some claim distribution. In the jury example, our observed (relative) frequency distribution is <span class="math inline">\((0.745, 0.095, 0.091, 0.069)\)</span> and the claim distribution is the racial distribution of registered voters <span class="math inline">\((0.72, 0.07, 0.12, 0.09)\)</span>. The jury representatives work as our sample, and the registered voters is the population. We wonder if the sample is representative of the general population. If yes, the sample should looks like the population, and sample distribution should conform to the population distribution.</p>
<p>Here is the question: <em>“If the individuals are randomly selected to serve on a jury, about how many of the 275 people would we expect to be white? How about black?”</em> We ask this question because we want to know how the jury distribution looks like if the distribution does follow the distribution of the registered voters. If what we expect to see is far from what we observe, then the jury is probably not randomly sampled from the registered voters. This matches our testing rationale. We do the testing under the null hypothesis, the scenario that the observed frequency distribution fits or conforms to some claim distribution.</p>
<!-- :::{.callout-note icon=false} -->
<!-- ## In the jury example, what is our observed frequency distribution, and what is our claim distribution? -->
<!-- ::: -->
<!-- :::{.callout-note icon=false} -->
<!-- ## If the individuals are randomly selected to serve on a jury, about how many of the 275 people would we expect to be white? How about black? -->
<!-- ::: -->
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">White</th>
<th style="text-align: center;">Black</th>
<th style="text-align: center;">Hispanic</th>
<th style="text-align: center;">Asian</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">Registered voters</td>
<td style="text-align: center;">0.72</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.12</td>
<td style="text-align: center;">0.09</td>
</tr></tbody>
</table>
<p>According to the claimed distribution, <span class="math inline">\(72\%\)</span> of the population is white, so we would expect about <span class="math inline">\(72\%\)</span> of the jurors to be white. In other words, we expect to see <span class="math inline">\(0.72 \times 275 = 198\)</span> white jurors in the sample of 275 jury members. We expect about <span class="math inline">\(7\%\)</span> of the jurors to be black. This corresponds to about <span class="math inline">\(0.07 \times 275 = 19.25\)</span> black jurors in the sample. The table below shows the <strong>observed</strong> count and the <strong>expected</strong> count if members are randomly selected for each ethnic group. In general, the expected count of a category is the total count times the proportion or probability of the category.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">White</th>
<th style="text-align: center;">Black</th>
<th style="text-align: center;">Hispanic</th>
<th style="text-align: center;">Asian</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">
<strong>Observed</strong> Count <span class="math inline">\(O_i\)</span>
</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">275</td>
</tr>
<tr class="even">
<td style="text-align: center;">
<strong>Expected</strong> Count <span class="math inline">\(E_i\)</span>
</td>
<td style="text-align: center;"><strong>198</strong></td>
<td style="text-align: center;"><strong>19.25</strong></td>
<td style="text-align: center;"><strong>33</strong></td>
<td style="text-align: center;"><strong>24.75</strong></td>
<td style="text-align: center;">275</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Population Proportion <span class="math inline">\((H_0)\)</span>
</td>
<td style="text-align: center;"><strong>0.72</strong></td>
<td style="text-align: center;"><strong>0.07</strong></td>
<td style="text-align: center;"><strong>0.12</strong></td>
<td style="text-align: center;"><strong>0.09</strong></td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<p>While some sampling variation is expected, the observed count and expected count should be similar if there was no bias in selecting the members of the jury. But how similar is similar enough? We want to test whether the differences are strong enough to provide convincing evidence that the jurors were not selected from a random sample of all registered voters.</p>
<p><span style="color:red"> <strong><em>Goodness-of-Fit Test Example</em></strong> </span></p>
<p>Before we introduce the test procedure, to have better performance the goodness-of-fit test requires <em>each expected count is as least five.</em> The higher the better.</p>
<p>In words, our hypotheses are <span style="color:blue"> <span class="math display">\[\begin{align} &amp;H_0: \text{No racial bias in who serves on a jury, and } \\ &amp;H_1: \text{There is racial bias in juror selection} \end{align}\]</span> </span></p>
<p>If the true racial distribution of juries is <span class="math inline">\((\pi_1, \pi_2, \pi_3, \pi_4)\)</span>, where</p>
<ul>
<li>
<span class="math inline">\(\pi_1\)</span> is the proportion of White in jury</li>
<li>
<span class="math inline">\(\pi_2\)</span> is the proportion of Black in jury</li>
<li>
<span class="math inline">\(\pi_3\)</span> is the proportion of Hispanic in jury</li>
<li>
<span class="math inline">\(\pi_4\)</span> is the proportion of Asian in jury</li>
</ul>
<p>we want to know if the distribution conforms to the claim racial distribution of register voters <span class="math inline">\((\pi_1^0, \pi_2^0, \pi_3^0, \pi_4^0) = (0.72, 0.07, 0.12, 0.09)\)</span> where</p>
<ul>
<li>
<span class="math inline">\(\pi_1^0\)</span> is the proportion of White in register voters</li>
<li>
<span class="math inline">\(\pi_2^0\)</span> is the proportion of Black in register voters</li>
<li>
<span class="math inline">\(\pi_3^0\)</span> is the proportion of Hispanic in register voters</li>
<li>
<span class="math inline">\(\pi_4^0\)</span> is the proportion of Asian in register voters</li>
</ul>
<p>In general, we can rewrite our hypotheses in mathematical notations: <span style="color:blue"> <span class="math display">\[\begin{align} &amp;H_0: \pi_1 = \pi_1^0,  \pi_2 = \pi_2^0, \dots, \pi_k = \pi_k^0\\ &amp;H_1: \pi_i \ne \pi_i^0 \text{ for some } i \end{align}\]</span> </span></p>
<p>Note that <span class="math inline">\(H_1\)</span> is <em>not</em> <span class="math inline">\(\pi_i \ne \pi_i^0 \text{ for all } i\)</span>. As long as one <span class="math inline">\(\pi_i \ne \pi_i^0\)</span> holds, the <span class="math inline">\(H_0\)</span> statement is not true.</p>
<p>The test statistic is a chi-squared statistic from the chi-squared distribution with degrees of freedom <span class="math inline">\(k-1\)</span>. Under <span class="math inline">\(H_0\)</span>, the test statistic is</p>
<p><span style="color:blue"> <span class="math display">\[\chi^2_{test} = \frac{(O_1 - E_1)^2}{E_1} + \frac{(O_2 - E_2)^2}{E_2} + \cdots + \frac{(O_k - E_k)^2}{E_k},\]</span> where <span class="math inline">\(O_i\)</span> is the observed count of the <span class="math inline">\(i\)</span>-th category, and <span class="math inline">\(E_i = n\pi_i^0\)</span> is the expected count of the <span class="math inline">\(i\)</span>-th category, <span class="math inline">\(i = 1, \dots, k.\)</span> </span></p>
<p>The goodness-of-fit test is a <strong>chi-squared test</strong> that is always <em>right-tailed</em>. So we reject <span class="math inline">\(H_0\)</span> if <span style="color:blue"> <span class="math inline">\(\chi^2_{test} &gt; \chi^2_{\alpha, k-1}\)</span>. </span> Look at the test statistic formula carefully. When will the test statistic be large or the evidence be strong? The numerator term <span class="math inline">\((O_i-E_i)^2\)</span> is the squared distance between the observed and expected counts. When the two are farther away from each other, the test statistic or evidence will be stronger. As a result, when the observed count distribution is more inconsistent with the distribution we expect to see, it is more likely to conclude that the sample is not randomly drawn from the claim or assumed population distribution.</p>
<p>Back to our example.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">White</th>
<th style="text-align: center;">Black</th>
<th style="text-align: center;">Hispanic</th>
<th style="text-align: center;">Asian</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Observed Count</td>
<td style="text-align: center;"><span class="math inline">\(O_1 = 205\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_2 = 26\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_3 = 25\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O_4 = 19\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Expected Count</td>
<td style="text-align: center;"><span class="math inline">\(E_1 = 198\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E_2 = 19.25\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E_3 = 33\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E_4 = 24.75\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Proportion under <span class="math inline">\(H_0\)</span>
</td>
<td style="text-align: center;"><span class="math inline">\(\pi_1^0 = 0.72\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\pi_2^0 = 0.07\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\pi_3^0 = 0.12\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\pi_4^0 = 0.09\)</span></td>
</tr>
</tbody>
</table>
<p>Under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\chi^2_{test} = \frac{(205 - 198)^2}{198} + \frac{(26 - 19.25)^2}{19.25} + \frac{(25 - 33)^2}{33} + \frac{(19 - 24.75)^2}{24.75} = 5.89\)</span>.</p>
<p>With <span class="math inline">\(\alpha = 0.05\)</span>, <span class="math inline">\(\chi^2_{0.05, 3} = 7.81\)</span>. Because <span class="math inline">\(5.89 &lt; 7.81\)</span>, we fail to reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span>. Therefore, we do not have convincing evidence of racial bias in the juror selection process.</p>
<p><span style="color:red"> <strong><em>Goodness-of-Fit Test in R</em></strong> </span></p>
<p>Below is an example of how to perform a goodness-of-fit test in R. Because the goodness-of-fit test is a chi-squared test, we use the function <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code>. The argument <code>x</code> is the observed count vector of length <span class="math inline">\(k\)</span>, and the argument <code>p</code> is the hypothesized proportion distribution which is a vector of probabilities of the same length as <code>x</code>. The function does not provide the critical value, but it gives us the <span class="math inline">\(p\)</span>-value. Since the <span class="math inline">\(p\)</span>-value is greater than <span class="math inline">\(0.05\)</span>, we do not reject <span class="math inline">\(H_0\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">205</span>, <span class="fl">26</span>, <span class="fl">25</span>, <span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">pi_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.72</span>, <span class="fl">0.07</span>, <span class="fl">0.12</span>, <span class="fl">0.09</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Use chisq.test() function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">obs</span>, p <span class="op">=</span> <span class="va">pi_0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  obs
X-squared = 5.8896, df = 3, p-value = 0.1171</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The chi-squared test can be used in two-sided one-sample proportion test. Suppose we are doing the following test</p>
<p><span class="math display">\[\begin{align} &amp;H_0: \pi_1 = 0.5,  \pi_2 = 0.5 \\ &amp;H_1: \pi_i \ne 0.5 \text{ for some } i \end{align}\]</span></p>
<p>Because there are only two categories, we automatically know the value of <span class="math inline">\(\pi_2\)</span> when we know the value of <span class="math inline">\(\pi_1\)</span> as <span class="math inline">\(\pi_2 = 1 - \pi_1\)</span>. So the hypothesis can be reduced to</p>
<p><span class="math display">\[\begin{align} &amp;H_0: \pi_1 = 0.5 \\ &amp;H_1: \pi_1 \ne 0.5 \end{align}\]</span> or even</p>
<p><span class="math display">\[\begin{align} &amp;H_0: \pi = 0.5 \\ &amp;H_1: \pi \ne 0.5 \end{align}\]</span> when we use <span class="math inline">\(\pi\)</span> for the proportion of the first category and <span class="math inline">\(1-\pi\)</span> for the second. We just transform a chi-squared test setting into a two-sided one-sample proportion test setting!</p>
<p>Suppose <span class="math inline">\(n = 1000\)</span>, <span class="math inline">\(O_1 = 520\)</span>, <span class="math inline">\(O_2 = 480\)</span>, <span class="math inline">\(\pi_1^0 = \pi_2^0 = 0.5\)</span>. Our chi-squared test is</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  c(520, 480)
X-squared = 1.6, df = 1, p-value = 0.2059</code></pre>
</div>
</div>
<p>In the language of the one-sample proportion test, we have <span class="math inline">\(n = 1000\)</span>, <span class="math inline">\(y = 520\)</span>, <span class="math inline">\(\pi^0 = 0.5\)</span>. <span class="math inline">\((y = O_1 = 520, n-y = O_2 = 480)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  520 out of 1000, null probability 0.5
X-squared = 1.6, df = 1, p-value = 0.2059
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.4890177 0.5508292
sample estimates:
   p 
0.52 </code></pre>
</div>
</div>
<p>Do you see the two tests are equivalent? They have the same test statistic, degrees of freedom as well as <span class="math inline">\(p\)</span>-value. Both lead to the same conclusion.</p>
</div>
</div>
</section><section id="test-of-independence" class="level2" data-number="19.2"><h2 data-number="19.2" class="anchored" data-anchor-id="test-of-independence">
<span class="header-section-number">19.2</span> Test of Independence</h2>
<p>So far we consider one categorical variable with general <span class="math inline">\(k\)</span> categories. In some situations, we have two categorical variables being considered, and we wonder if one affects the other distribution. Formally, we want to test <em>whether or not the two variables are independent</em> each other. The test doing this is the <strong>independence test</strong>.</p>
<p><span style="color:blue"> <strong>Contingency Table and Expected Count</strong></span></p>
<p><span style="color:red"> <strong><em>Contingency Table</em></strong> </span></p>
<p>Let’s start with an example. A popular question in politics is <em>“Does the opinion of the President’s job performance depend on gender?”</em> This question may involve two categorical variables such as</p>
<ul>
<li><p><strong>Job performance</strong>: approve, disapprove, no opinion</p></li>
<li><p><strong>Gender</strong>: male, female</p></li>
</ul>
<!-- - We have TWO categorical variables, and we want to test **whether or not the two variables are independent**. --><!-- - <span style="color:blue"> Does the opinion of the President's job performance depend on gender?  </span> --><p>To answer such question, as every other test, we collect our data and see if there is any sufficient evidence to say the two variables are dependent. When two categorical variables are involved, we usually summarize the data in a <strong>contingency table</strong> or <strong>two-way frequency/count table</strong> as shown below.</p>
<div class="columns">
<div class="column" style="width:65%;">
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Approve</th>
<th style="text-align: center;">Disapprove</th>
<th style="text-align: center;">No Opinion</th>
<th style="text-align: center;">Total</th>
<th style="text-align: center;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Male</strong></td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Female</strong></td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Total</strong></td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:33%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./images/img-infer/approval_rate.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="608"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>When we consider a two-way table, we often would like to know, are these variables related in any way? That is, are they dependent (versus independent)? If President’s approval rate has nothing to do with gender, the Job performance distributions in the male and female groups should be similar or consistent. In other words, whether or not the person is male or female does not affect how President’s job performance is viewed.</p>
<p><span style="color:red"> <strong><em>Expected Count</em></strong> </span></p>
<p>The idea is similar to goodness-of-fit test. We first calculate the <em>expected</em> count in each cell (<em>Total row and column are excluded</em>) in the contingency table, the count we expect to see under the condition that <em>the two variables are independent</em>. We always do our analysis in the world of null hypothesis that two variables have no relationship.</p>
<!-- - Compute the *expected* count of each cell in the two-way table under the condition that the *two variables __are independent__* of each other. -->
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Approve</th>
<th style="text-align: center;">Disapprove</th>
<th style="text-align: center;">No Opinion</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Male</strong></td>
<td style="text-align: center;">18 (19.52)</td>
<td style="text-align: center;">22 (20)</td>
<td style="text-align: center;">10 (10.48)</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Female</strong></td>
<td style="text-align: center;">23 (21.48)</td>
<td style="text-align: center;">20 (22)</td>
<td style="text-align: center;">12 (11.52)</td>
<td style="text-align: center;">55</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Total</strong></td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">105</td>
</tr>
</tbody>
</table>
<p>The expected count for the <span class="math inline">\(i\)</span>-th row and <span class="math inline">\(j\)</span>-th column, which is listed in parentheses in the table above, is calculated by: <span class="math display">\[\text{Expected Count}_{\text{row i; col j}} = \frac{\text{(row i total}) \times (\text{col j total})}{\text{table total}}\]</span> For example, the expected count of Disapprove in the Female group is <span class="math display">\[\text{Expected Count}_{\text{row 2; col 2}} = \frac{\text{(row 2 total}) \times (\text{col 2 total})}{\text{table total}} = \frac{42 \times 55}{105} = 22.\]</span></p>
<p>We are ready for doing test of independence once all expected counts are obtained.</p>
<hr>
<p><span style="color:blue"> <strong>Test of Independence Procedure</strong> </span></p>
<p>The test of independence requires that every expected count <span class="math inline">\(E_{ij} \ge 5\)</span> in the contingency table. The higher the better.</p>
<p>As we discussed before, we believe the variables are independent unless strong evidence says they are not. So our hypotheses are <span style="color:blue"> <span class="math display">\[\begin{align} &amp;H_0: \text{Two variables are independent }\\ &amp;H_1: \text{The two are dependent (associated) } \end{align}\]</span></span></p>
<p>The test statistic formula is pretty similar to the test of goodness-of-fit. The test of independence is also a chi-squared test. The chi-squared test statistic is</p>
<p><span style="color:blue"><span class="math display">\[\chi^2_{test} = \sum_{i=1}^r\sum_{j=1}^c\frac{(O_{ij} - E_{ij})^2}{E_{ij}},\]</span></span> where <span class="math inline">\(r\)</span> is the number of rows and <span class="math inline">\(c\)</span> is the number of columns in the contingency table. The idea is the same as the test of goodness-of-fit. Under the assumption of independence, if the observed counts are far away from the counts we should expect to see, we get a larger test statistic, and tend to conclude that the independence assumption is not reasonable.</p>
<p>The chi-squared test is right-tailed, so we reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\chi^2_{test} &gt; \chi^2_{\alpha, \, df}\)</span>, where <span class="math inline">\(df = (r-1)(c-1)\)</span>.</p>
<p><span style="color:red"> <strong><em>Example</em></strong> </span></p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Approve</th>
<th style="text-align: center;">Disapprove</th>
<th style="text-align: center;">No Opinion</th>
<th style="text-align: center;">Total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Male</strong></td>
<td style="text-align: center;">18 (19.52)</td>
<td style="text-align: center;">22 (20)</td>
<td style="text-align: center;">10 (10.48)</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Female</strong></td>
<td style="text-align: center;">23 (21.48)</td>
<td style="text-align: center;">20 (22)</td>
<td style="text-align: center;">12 (11.52)</td>
<td style="text-align: center;">55</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Total</strong></td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">105</td>
</tr>
</tbody>
</table>
<p><span style="color:blue"> <span class="math display">\[\begin{align} &amp;H_0: \text{ Opinion does not depend on gender } \\ &amp;H_1: \text{ Opinion and gender are dependent } \end{align}\]</span></span></p>
<p>The test statistic is <span class="math display">\[\small \chi^2_{test} = \frac{(18 - 19.52)^2}{19.52} + \frac{(22 - 20)^2}{20} + \frac{(10 - 10.48)^2}{10.48} + \frac{(23 - 21.48)^2}{21.48} + \frac{(20 - 22)^2}{22} + \frac{(12 - 11.52)^2}{11.52}= 0.65\]</span></p>
<p>The critical value is <span class="math inline">\(\chi^2_{\alpha, df} =\chi^2_{0.05, (2-1)(3-1)} = 5.991\)</span>. Since <span class="math inline">\(\chi_{test}^2 &lt; \chi^2_{\alpha, df}\)</span>, we do not reject <span class="math inline">\(H_0\)</span>. Therefore we fail to conclude that the opinion of the President’s job performance depends on gender.</p>
<p><span style="color:red"> <strong><em>Test of Independence in R</em></strong> </span></p>
<p>Calculating all the expected counts is tedious, especially when the variables have many categories. In practice we never calculate them by hand, and use computing software to do so. Below is an example of how to perform the test of independence using R. Since the test of independence is a chi-squared test, we still use the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function. This time we need to prepare the contingency table as a matrix, and put the matrix in the <code>x</code> argument in the function. That’s it! R does everything for us. If we save the result as an object like <code>ind_test</code> which is a R list, we can get access to information related to the test, such as the expected counts <code>ind_test$expected</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">contingency_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">23</span>, <span class="fl">22</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   18   22   10
[2,]   23   20   12</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Using chisq.test() function</span></span>
<span><span class="op">(</span><span class="va">ind_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">contingency_table</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 0.65019, df = 2, p-value = 0.7225</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## extract expected counts</span></span>
<span><span class="va">ind_test</span><span class="op">$</span><span class="va">expected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1] [,2]     [,3]
[1,] 19.52381   20 10.47619
[2,] 21.47619   22 11.52381</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## critical value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span><span class="op">(</span><span class="fl">0.05</span>, df <span class="op">=</span> <span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.991465</code></pre>
</div>
</div>
</section><section id="test-of-homogeneity" class="level2" data-number="19.3"><h2 data-number="19.3" class="anchored" data-anchor-id="test-of-homogeneity">
<span class="header-section-number">19.3</span> Test of Homogeneity</h2>
<p>Test of homogeneity is a generalization of the two-sample proportion test. This test determines if two or more populations (or subgroups of a population) have the same distribution of a single categorical variable having two or more categories.</p>
<p>More to be added.</p>
</section><section id="exercises" class="level2" data-number="19.4"><h2 data-number="19.4" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">19.4</span> Exercises</h2>
<ol type="1">
<li>A researcher has developed a model for predicting eye color. After examining a random sample of parents, she predicts the eye color of the first child. The table below lists the eye colors of offspring. On the basis of her theory, she predicted that 87% of the offspring would have brown eyes, 8% would have blue eyes, and 5% would have green eyes. Use 0.05 significance level to test the claim that the actual frequencies correspond to her predicted distribution.</li>
</ol>
<table class="caption-top table"><tbody>
<tr class="odd">
<td>Eye Color</td>
<td>Brown</td>
<td>Blue</td>
<td>Green</td>
</tr>
<tr class="even">
<td>Frequency</td>
<td>127</td>
<td>21</td>
<td>5</td>
</tr>
</tbody></table>
<ol start="2" type="1">
<li>In a study of high school students at least 16 years of age, researchers obtained survey results summarized in the accompanying table. Use a 0.05 significance level to test the claim of independence between texting while driving and driving when drinking alcohol. Are these two risky behaviors independent of one another?</li>
</ol>
<table class="caption-top table">
<thead><tr class="header">
<th></th>
<th>Drove after drinking alcohol?</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="even">
<td>Texted while driving</td>
<td>720</td>
<td>3027</td>
</tr>
<tr class="odd">
<td>Did not text while driving</td>
<td>145</td>
<td>4472</td>
</tr>
</tbody>
</table>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chenghanyu-introstatsbook\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./infer-prop.html" class="pagination-link" aria-label="Inference About Proportions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Inference About Proportions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infer-p.html" class="pagination-link" aria-label="The Issues of $p$-value and Statistical Significance">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">The Issues of <span class="math inline">\(p\)</span>-value and Statistical Significance</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Dr.&nbsp;Cheng-Han Yu</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chenghanyustats/introstatsbook/edit/main/infer-cat.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chenghanyustats/introstatsbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/chenghanyustats/introstatsbook" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>